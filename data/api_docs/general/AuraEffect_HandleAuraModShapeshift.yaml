api:
  class: AuraEffect
  method: HandleAuraModShapeshift
  signature: void AuraEffect::HandleAuraModShapeshift(const AuraApplication * aurApp,
    uint8 mode, bool apply) const
documentation:
  brief: Applies or removes a shapeshift aura effect on the target.
  description: The HandleAuraModShapeshift method manages the application and removal
    of shapeshift auras, which modify a unit's visual appearance and associated abilities.
    This method is typically invoked during aura application or removal events to
    update the unit's model, display properties, and related game mechanics such as
    spell restrictions or movement speed adjustments. The method handles both the
    visual transformation and the underlying gameplay effects tied to shapeshift forms
    like Cat Form, Bear Form, or Moonkin Form in World of Warcraft.
  parameters:
  - name: aurApp
    description: Pointer to the AuraApplication object that contains information about
      the aura being applied or removed. This parameter provides context for which
      aura is triggering the shapeshift change.
  - name: mode
    description: The mode of operation, typically indicating whether this is an application
      (1) or removal (0) of the aura effect. Valid values are usually 0 or 1, though
      specific implementation may vary based on TrinityCore's internal handling.
  - name: apply
    description: Boolean flag indicating whether to apply (true) or remove (false)
      the shapeshift effect. This parameter determines the direction of the transformation.
  returns: null
  examples:
  - title: Applying a Shapeshift Aura
    code: "void ApplyShapeshiftAura(Unit* target, uint8 formType)\n{\n    AuraApplication*\
      \ aurApp = new AuraApplication(target, target, SpellInfo::GetSpellInfo(24858));\
      \ // Bear Form\n    auraEffect->HandleAuraModShapeshift(aurApp, 1, true);\n}"
    language: cpp
  - title: Removing a Shapeshift Aura
    code: "void RemoveShapeshiftAura(Unit* target)\n{\n    AuraApplication* aurApp\
      \ = target->GetAuraApplication(24858); // Bear Form\n    if (aurApp)\n     \
      \   auraEffect->HandleAuraModShapeshift(aurApp, 0, false);\n}"
    language: cpp
  notes: This method interacts closely with the unit's visual system and spell restrictions.
    It is important to ensure that any shapeshift form changes are properly synchronized
    between client and server to prevent visual desynchronization. The method may
    also trigger additional events or updates related to movement, combat state, and
    ability availability.
  warnings: Improper handling of the apply flag can lead to incorrect visual states
    or gameplay mechanics. Ensure that all aura applications and removals are correctly
    tracked to avoid stacking issues or unintended transformations. This method should
    not be called directly without proper aura application context.
  related:
  - AuraEffect::HandleAuraModShapeshift
  - Unit::SetDisplayId
  - Unit::SetNativeDisplayId
  - Unit::UpdateModelData
metadata:
  confidence: 0.9
  generated_at: '2025-10-31T13:07:25.016171'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
