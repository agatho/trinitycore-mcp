api:
  class: DoubleBufferedSpatialGrid
  method: PopulateBufferFromMap
  signature: void DoubleBufferedSpatialGrid::PopulateBufferFromMap()
documentation:
  brief: Populates the spatial grid buffer from the current map data for efficient
    object retrieval and spatial queries.
  description: The PopulateBufferFromMap method is responsible for updating the internal
    double-buffered spatial grid structure with entities currently present in the
    game world map. This method ensures that the spatial grid reflects the most recent
    state of objects such as players, creatures, and game objects within the associated
    map. It typically gets invoked during map loading, object movement updates, or
    when the grid needs to be refreshed for accurate spatial queries. The double-buffering
    mechanism allows for safe concurrent access patterns where one buffer is actively
    used while the other is being populated, preventing race conditions during updates.
    This method is crucial for performance optimization in TrinityCore's spatial indexing
    system, enabling fast lookups of nearby objects without traversing the entire
    object list.
  parameters: []
  returns: null
  examples:
  - title: Basic Usage in Map Update Context
    code: "void MyMap::UpdateSpatialGrid()\n{\n    // Assume this is called during\
      \ map update cycle\n    _spatialGrid.PopulateBufferFromMap();\n}"
    language: cpp
  - title: Usage with Object Movement
    code: "void Player::MoveInWorld()\n{\n    // Update player position in spatial\
      \ grid\n    _map->GetSpatialGrid()->PopulateBufferFromMap();\n    // Perform\
      \ other movement logic\n}"
    language: cpp
  notes: This method performs a full rebuild of the spatial grid buffer from scratch,
    which can be computationally expensive on maps with many objects. It's recommended
    to call this only when necessary, such as after significant map changes or periodic
    refreshes rather than on every frame update.
  warnings: Calling this method while other threads are actively querying the spatial
    grid may result in inconsistent results or data races. Ensure proper synchronization
    mechanisms are in place if used in multi-threaded contexts.
  related:
  - GetSpatialGrid
  - UpdateBuffer
  - QueryNearbyObjects
metadata:
  confidence: 0.9
  generated_at: '2025-11-08T06:08:03.055068'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
