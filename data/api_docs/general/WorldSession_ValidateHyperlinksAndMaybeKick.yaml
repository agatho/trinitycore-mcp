api:
  class: WorldSession
  method: ValidateHyperlinksAndMaybeKick
  signature: bool WorldSession::ValidateHyperlinksAndMaybeKick(const std::string &
    str)
documentation:
  brief: Validates hyperlink content in a string and kicks the player if invalid links
    are detected.
  description: The ValidateHyperlinksAndMaybeKick method checks for malicious or unauthorized
    hyperlinks within a provided string, typically used to sanitize chat messages
    or other user-input text. If any invalid hyperlinks are found, the method will
    trigger a kick action against the player's session. This mechanism is part of
    TrinityCore's anti-cheat and content validation system to prevent exploitation
    through crafted links. The method performs checks on URL formats, domains, and
    potentially restricted protocols to ensure game integrity.
  parameters:
  - name: str
    description: The input string containing potential hyperlinks to validate. This
      is typically a chat message or user-submitted text that needs sanitization.
  returns: Returns true if the string passed validation and no kick was triggered;
    returns false if an invalid hyperlink was detected and the player was kicked from
    the server.
  examples:
  - title: Basic usage in chat handler
    code: "if (!session->ValidateHyperlinksAndMaybeKick(message)) {\n    // Player\
      \ was kicked due to invalid link\n    return;\n}\n// Proceed with normal message\
      \ handling"
    language: cpp
  notes: This method is typically invoked during chat message processing or when validating
    user input. It may perform regular expression matching and domain blacklisting
    checks, which could introduce performance overhead on high-volume inputs. The
    exact validation rules are configurable within the TrinityCore core settings.
  warnings: Do not call this method with untrusted input without proper sanitization
    first, as it directly affects player sessions. Misuse can lead to unintended kicks
    or denial-of-service conditions.
  related:
  - WorldSession::SendNotification
  - WorldSession::KickPlayer
  - WorldSession::GetPlayer
metadata:
  confidence: 0.85
  generated_at: '2025-11-04T19:03:25.542030'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
