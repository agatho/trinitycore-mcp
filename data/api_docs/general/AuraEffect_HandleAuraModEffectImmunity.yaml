api:
  class: AuraEffect
  method: HandleAuraModEffectImmunity
  signature: void AuraEffect::HandleAuraModEffectImmunity(const AuraApplication *
    aurApp, uint8 mode, bool apply) const
documentation:
  brief: Applies or removes an effect immunity aura on the target.
  description: The HandleAuraModEffectImmunity method manages the application and
    removal of aura effects that grant immunity to specific magical effects. This
    method is typically invoked during aura application or removal events, adjusting
    the target's state to either enable or disable immunity to certain spell effects.
    It operates based on the aura's configuration and the mode specified (apply or
    remove). The method interacts with the target's effect immunity state, potentially
    modifying how subsequent spells affect the unit. This functionality is crucial
    for implementing mechanics such as magic resistance, damage reduction, or immunity
    to specific debuffs.
  parameters:
  - name: aurApp
    description: Pointer to the AuraApplication object representing the aura being
      applied or removed. Contains context about which aura and on which target it
      is acting.
  - name: mode
    description: Specifies the mode of operation for the aura effect. Typically indicates
      whether the effect should be applied (1) or removed (0). May also represent
      different immunity types depending on implementation details.
  - name: apply
    description: Boolean flag indicating whether to apply (true) or remove (false)
      the immunity effect. Controls the direction of the operation.
  returns: null
  examples:
  - title: Applying Effect Immunity Aura
    code: 'AuraEffect* auraEff = ...; // Get a valid aura effect

      AuraApplication* app = ...; // Get the aura application

      auraEff->HandleAuraModEffectImmunity(app, 1, true); // Apply immunity'
    language: cpp
  - title: Removing Effect Immunity Aura
    code: 'AuraEffect* auraEff = ...;

      AuraApplication* app = ...;

      auraEff->HandleAuraModEffectImmunity(app, 0, false); // Remove immunity'
    language: cpp
  notes: This method is part of the core aura handling system in TrinityCore. It directly
    modifies the target's effect immunity state and should only be called during appropriate
    aura application/removal phases. The method relies on internal state tracking
    to determine which effects are immune, and may involve complex logic for different
    spell categories or types.
  warnings: Improper usage of this method can lead to incorrect immunity states, potentially
    causing unintended behavior in combat mechanics. Ensure that the aura application
    context is valid before calling this function. Incorrect mode values might result
    in unexpected immunity behavior or crashes.
  related:
  - AuraEffect::ApplyAura
  - AuraEffect::RemoveAura
  - AuraApplication::GetTarget
  - Unit::IsImmuneToSpellEffect
metadata:
  confidence: 0.9
  generated_at: '2025-10-31T13:24:35.887645'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
