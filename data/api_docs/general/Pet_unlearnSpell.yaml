api:
  class: Pet
  method: unlearnSpell
  signature: bool Pet::unlearnSpell(uint32 spell_id, bool learn_prev, bool clear_ab)
documentation:
  brief: Removes a spell from the pet's spellbook and optionally learns previous spell
    levels.
  description: The unlearnSpell method removes a specified spell from the pet's current
    spell list. It can also optionally learn the previous spell level if the spell
    being removed is a higher tier of a multi-level spell. The method handles clearing
    the spell from the pet's active abilities and updates the pet's spellbook accordingly.
    This functionality is typically used when pets evolve or when spell levels are
    downgraded through game mechanics.
  parameters:
  - name: spell_id
    description: The unique identifier of the spell to be removed from the pet's spellbook.
      Must correspond to a valid spell in the game database.
  - name: learn_prev
    description: If true, attempts to learn the previous tier of the spell if available.
      For example, if removing a rank 5 spell, it will try to learn rank 4 if it exists.
  - name: clear_ab
    description: If true, clears the spell from the pet's action bar. If false, only
      removes it from the spellbook without affecting the action bar.
  returns: Returns true if the spell was successfully removed and any applicable previous
    spell was learned; returns false if the spell could not be found or removed.
  examples:
  - title: Basic usage to remove a spell
    code: 'Pet* pet = ...;

      bool success = pet->unlearnSpell(12345, false, true);'
    language: cpp
  - title: Remove spell and learn previous tier
    code: 'Pet* pet = ...;

      bool success = pet->unlearnSpell(12345, true, false);'
    language: cpp
  notes: This method modifies the pet's spellbook directly. It does not send updates
    to the client automatically; you may need to call UpdatePlayerField or similar
    methods to refresh the UI. The method assumes that the spell exists in the pet's
    current spell list.
  warnings: Be cautious when using learn_prev=true as it might cause unexpected behavior
    if the previous spell level is not properly defined in the database. Also, clearing
    the action bar (clear_ab=true) will remove the spell from the pet's active abilities
    immediately.
  related:
  - learnSpell
  - HasSpell
  - AddSpell
metadata:
  confidence: 0.9
  generated_at: '2025-10-31T21:02:53.665146'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
