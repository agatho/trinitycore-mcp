api:
  class: WorldSession
  method: HandlePetCancelAuraOpcode
  signature: void WorldSession::HandlePetCancelAuraOpcode(WorldPackets::Spells::PetCancelAura
    & packet)
documentation:
  brief: Cancels a specified aura on the player's pet
  description: Handles the client request to cancel a specific aura effect applied
    to the player's active pet. This method processes the PetCancelAura packet sent
    from the client, which typically occurs when a player clicks on an aura icon in
    their pet's aura bar to remove it. The method validates that the pet exists and
    the aura can be cancelled before proceeding with the removal. It is part of the
    spell system integration for pet management and ensures proper synchronization
    between client and server state for pet auras.
  parameters: []
  returns: null
  examples:
  - title: Basic usage in packet handling
    code: "void WorldSession::HandlePetCancelAuraOpcode(WorldPackets::Spells::PetCancelAura&\
      \ packet)\n{\n    if (!GetPlayer() || !GetPlayer()->GetPet())\n        return;\n\
      \n    // Process aura cancellation for pet\n    GetPlayer()->GetPet()->RemoveAura(packet.AuraID);\n\
      }"
    language: cpp
  notes: This method is typically invoked as part of the WorldSession's packet handling
    system. It assumes that the player has an active pet and that the aura ID provided
    in the packet corresponds to a valid aura on the pet. The method does not perform
    direct network communication but rather processes the received packet data.
  warnings: Ensure proper validation of aura IDs before attempting cancellation to
    prevent invalid operations. This method should only be called when a player has
    an active pet; otherwise, it may result in undefined behavior or crashes.
  related:
  - HandlePetAction
  - HandlePetStopAttack
  - HandlePetAbandon
  - RemoveAura
metadata:
  confidence: 0.9
  generated_at: '2025-11-02T19:26:18.826048'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
