api:
  class: PathfindingUtils
  method: FindNearestSafePosition
  signature: int PathfindingUtils::FindNearestSafePosition(const int & current, const
    int & dangers, Map * map)
documentation:
  brief: Finds the nearest safe position to a given location while avoiding dangerous
    areas on the map.
  description: The FindNearestSafePosition method calculates the closest navigable
    point to a specified current position that is not within any defined danger zones.
    It utilizes the map's navigation system to determine valid waypoints and ensures
    the returned position is free from hazards. This utility is commonly used in AI
    pathfinding and movement logic where characters must avoid combat zones, traps,
    or other harmful areas. The method requires a valid Map object and evaluates positions
    based on the current and danger parameters provided.
  parameters:
  - name: current
    description: The current position identifier or coordinate from which to search
      for a safe location. This typically represents the character's present position
      in the world.
  - name: dangers
    description: A bitmask or identifier representing dangerous areas or zones that
      should be avoided during pathfinding. The exact format depends on how danger
      zones are defined within the map system.
  - name: map
    description: Pointer to the Map object containing navigation data and terrain
      information. Must not be null for the method to function correctly.
  returns: Returns an integer identifier or coordinate representing the nearest safe
    position found. If no valid safe location can be determined, it may return a special
    error code or zero value indicating failure.
  examples:
  - title: Basic usage in AI movement
    code: "int safePos = PathfindingUtils::FindNearestSafePosition(player->GetPosition(),\
      \ dangerMask, player->GetMap());\nif (safePos != 0) {\n    player->MoveTo(safePos);\n\
      }"
    language: cpp
  - title: Using with multiple danger zones
    code: "uint32 dangerZones = DANGER_TRAP | DANGER_ENEMY_AGGRO;\nint safePosition\
      \ = PathfindingUtils::FindNearestSafePosition(currentPos, dangerZones, map);\n\
      if (safePosition > 0) {\n    // Proceed with movement to safePosition\n}"
    language: cpp
  notes: This method relies heavily on the underlying navigation mesh and map data
    structures. Performance may degrade significantly in complex environments with
    many obstacles or danger zones. The implementation assumes that the Map object
    has been properly initialized with valid pathfinding data.
  warnings: Ensure that the 'map' parameter is not null before calling this function,
    as it will likely cause a crash. Also, be aware that the method may return zero
    or negative values to indicate failure, so always check for valid return codes
    before using the result.
  related:
  - FindNearestWaypoint
  - IsPositionSafe
  - GetNavigationData
metadata:
  confidence: 0.85
  generated_at: '2025-11-06T06:44:10.888307'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
