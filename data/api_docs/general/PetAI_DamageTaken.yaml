api:
  class: PetAI
  method: DamageTaken
  signature: void PetAI::DamageTaken(int * attacker, int & param1, int param2, const
    int * param3)
documentation:
  brief: Handles damage received by a pet unit and updates its AI behavior accordingly
  description: The DamageTaken method in PetAI is invoked when a pet unit receives
    damage from an attacker. This method processes the incoming damage, updates the
    pet's internal state such as health and threat level, and potentially triggers
    AI responses like retaliating or fleeing. It serves as a core part of the pet's
    combat behavior system within TrinityCore's AI framework. The method modifies
    parameters related to the attacker and damage context to reflect changes in the
    pet's condition and decision-making process.
  parameters:
  - name: attacker
    description: Pointer to an integer representing the attacker's identifier or index.
      This value may be modified by the method to reflect updated threat information
      or target switching.
  - name: param1
    description: Reference to an integer parameter that likely represents damage dealt,
      threat generated, or combat state flags. The method modifies this value during
      execution.
  - name: param2
    description: An integer parameter that could represent damage type, spell ID,
      or other contextual information about the attack received by the pet.
  - name: param3
    description: Pointer to an array of integers containing additional data related
      to the damage event such as damage amounts, flags, or effect parameters.
  returns: null
  examples:
  - title: Basic Damage Handling Example
    code: "void PetAI::DamageTaken(int* attacker, int& param1, int param2, const int*\
      \ param3) {\n    // Process damage received\n    if (param1 > 0) {\n       \
      \ // Update pet's health and threat\n        m_pet->ModifyHealth(-param1);\n\
      \        m_pet->AddThreat(*attacker, param1);\n    }\n    // Possibly trigger\
      \ AI response\n    if (m_pet->GetHealth() < m_pet->GetMaxHealth() / 2) {\n \
      \       m_pet->SetReactState(REACT_AGGRESSIVE);\n    }\n}"
    language: cpp
  notes: This method is typically called internally by the core game engine when a
    pet receives damage. Developers should ensure that any modifications to the input
    parameters do not cause unintended side effects in the AI logic or combat system.
  warnings: Modifying the attacker pointer directly can affect targeting behavior
    and should be done carefully. The method assumes valid input pointers; dereferencing
    null or invalid pointers may lead to crashes.
  related:
  - PetAI::UpdateAI
  - PetAI::EnterCombat
  - PetAI::AttackStart
metadata:
  confidence: 0.85
  generated_at: '2025-11-06T06:29:12.710797'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
