api:
  class: PositionManager
  method: FindMeleePosition
  signature: int PositionManager::FindMeleePosition(Unit * target, bool preferBehind)
documentation:
  brief: Calculates and returns an optimal melee position relative to a target unit,
    optionally preferring a behind position.
  description: The FindMeleePosition method determines the best available melee positioning
    for a unit in relation to a specified target. It evaluates potential positions
    based on combat mechanics such as line of sight, distance, and preferred positioning
    (e.g., behind the target). The method is typically used by AI-controlled creatures
    or players during melee combat scenarios to optimize their positioning for damage
    output or defensive purposes. This function considers factors like target orientation,
    terrain, and collision avoidance to ensure the calculated position is valid and
    safe for the unit to move into. The result represents a position index or identifier
    that can be used to guide movement behavior.
  parameters:
  - name: target
    description: Pointer to the Unit object representing the target against which
      the melee position is calculated. Must not be null.
  - name: preferBehind
    description: Boolean flag indicating whether to prefer positioning behind the
      target. If true, the method attempts to find a position that places the unit
      behind the target for tactical advantage.
  returns: An integer representing the calculated melee position index or identifier.
    A value of 0 typically indicates success with a valid position found, while negative
    values may indicate failure or no suitable position available.
  examples:
  - title: Basic Usage in AI Logic
    code: "if (int pos = positionManager->FindMeleePosition(targetUnit, true) >= 0)\n\
      {\n    // Proceed with movement to the calculated position\n    unit->MoveTo(positionManager->GetPosition(pos));\n\
      }"
    language: cpp
  - title: Using Position for Combat Decision Making
    code: "Unit* target = unit->GetVictim();\nif (target)\n{\n    int pos = positionManager->FindMeleePosition(target,\
      \ false);\n    if (pos >= 0)\n    {\n        // Positioning is optimal, proceed\
      \ with attack\n        unit->Attack(target, true);\n    }\n    else\n    {\n\
      \        // No good position found, consider alternative actions\n        unit->DoFlee();\n\
      \    }\n}"
    language: cpp
  notes: This method likely performs pathfinding or spatial analysis to determine
    valid positions. It may interact with the underlying navigation system of TrinityCore
    to ensure that calculated positions are walkable and free from obstacles. The
    exact implementation details depend on how PositionManager handles unit positioning
    logic internally.
  warnings: Ensure the target unit is valid before calling this method, as passing
    a null pointer could lead to undefined behavior. Also, the returned position index
    should be validated before attempting movement operations to avoid errors.
  related:
  - GetPosition
  - MoveTo
  - GetDistanceTo
metadata:
  confidence: 0.85
  generated_at: '2025-11-02T00:33:39.676026'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
