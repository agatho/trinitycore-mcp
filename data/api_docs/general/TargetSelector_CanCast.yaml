api:
  class: TargetSelector
  method: CanCast
  signature: bool TargetSelector::CanCast(Unit * target, uint32 spellId) const
documentation:
  brief: Determines whether a spell can be cast on a given target based on AI selection
    criteria.
  description: The CanCast method evaluates whether a specified spell is appropriate
    to cast on a given target unit, considering various AI-related conditions such
    as target validity, spell restrictions, and combat state. This method is typically
    used within the context of NPC AI behavior to ensure that spells are only cast
    when conditions are met. It checks if the target is valid, not immune to the spell,
    and if the spell can be legally cast in the current situation. The method does
    not perform actual spell casting but rather determines the eligibility for casting
    based on predefined rules.
  parameters:
  - name: target
    description: Pointer to the Unit object representing the target on which the spell
      should be cast. Must not be null.
  - name: spellId
    description: The unique identifier of the spell to be evaluated for casting. This
      ID corresponds to entries in the Spell database.
  returns: Returns true if the spell can be cast on the target according to AI rules
    and conditions; otherwise returns false.
  examples:
  - title: Basic usage in AI context
    code: "if (selector.CanCast(target, 12345)) {\n    // Cast the spell\n    caster->CastSpell(target,\
      \ 12345, true);\n}"
    language: cpp
  - title: Checking multiple spells before casting
    code: "uint32 spells[] = {12345, 12346, 12347};\nfor (uint32 spellId : spells)\
      \ {\n    if (selector.CanCast(target, spellId)) {\n        caster->CastSpell(target,\
      \ spellId, true);\n        break;\n    }\n}"
    language: cpp
  notes: This method is part of the AI system and should be used within appropriate
    AI update loops. The evaluation logic may include checks for target health, distance,
    line of sight, and spell cooldowns depending on implementation details. It's important
    to note that this method does not account for mana or power requirements; it only
    evaluates casting eligibility.
  warnings: Ensure the target pointer is valid before calling this method to avoid
    undefined behavior. This method may return false even if the spell is normally
    castable, due to AI-specific restrictions or conditions that are not visible in
    the core spell system.
  related:
  - TargetSelector::SelectTarget
  - TargetSelector::IsSpellValid
  - Unit::IsInCombat
metadata:
  confidence: 0.9
  generated_at: '2025-11-03T17:17:46.992665'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
