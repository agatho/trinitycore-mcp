api:
  class: TradeSystem
  method: RecordTradeHistory
  signature: void TradeSystem::RecordTradeHistory(Player * player, const TradeSession
    & session)
documentation:
  brief: Records trade session history for a player in the game's database.
  description: The RecordTradeHistory method logs detailed information about a completed
    trade session between two players into the game's database. This includes items
    exchanged, gold amounts, timestamps, and player GUIDs to maintain an audit trail
    of all transactions. The method is typically invoked after a successful trade
    has been finalized, ensuring that all trade data is persisted for future reference,
    potential disputes, or administrative oversight. It plays a crucial role in maintaining
    game economy integrity and player accountability within the TrinityCore framework.
  parameters:
  - name: player
    description: Pointer to the Player object representing one party involved in the
      trade session. Must be a valid player instance with an active session.
  - name: session
    description: Reference to the TradeSession object containing all details about
      the completed trade, including items, quantities, and monetary exchange information.
  returns: null
  examples:
  - title: Basic Usage in Trade Completion Handler
    code: "void OnTradeComplete(Player* player1, Player* player2) {\n    TradeSession\
      \ session;\n    // ... populate session with trade data ...\n    TradeSystem::RecordTradeHistory(player1,\
      \ session);\n}"
    language: cpp
  - title: Integration with Custom Trade System
    code: "class MyTradeHandler {\npublic:\n    void FinalizeTrade(Player* buyer,\
      \ Player* seller) {\n        TradeSession session;\n        // ... gather trade\
      \ details ...\n        TradeSystem::RecordTradeHistory(buyer, session);\n  \
      \      TradeSystem::RecordTradeHistory(seller, session);\n    }\n};"
    language: cpp
  notes: This method likely performs database writes and should be called asynchronously
    or during a safe point in the game loop to avoid blocking. The implementation
    may include transaction handling for data consistency across multiple database
    entries.
  warnings: Ensure that both player and session parameters are valid before calling
    this method, as invalid references could lead to crashes or corrupted trade logs.
    This method does not validate trade legality; it only records what occurred.
  related:
  - GetTradeHistory
  - ClearTradeHistory
metadata:
  confidence: 0.9
  generated_at: '2025-11-06T00:27:12.507136'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
