api:
  class: MultiPersonalPhaseTracker
  method: OnOwnerPhaseChanged
  signature: void MultiPersonalPhaseTracker::OnOwnerPhaseChanged(const WorldObject
    * phaseOwner, int * grid, Map * map, const Cell & cell)
documentation:
  brief: Updates phase tracking for a specified owner object and its associated grid,
    map, and cell.
  description: The OnOwnerPhaseChanged method is responsible for handling updates
    to the phase tracking system when the phase of a specific WorldObject (typically
    a player or creature) changes. This method ensures that all relevant grid cells,
    maps, and associated objects are notified of the phase change so that visibility
    and interaction rules can be properly enforced. It plays a crucial role in maintaining
    proper phasing behavior within the TrinityCore framework, particularly for personal
    phases that affect individual players' visibility of game objects. The method
    takes into account the owner's current location (grid, map, cell) to ensure accurate
    propagation of phase changes throughout the appropriate spatial boundaries.
  parameters:
  - name: phaseOwner
    description: Pointer to the WorldObject whose phase has changed. This is typically
      a Player or Creature object that controls the phase state being updated.
  - name: grid
    description: Pointer to an integer representing the grid coordinate associated
      with the phase owner's current location. Used for determining which grid cells
      need phase updates.
  - name: map
    description: Pointer to the Map object where the phase owner currently resides.
      This is used to identify the correct map context for phase propagation.
  - name: cell
    description: Reference to the Cell object representing the current cell occupied
      by the phase owner. Used to determine which cells in the vicinity require phase
      update notifications.
  returns: null
  examples:
  - title: Basic usage of OnOwnerPhaseChanged
    code: "void HandlePlayerPhaseChange(Player* player)\n{\n    int grid = player->GetGridX();\n\
      \    Map* map = player->GetMap();\n    Cell cell = player->GetCurrentCell();\n\
      \    \n    // Notify phase tracker of the change\n    sMultiPersonalPhaseTracker->OnOwnerPhaseChanged(player,\
      \ &grid, map, cell);\n}"
    language: cpp
  notes: This method is typically called internally by the core framework when a phase
    change occurs. It's important to note that the grid parameter is passed as a pointer
    and may be modified during execution. The method assumes valid pointers for all
    parameters, especially map and phaseOwner, which should not be null. Performance-wise,
    this method may trigger multiple notifications across various grid cells depending
    on the size of the affected area.
  warnings: Do not call this method with invalid or null pointers as it will likely
    cause crashes or undefined behavior. Ensure that the provided grid, map, and cell
    values are valid for the current phase owner's location. This method should only
    be invoked when a legitimate phase change has occurred to avoid unnecessary processing.
  related:
  - GetOwnerPhase
  - SetOwnerPhase
  - UpdatePhaseForPlayer
metadata:
  confidence: 0.85
  generated_at: '2025-11-08T23:33:49.362393'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
