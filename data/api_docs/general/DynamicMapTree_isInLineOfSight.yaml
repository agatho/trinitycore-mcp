api:
  class: DynamicMapTree
  method: isInLineOfSight
  signature: bool DynamicMapTree::isInLineOfSight(const G3D::Vector3 & startPos, const
    G3D::Vector3 & endPos, const PhaseShift & phaseShift) const
documentation:
  brief: Determines whether there is a clear line of sight between two points in the
    dynamic map tree, considering phase shifts.
  description: The isInLineOfSight method checks if a direct line can be drawn from
    a starting position to an ending position within the dynamic map tree structure.
    It takes into account the current phase shift information to determine visibility,
    which is crucial for gameplay mechanics such as spell casting, NPC vision, and
    player interaction. This method uses spatial data structures to efficiently test
    for obstructions between the two points. The result is true if there are no obstacles
    blocking the line of sight, and false otherwise. It's commonly used in World of
    Warcraft's TrinityCore server to enforce game rules related to visibility and
    interaction.
  parameters:
  - name: startPos
    description: The 3D vector representing the starting position for the line-of-sight
      check.
  - name: endPos
    description: The 3D vector representing the ending position for the line-of-sight
      check.
  - name: phaseShift
    description: The phase shift information that defines which game phases are active,
      affecting what objects are visible during the check.
  returns: Returns true if there is a clear line of sight between startPos and endPos,
    considering the provided phase shift. Returns false if any obstruction blocks
    the view.
  examples:
  - title: Basic Line of Sight Check
    code: "G3D::Vector3 start(100.0f, 200.0f, 300.0f);\nG3D::Vector3 end(150.0f, 250.0f,\
      \ 350.0f);\nPhaseShift phase;\nbool hasLOS = dynamicMapTree.isInLineOfSight(start,\
      \ end, phase);\nif (hasLOS)\n{\n    // Process interaction or spell casting\n\
      }"
    language: cpp
  - title: Using with Player Positions
    code: "Player* player1 = ...;\nPlayer* player2 = ...;\nG3D::Vector3 pos1 = player1->GetPosition();\n\
      G3D::Vector3 pos2 = player2->GetPosition();\nPhaseShift phase = player1->GetPhaseShift();\n\
      bool canSee = dynamicMapTree.isInLineOfSight(pos1, pos2, phase);\nif (canSee)\n\
      {\n    // Allow communication or attack\n}"
    language: cpp
  notes: This method relies on the underlying DynamicMapTree data structure for efficient
    spatial queries. It may perform poorly if called excessively without caching results.
    The phase shift parameter is critical for accurate visibility checks in phased
    environments.
  warnings: Do not use this method for frequent checks in tight loops as it can impact
    performance. Ensure that both startPos and endPos are valid 3D vectors within
    the map bounds to avoid undefined behavior.
  related:
  - getIntersectionTime
  - isInFront
  - getAreaInfo
metadata:
  confidence: 0.95
  generated_at: '2025-11-06T15:08:05.170557'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
