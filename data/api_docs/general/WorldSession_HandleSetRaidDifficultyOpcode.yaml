api:
  class: WorldSession
  method: HandleSetRaidDifficultyOpcode
  signature: void WorldSession::HandleSetRaidDifficultyOpcode(WorldPackets::Misc::SetRaidDifficulty
    & setRaidDifficulty)
documentation:
  brief: Sets the raid difficulty level for the player's current raid instance
  description: Handles the client-side opcode to change the raid difficulty setting
    for the player's current raid instance. This method processes a packet sent from
    the client containing the desired difficulty level and updates the player's raid
    difficulty preference. The method ensures that the requested difficulty is valid
    and within the player's allowed range. It also synchronizes this setting across
    the player's group members in the raid. The change affects loot distribution,
    encounter scaling, and other difficulty-specific mechanics within the raid instance.
  parameters:
  - name: setRaidDifficulty
    description: Packet containing the raid difficulty level requested by the client.
      This parameter includes the difficulty ID that the player wants to set for their
      current raid instance.
  returns: null
  examples:
  - title: Basic usage in a packet handler context
    code: "void WorldSession::HandleSetRaidDifficultyOpcode(WorldPackets::Misc::SetRaidDifficulty&\
      \ setRaidDifficulty)\n{\n    // Validate difficulty level\n    if (setRaidDifficulty.DifficultyID\
      \ >= 0 && setRaidDifficulty.DifficultyID <= 3)\n    {\n        // Apply the\
      \ new raid difficulty setting\n        _player->SetRaidDifficulty(setRaidDifficulty.DifficultyID);\n\
      \        // Broadcast updated difficulty to group members\n        SendRaidDifficultyUpdate();\n\
      \    }\n}"
    language: cpp
  notes: This method is typically called when a player changes their raid difficulty
    through the UI. The actual difficulty change may be subject to group leader permissions
    and instance restrictions. The method does not directly modify the instance's
    difficulty but rather updates the player's preference which is then applied to
    the group.
  warnings: Improper validation of the difficulty ID could lead to invalid difficulty
    settings or crashes. Ensure that all difficulty values are within valid ranges
    (typically 0-3 for normal, heroic, mythic, etc.). This method should only be called
    when the player is actually in a raid instance.
  related:
  - GetRaidDifficulty
  - SetRaidDifficulty
  - SendRaidDifficultyUpdate
metadata:
  confidence: 0.9
  generated_at: '2025-11-02T19:14:47.744363'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
