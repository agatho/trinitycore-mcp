api:
  class: ClassAI
  method: UpdateCombatState
  signature: void ClassAI::UpdateCombatState(int diff)
documentation:
  brief: Updates the combat state of the AI-controlled creature based on elapsed time.
  description: The UpdateCombatState method is responsible for managing the artificial
    intelligence behavior of a creature during active combat. It processes various
    combat-related logic including threat management, spell casting, movement decisions,
    and target selection based on the time elapsed since the last update. This method
    is typically called by the core game loop at regular intervals to ensure that
    AI-controlled creatures respond appropriately to changing battlefield conditions.
    The method evaluates current combat status, checks for valid targets, manages
    cooldowns, and executes appropriate combat actions based on the creature's AI
    type and current state.
  parameters:
  - name: diff
    description: The time difference in milliseconds since the last update call. This
      parameter determines how much time has passed and influences the timing of various
      combat behaviors such as spell cooldowns, movement calculations, and threat
      updates.
  returns: null
  examples:
  - title: Basic UpdateCombatState Call
    code: "void CreatureAI::UpdateAI(uint32 diff)\n{\n    if (UpdateCombatState(diff))\n\
      \        return;\n    // Additional AI logic\n}"
    language: cpp
  - title: Combat State Management in Custom AI
    code: "void MyCreatureAI::UpdateCombatState(int diff)\n{\n    if (!me->IsInCombat())\n\
      \        return;\n    \n    // Handle spell cooldowns\n    if (m_spellCooldown\
      \ > 0)\n        m_spellCooldown = std::max(0, m_spellCooldown - diff);\n   \
      \ \n    // Update threat table\n    UpdateThreatTable();\n    \n    // Execute\
      \ combat actions\n    if (CanCastSpell() && m_spellCooldown <= 0)\n    {\n \
      \       CastSpell();\n        m_spellCooldown = GetSpellCooldown();\n    }\n\
      }"
    language: cpp
  notes: This method is typically called from the creature's main AI update loop and
    should not be called directly by other systems. The 'diff' parameter must represent
    a valid time interval in milliseconds, typically obtained from the game's main
    update cycle. Performance considerations include avoiding heavy computations within
    this method as it's called frequently during combat. The method relies on internal
    state management and should only be invoked when the creature is actively engaged
    in combat.
  warnings: Do not call this method outside of combat situations as it may cause unexpected
    behavior or crashes. Ensure that all required AI state variables are properly
    initialized before calling this method. Improper handling of the 'diff' parameter
    can lead to incorrect timing of combat actions and spell cooldowns.
  related:
  - UpdateAI
  - EnterCombat
  - LeaveCombat
  - UpdateThreatTable
metadata:
  confidence: 0.9
  generated_at: '2025-11-07T04:50:19.816249'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
