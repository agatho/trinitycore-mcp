api:
  class: StaticMapTree
  method: getIntersectionTime
  signature: bool StaticMapTree::getIntersectionTime(const int & pRay, float & pMaxDist,
    bool pStopAtFirstHit, ModelIgnoreFlags ignoreFlags) const
documentation:
  brief: Calculates the intersection time of a ray with the static map tree, determining
    how far along the ray collision occurs.
  description: The getIntersectionTime method performs a ray intersection test against
    the static map tree data structure, which represents the geometry of the game
    world's terrain and structures. It determines at what distance along a given ray
    the first collision occurs, or returns false if no collision is found within the
    maximum distance. This functionality is crucial for various game mechanics such
    as line-of-sight checks, spell targeting, and NPC pathfinding. The method supports
    optional filtering of certain model types through ignoreFlags, allowing developers
    to exclude specific geometry from intersection tests. The ray parameter is typically
    a reference to a pre-defined ray structure that contains origin and direction
    information.
  parameters:
  - name: pRay
    description: Reference to an integer identifier representing the ray to test against
      the static map tree. This identifier typically refers to a pre-allocated ray
      structure in memory, containing origin and direction data for the intersection
      test.
  - name: pMaxDist
    description: Reference to a float value that represents the maximum distance to
      check along the ray. On successful intersection, this value will be updated
      with the actual distance at which collision occurs. If no intersection is found
      within this distance, the method returns false.
  - name: pStopAtFirstHit
    description: Boolean flag indicating whether to stop at the first hit (true) or
      continue checking for all intersections (false). When true, only the closest
      intersection is returned; when false, all intersections are processed.
  - name: ignoreFlags
    description: ModelIgnoreFlags value that specifies which types of models should
      be ignored during the intersection test. This allows filtering out certain geometry
      like water or specific building parts from collision detection.
  returns: Returns true if an intersection is found within the maximum distance, false
    otherwise. When true, pMaxDist is updated with the distance to the intersection
    point.
  examples:
  - title: Basic Ray Intersection Test
    code: "float maxDist = 50.0f;\nbool hit = staticMapTree->getIntersectionTime(rayId,\
      \ maxDist, true, MODEL_IGNORE_NONE);\nif (hit)\n{\n    // Collision occurred\
      \ at maxDist units along the ray\n    printf(\"Hit at distance: %f\\n\", maxDist);\n\
      }\nelse\n{\n    // No collision within maxDist\n    printf(\"No hit within range\\\
      n\");\n}"
    language: cpp
  - title: Advanced Ray Test with Model Filtering
    code: "float maxDist = 100.0f;\nModelIgnoreFlags ignoreFlags = MODEL_IGNORE_WATER\
      \ | MODEL_IGNORE_SPELL_FOCUS;\nbool hit = staticMapTree->getIntersectionTime(rayId,\
      \ maxDist, true, ignoreFlags);\nif (hit)\n{\n    // Process intersection with\
      \ filtered geometry\n    printf(\"Hit at distance: %f\\n\", maxDist);\n}\nelse\n\
      {\n    // No valid intersection found\n    printf(\"No valid hit\\n\");\n}"
    language: cpp
  notes: This method is part of the static map tree system used for efficient spatial
    queries in TrinityCore. The ray parameter must reference a valid ray structure
    that has been properly initialized with origin and direction vectors. Performance
    can be affected by complex terrain or numerous intersecting models, so it's recommended
    to use reasonable maximum distances.
  warnings: Ensure that the pRay identifier points to a properly initialized ray structure;
    otherwise behavior is undefined. The method modifies pMaxDist in place, so make
    sure this is handled correctly in your code logic. Using very large pMaxDist values
    can impact performance significantly.
  related:
  - getIntersectionTime
  - getAreaInfo
  - isInLineOfSight
metadata:
  confidence: 0.85
  generated_at: '2025-11-07T18:43:10.508725'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
