api:
  class: AuraEffect
  method: HandleAuraModSchoolImmunity
  signature: void AuraEffect::HandleAuraModSchoolImmunity(const AuraApplication *
    aurApp, uint8 mode, bool apply) const
documentation:
  brief: Applies or removes school immunity effects from an aura application.
  description: The HandleAuraModSchoolImmunity method manages the application and
    removal of magical school immunities granted by aura effects. It modifies the
    target's immunity state based on the aura's properties and the specified mode
    (apply or remove). This method is typically invoked during aura application or
    removal events, adjusting the affected unit's resistance to specific damage types
    such as physical, holy, fire, nature, etc. The implementation ensures that the
    target's immunity flags are correctly updated according to the aura's school mask
    and the operation mode.
  parameters:
  - name: aurApp
    description: Pointer to the AuraApplication object representing the aura being
      applied or removed. This contains information about which unit is affected and
      the specific aura properties.
  - name: mode
    description: The operation mode indicating whether to apply (true) or remove (false)
      the immunity effect. Typically corresponds to AuraApplication::Apply or AuraApplication::Remove
      states.
  - name: apply
    description: Boolean flag determining if the immunity is being applied (true)
      or removed (false). This parameter controls the direction of the effect modification.
  returns: null
  examples:
  - title: Applying School Immunity Aura
    code: "void ApplyFireImmunity(Unit* target)\n{\n    AuraApplication* app = new\
      \ AuraApplication(target, target, SpellInfo::GetSpellInfo(12345));\n    auraEffect->HandleAuraModSchoolImmunity(app,\
      \ AURA_APPLY, true);\n}"
    language: cpp
  - title: Removing School Immunity Aura
    code: "void RemoveShadowImmunity(Unit* target)\n{\n    AuraApplication* app =\
      \ new AuraApplication(target, target, SpellInfo::GetSpellInfo(67890));\n   \
      \ auraEffect->HandleAuraModSchoolImmunity(app, AURA_REMOVE, false);\n}"
    language: cpp
  notes: This method directly manipulates the unit's immunity flags and should only
    be called during proper aura application/removal sequences. The school mask used
    in the aura determines which damage types are affected by this immunity.
  warnings: Improper use of this method can lead to incorrect immunity states, potentially
    causing unexpected damage behavior or exploits. Ensure that the AuraApplication
    object passed is valid and properly initialized before calling this method.
  related:
  - AuraEffect::HandleAuraModDamageImmunity
  - AuraEffect::HandleAuraModHealImmunity
  - AuraEffect::HandleAuraModSchoolAbsorb
metadata:
  confidence: 0.9
  generated_at: '2025-10-31T13:07:55.677918'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
