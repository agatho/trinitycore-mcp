api:
  class: TargetSelector
  method: CanAttack
  signature: bool TargetSelector::CanAttack(Unit * target) const
documentation:
  brief: Determines whether the unit can attack a specified target based on game rules
    and conditions.
  description: The CanAttack method evaluates if a given unit is a valid target for
    attack by checking various game state conditions such as faction neutrality, PvP
    status, looting permissions, and other combat-related restrictions. This method
    is typically used in AI behavior trees or combat logic to filter out invalid targets
    before attempting an attack. It ensures that units do not engage in inappropriate
    actions like attacking friendly NPCs or players under certain protection states.
  parameters: []
  returns: Returns true if the target is valid for attack according to game rules,
    false otherwise. The method considers factors such as faction relations, PvP status,
    and current combat state to determine validity.
  examples:
  - title: Basic Usage in AI Logic
    code: "if (unit->GetAI()->CanAttack(target)) {\n    unit->Attack(target, true);\n\
      } else {\n    // Find another target or move away\n}"
    language: cpp
  - title: Integration with Target Selection
    code: "class MyAI : public CreatureAI {\npublic:\n    void UpdateAI(uint32 diff)\
      \ override {\n        if (!UpdateVictim())\n            return;\n        \n\
      \        Unit* target = me->GetVictim();\n        if (target && !CanAttack(target))\
      \ {\n            me->CombatStop();\n            me->GetMotionMaster()->MoveTargetedHome();\n\
      \        }\n    }\n};"
    language: cpp
  notes: This method is commonly used in conjunction with other AI decision-making
    functions to build robust targeting logic. It may perform multiple checks internally
    including faction comparison, PvP flag status, and target state validation. The
    implementation likely caches certain values for performance optimization.
  warnings: Ensure that the target pointer is valid before calling this method to
    avoid undefined behavior. This method does not validate whether the unit itself
    is capable of attacking (e.g., has weapons equipped), only whether it's a suitable
    target from a game rule perspective.
  related:
  - CanMutualExclude
  - IsHostileTo
  - IsValidAttackTarget
metadata:
  confidence: 0.9
  generated_at: '2025-11-03T17:18:13.544958'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
