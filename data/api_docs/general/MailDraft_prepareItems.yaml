api:
  class: MailDraft
  method: prepareItems
  signature: void MailDraft::prepareItems(Player * receiver, int trans)
documentation:
  brief: Prepares mail items for delivery to a player recipient
  description: The prepareItems method processes and prepares the items associated
    with a MailDraft for delivery to a specified player recipient. It handles the
    necessary setup and validation of items before they are added to the mail system,
    ensuring proper item ownership transfer and inventory management. This method
    is typically called internally by the mail system when preparing a mail message
    for sending, and it manages the transaction state of items being sent via mail.
    The method requires a valid player recipient and a transaction type parameter
    to properly handle item transfers.
  parameters:
  - name: receiver
    description: Pointer to the Player object who will receive the mail items. Must
      be a valid player instance with an active session.
  - name: trans
    description: Transaction type identifier that determines how item ownership and
      state changes are handled during mail delivery. Common values include transaction
      types for mail sending, auction house transactions, or general item transfers.
  returns: null
  examples:
  - title: Basic mail preparation with player recipient
    code: 'MailDraft draft;

      draft.AddItem(itemTemplateId, itemCount);

      Player* receiver = ...; // Valid player instance

      int transactionType = MAIL_SENDER_PLAYER;

      draft.prepareItems(receiver, transactionType);'
    language: cpp
  - title: Preparing items for mail with specific transaction handling
    code: 'MailDraft draft;

      Item* item = ...; // Valid item instance

      Player* receiver = ...; // Valid player instance

      int transactionType = MAIL_SENDER_AUCTION;

      draft.AddItem(item);

      draft.prepareItems(receiver, transactionType);'
    language: cpp
  notes: This method internally manages the state transition of items to ensure they
    are properly marked for mail delivery. It performs necessary checks on item validity
    and player inventory capacity before preparing items. The transaction parameter
    is crucial for proper item handling and should match the intended mail operation
    type.
  warnings: Calling this method without a valid receiver pointer will result in undefined
    behavior or crashes. Ensure that the transaction type matches the intended mail
    operation to avoid incorrect item state management.
  related:
  - MailDraft::AddItem
  - MailDraft::SendMailTo
  - MailDraft::prepareItems
metadata:
  confidence: 0.85
  generated_at: '2025-11-08T00:33:36.742842'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
