api:
  class: WorldSession
  method: HandleCancelTempEnchantmentOpcode
  signature: void WorldSession::HandleCancelTempEnchantmentOpcode(WorldPackets::Item::CancelTempEnchantment
    & cancelTempEnchantment)
documentation:
  brief: Cancels temporary enchantments on an item in the player's inventory.
  description: The HandleCancelTempEnchantmentOpcode method processes a client request
    to remove temporary enchantments from an item. This typically occurs when a player
    uses the 'Cancel Temporary Enchant' feature, which removes enchantments that were
    applied temporarily (such as those from enchanting scrolls or certain spells).
    The method validates the item's existence and ownership before proceeding with
    the removal of the temporary enchantment. It ensures that only valid items in
    the player's possession can have their temporary enchantments canceled, preventing
    exploitation of the enchantment system.
  parameters:
  - name: cancelTempEnchantment
    description: A packet containing information about which item to cancel the temporary
      enchantment from, including the item's GUID and slot information.
  returns: null
  examples:
  - title: Basic Usage Example
    code: "void WorldSession::HandleCancelTempEnchantmentOpcode(WorldPackets::Item::CancelTempEnchantment&\
      \ cancelTempEnchantment)\n{\n    if (!GetPlayer())\n        return;\n\n    Item*\
      \ item = GetPlayer()->GetItemByGuid(cancelTempEnchantment.ItemGuid);\n    if\
      \ (!item)\n        return;\n\n    // Cancel the temporary enchantment on the\
      \ item\n    item->RemoveEnchantment(ENCHANTMENT_SLOT_TEMP);\n}"
    language: cpp
  notes: This method is part of the item management system in TrinityCore and interacts
    with the player's inventory. It assumes that the client has already validated
    the item's existence and ownership before sending the packet to the server.
  warnings: Improper handling of item GUIDs or slot validation could lead to exploits
    where players remove enchantments from items they do not own. Always validate
    item ownership and ensure proper error handling for invalid requests.
  related:
  - HandleItemQuerySingleOpcode
  - HandleEnchantItemOpcode
  - GetPlayer
  - GetItemByGuid
metadata:
  confidence: 0.9
  generated_at: '2025-11-02T19:41:23.942309'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
