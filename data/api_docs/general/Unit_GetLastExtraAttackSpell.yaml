api:
  class: Unit
  method: GetLastExtraAttackSpell
  signature: uint32 Unit::GetLastExtraAttackSpell() const
documentation:
  brief: Returns the spell ID of the last extra attack spell used by the unit.
  description: This method retrieves the unique identifier (spell ID) of the most
    recently executed extra attack spell from the Unit's spell list. It is commonly
    used in combat scenarios to track special attacks or abilities that occur during
    melee attacks, such as triggered spells from talents or effects from items. The
    returned value represents a specific spell that was last used for an extra attack,
    typically related to weapon-based attacks or special abilities. This method is
    particularly useful for determining which spell was last executed when a unit
    performs an extra attack, and can be used in conjunction with other combat-related
    methods to analyze attack behavior.
  parameters: []
  returns: Returns the spell ID of the last extra attack spell, or 0 if no such spell
    exists. A value of 0 indicates that no extra attack spell has been executed recently
    or that the unit does not have any extra attack spells in its current spell list.
  examples:
  - title: Basic usage example
    code: "uint32 lastSpell = unit->GetLastExtraAttackSpell();\nif (lastSpell != 0)\n\
      {\n    // Handle the extra attack spell\n}"
    language: cpp
  notes: This method is typically used in combat analysis and can be affected by various
    game mechanics such as talent effects, item set bonuses, or weapon-based abilities.
    It may not always reflect the most recent extra attack if the unit has multiple
    spell sources or if the spell was not properly tracked.
  warnings: This method should not be confused with other methods like GetLastSpellCast
    or GetExtraAttackSpell, which may return different values depending on how the
    unit's spell list is managed. Also, this method does not guarantee that the returned
    spell ID corresponds to a valid spell in the game database.
  related:
  - GetLastSpellCast
  - GetExtraAttackSpell
  - GetSpellInfo
metadata:
  confidence: 0.85
  generated_at: '2025-10-30T13:05:37.670704'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
