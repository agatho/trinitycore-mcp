api:
  class: NPCInteractionManager
  method: RecordSpellLearned
  signature: void NPCInteractionManager::RecordSpellLearned(uint32 spellId, uint32
    cost)
documentation:
  brief: Records that a player has learned a spell from an NPC interaction.
  description: The RecordSpellLearned method is used to log the acquisition of a spell
    by a player through NPC interaction within the TrinityCore framework. This function
    typically updates internal tracking systems to ensure that players cannot repeatedly
    learn the same spell via the same NPC, and may also handle associated costs or
    prerequisites. The method is part of the NPC interaction management system and
    is generally called when an NPC offers a spell to a player and the player successfully
    learns it. It does not directly modify the player's spellbook but rather maintains
    state information about the learning event.
  parameters:
  - name: spellId
    description: The unique identifier of the spell being learned. This must correspond
      to a valid Spell entry in the database.
  - name: cost
    description: The cost associated with learning the spell, such as gold or reputation.
      This value may be used for validation or display purposes but is not directly
      processed by this method.
  returns: null
  examples:
  - title: Basic Spell Learning Record
    code: 'NPCInteractionManager interactionMgr;

      uint32 spellId = 12345;

      uint32 cost = 1000;

      interactionMgr.RecordSpellLearned(spellId, cost);'
    language: cpp
  - title: Integration with Player Spell Learning Logic
    code: "void OnPlayerLearnSpell(Player* player, uint32 spellId) {\n    // Validate\
      \ spell and cost before recording\n    if (IsSpellValid(spellId) && IsCostValid(cost))\
      \ {\n        NPCInteractionManager::GetSingleton().RecordSpellLearned(spellId,\
      \ GetSpellCost(spellId));\n        player->AddSpell(spellId);\n    }\n}"
    language: cpp
  notes: This method is typically invoked during spell learning events triggered by
    NPC dialogues. It assumes that the spell and cost parameters are already validated
    before calling, as it does not perform any validation itself. The actual spell
    addition to the player's spellbook should be handled separately by other systems.
  warnings: Ensure that this method is only called after verifying that the player
    has met all prerequisites for learning the spell. Calling this method without
    proper checks may lead to inconsistent state or exploit opportunities.
  related:
  - GetSpellLearned
  - IsSpellLearned
  - ResetSpellLearning
metadata:
  confidence: 0.9
  generated_at: '2025-11-09T05:11:18.757269'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
