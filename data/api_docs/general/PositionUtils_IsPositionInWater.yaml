api:
  class: PositionUtils
  method: IsPositionInWater
  signature: bool PositionUtils::IsPositionInWater(const int & pos, Map * map)
documentation:
  brief: Determines whether a given position is located underwater within a specified
    map.
  description: The IsPositionInWater method checks if a specific position, defined
    by its coordinates and map reference, lies within water terrain. This utility
    function is commonly used in World of Warcraft's TrinityCore server implementation
    to determine environmental conditions for game mechanics such as swimming, water-based
    spell effects, or NPC behavior. The method evaluates the height and terrain data
    of the specified position against the map's water level to make this determination.
    It requires a valid Map pointer and proper coordinate values to function correctly.
  parameters:
  - name: pos
    description: Reference to an integer representing the position identifier or index
      within the map. This typically corresponds to a specific location in the game
      world, often used as a lookup key for terrain data.
  - name: map
    description: Pointer to the Map object where the position is located. This parameter
      is essential for accessing the map's terrain and water level information needed
      for the check.
  returns: Returns true if the specified position is located underwater, false otherwise.
    The method will return false if either the position or map parameters are invalid.
  examples:
  - title: Basic Usage
    code: "Map* myMap = ...; // Get a valid map reference\nint positionId = 12345;\
      \ // Some position identifier\nbool isInWater = PositionUtils::IsPositionInWater(positionId,\
      \ myMap);\nif (isInWater) {\n    // Handle underwater logic\n}"
    language: cpp
  - title: Using with Game Logic
    code: "void CheckPlayerSwimming(Player* player) {\n    Map* map = player->GetMap();\n\
      \    int positionId = player->GetPositionId(); // Assuming such a method exists\n\
      \    if (PositionUtils::IsPositionInWater(positionId, map)) {\n        player->SetUnitFlag(UnitFlags::UNIT_FLAG_SWIMMING);\n\
      \    } else {\n        player->RemoveUnitFlag(UnitFlags::UNIT_FLAG_SWIMMING);\n\
      \    }\n}"
    language: cpp
  notes: This method relies on the underlying map data structures and terrain information.
    It is recommended to validate that both parameters are non-null before calling
    this function. Performance may be impacted when checking many positions in rapid
    succession due to repeated terrain lookups.
  warnings: Ensure that the position identifier corresponds to a valid location within
    the provided map's coordinate system. Invalid or out-of-bounds positions may lead
    to undefined behavior or incorrect results. This method should not be used with
    maps that do not have water data initialized.
  related:
  - GetPositionWaterLevel
  - IsPositionInLava
  - GetTerrainHeightAtPosition
metadata:
  confidence: 0.85
  generated_at: '2025-11-03T21:06:17.208938'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
