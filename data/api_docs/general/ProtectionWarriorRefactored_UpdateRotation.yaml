api:
  class: ProtectionWarriorRefactored
  method: UpdateRotation
  signature: void ProtectionWarriorRefactored::UpdateRotation(::Unit * target)
documentation:
  brief: Updates the protection warrior's rotation based on the current target and
    combat state
  description: The UpdateRotation method is responsible for determining and executing
    the optimal sequence of abilities for a protection warrior during combat. This
    method evaluates the current target's health, threat level, available resources,
    and combat situation to decide which abilities should be used next in the rotation.
    It typically involves checking for cooldowns, mana requirements, and positional
    factors to ensure efficient resource usage and maximum damage mitigation or damage
    output. The method is called regularly during combat to maintain an optimal rotation
    strategy.
  parameters:
  - name: target
    description: Pointer to the Unit object representing the current combat target.
      This parameter determines which enemy the warrior will focus their rotation
      on, and influences decisions about ability usage such as Shield Block, Revenge,
      or Devastate.
  returns: null
  examples:
  - title: Basic Usage in Combat
    code: "void MyProtectionWarriorAI::Update()\n{\n    if (Unit* target = GetVictim())\n\
      \    {\n        UpdateRotation(target);\n    }\n}"
    language: cpp
  - title: Integration with Custom AI Logic
    code: "void ProtectionWarriorRefactored::UpdateRotation(Unit* target)\n{\n   \
      \ if (!target || !target->IsAlive())\n        return;\n\n    // Check for defensive\
      \ cooldowns\n    if (HasAura(SpellIds::ShieldBlock) && !HasAura(SpellIds::Revenge))\n\
      \    {\n        // Use Revenge when available\n        CastSpell(SpellIds::Revenge);\n\
      \    }\n    else if (GetManaPct() > 30)\n    {\n        // Use Devastate when\
      \ mana is sufficient\n        CastSpell(SpellIds::Devastate);\n    }\n    else\n\
      \    {\n        // Use Shield Block to generate threat and mitigate damage\n\
      \        CastSpell(SpellIds::ShieldBlock);\n    }\n}"
    language: cpp
  notes: This method is typically called from within the AI update loop, often every
    100-200ms during active combat. The implementation may vary between different
    versions of TrinityCore and can be influenced by various factors including player
    level, gear, and talent choices. It's important to note that this method assumes
    valid target and combat state conditions.
  warnings: Ensure the target parameter is not null or invalid before calling this
    method, as it could lead to undefined behavior. The method does not handle target
    switching or combat initiation - these should be managed by higher-level AI logic.
  related:
  - GetVictim
  - CastSpell
  - HasAura
  - GetManaPct
metadata:
  confidence: 0.85
  generated_at: '2025-11-07T21:53:22.879229'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
