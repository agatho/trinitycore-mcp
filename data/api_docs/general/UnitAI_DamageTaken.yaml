api:
  class: UnitAI
  method: DamageTaken
  signature: void UnitAI::DamageTaken(Unit * param0, uint32 & param1, DamageEffectType
    param2, const SpellInfo * param3)
documentation:
  brief: Handles damage received by a unit and updates its AI state accordingly
  description: The DamageTaken method is invoked when a Unit receives damage from
    another source. It processes the damage event, potentially triggering AI behaviors
    such as aggro changes, threat updates, or health-based reactions. This method
    allows AI implementations to customize how their units respond to incoming damage,
    including modifying damage values or initiating combat behavior. The method is
    typically called internally by the core game engine during combat calculations.
  parameters:
  - name: param0
    description: Pointer to the Unit that took the damage. This represents the target
      unit whose health is being reduced.
  - name: param1
    description: Reference to the damage amount being dealt. This value can be modified
      by AI implementations to adjust incoming damage.
  - name: param2
    description: Enumeration indicating the type of damage effect (e.g., DIRECT_DAMAGE,
      SPELL_DIRECT_DAMAGE). Used to determine how the damage should be processed or
      visualized.
  - name: param3
    description: Pointer to the SpellInfo structure describing the spell that caused
      the damage, if applicable. Can be null for non-spell damage sources.
  returns: null
  examples:
  - title: Basic Damage Adjustment Example
    code: "void MyAI::DamageTaken(Unit* target, uint32& damage, DamageEffectType damagetype,\
      \ const SpellInfo* spellInfo)\n{\n    // Reduce incoming damage by 25%\n   \
      \ damage = damage * 0.75f;\n}\n"
    language: cpp
  - title: Threat Generation Based on Damage Type
    code: "void MyAI::DamageTaken(Unit* target, uint32& damage, DamageEffectType damagetype,\
      \ const SpellInfo* spellInfo)\n{\n    if (damagetype == DIRECT_DAMAGE)\n   \
      \ {\n        // Increase threat for direct damage\n        target->GetThreatManager().AddThreat(target,\
      \ damage * 2);\n    }\n}\n"
    language: cpp
  notes: This method is part of the AI callback system and should not be called directly
    unless implementing custom AI logic. The damage value passed in param1 can be
    modified to alter how much damage is actually applied to the unit. Be cautious
    when modifying the damage amount, as it may affect combat balance or other systems
    relying on accurate damage reporting.
  warnings: Modifying the damage value (param1) directly can lead to unexpected behavior
    if not handled carefully. AI implementations should ensure that any modifications
    maintain game balance and do not introduce exploits. Also note that this method
    is called during active combat processing, so avoid performing heavy operations
    or blocking calls inside it.
  related:
  - Unit::DealDamage
  - UnitAI::DamageDealt
  - Unit::GetThreatManager
metadata:
  confidence: 0.9
  generated_at: '2025-11-06T00:19:46.207609'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
