api:
  class: WorldSession
  method: IsLegitCharacterForAccount
  signature: bool WorldSession::IsLegitCharacterForAccount(int lowGUID)
documentation:
  brief: Validates if a character GUID belongs to the current session's account
  description: The IsLegitCharacterForAccount method checks whether the specified
    character GUID (lowGUID) is associated with the account currently logged in through
    this WorldSession. This validation ensures that players cannot access or manipulate
    characters that do not belong to their account, providing security and integrity
    for character management within the TrinityCore framework. The method performs
    a database lookup to confirm the ownership relationship between the character
    and the session's account.
  parameters:
  - name: lowGUID
    description: The low part of the character's GUID to validate against the current
      session's account
  returns: Returns true if the character with the specified lowGUID belongs to the
    account associated with this WorldSession; otherwise returns false
  examples:
  - title: Basic Character Validation
    code: "if (session->IsLegitCharacterForAccount(12345)) {\n    // Proceed with\
      \ character operations\n    sLog->outString(\"Character is valid for this account\"\
      );\n} else {\n    // Handle unauthorized access attempt\n    sLog->outString(\"\
      Unauthorized access attempt detected\");\n}"
    language: cpp
  notes: This method typically involves a database query to verify character ownership.
    It should be used before performing any operations that modify or access character
    data to prevent account hijacking or unauthorized access attempts.
  warnings: Do not use this method as a substitute for proper authentication checks
    in all security-sensitive operations. Always ensure that additional validation
    is performed where necessary, especially when dealing with critical character
    modifications.
  related:
  - GetAccountId
  - GetPlayer
  - IsAccountGM
metadata:
  confidence: 0.9
  generated_at: '2025-11-07T08:31:03.242973'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
