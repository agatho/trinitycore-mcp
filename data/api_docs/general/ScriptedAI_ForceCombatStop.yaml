api:
  class: ScriptedAI
  method: ForceCombatStop
  signature: void ScriptedAI::ForceCombatStop(int * who, bool reset)
documentation:
  brief: Stops the AI from engaging in combat and resets its combat state.
  description: The ForceCombatStop method is used to immediately terminate any active
    combat state for an AI-controlled creature. It ensures that the creature exits
    combat, clears its current target, and resets its combat-related flags and timers.
    This method is typically invoked when external conditions require the AI to cease
    fighting, such as during scripted events, phase changes, or when the creature
    needs to be repositioned without maintaining its combat stance. The method respects
    the reset parameter to determine whether to fully reset the AI's combat state
    or simply stop the current engagement.
  parameters:
  - name: who
    description: Pointer to an integer identifying the entity that triggered the combat
      stop. This value is used internally by the AI system to track which unit caused
      the combat to end.
  - name: reset
    description: Boolean flag indicating whether to fully reset the AI's combat state
      (true) or just stop the current combat engagement (false). When true, all combat-related
      flags and timers are cleared.
  returns: This method does not return a value.
  examples:
  - title: Basic Usage to Stop Combat
    code: "void OnEventReceived()\n{\n    // Stop combat for the AI\n    ForceCombatStop(nullptr,\
      \ true);\n}"
    language: cpp
  - title: Conditional Combat Stop with Target Tracking
    code: "void OnSpellHit(Unit* caster)\n{\n    if (caster->GetTypeId() == TYPEID_PLAYER)\n\
      \    {\n        int who = caster->GetGUID().GetCounter();\n        ForceCombatStop(&who,\
      \ false);\n    }\n}"
    language: cpp
  notes: This method should be used carefully as it bypasses normal combat termination
    logic. Ensure that any necessary cleanup or event handling is performed before
    calling this method to avoid inconsistent AI states.
  warnings: Calling ForceCombatStop with reset=true will clear all combat-related
    state, including target tracking and timers. This may cause unexpected behavior
    if other systems depend on the AI maintaining its combat state.
  related:
  - EnterCombat
  - CombatStart
  - UpdateAI
  - DoMeleeAttackIfReady
metadata:
  confidence: 0.9
  generated_at: '2025-11-01T21:47:38.320279'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
