api:
  class: AuraEffect
  method: HandleArenaPreparation
  signature: void AuraEffect::HandleArenaPreparation(const AuraApplication * aurApp,
    uint8 mode, bool apply) const
documentation:
  brief: Handles the arena preparation aura effect application or removal for players
    in an arena match.
  description: The HandleArenaPreparation method is responsible for managing the application
    and removal of the arena preparation aura effect, which is typically used during
    the pre-match countdown period in arena battles. This method ensures that players
    are properly debuffed or buffed according to the game's arena rules, such as applying
    movement restrictions or other temporary effects before the match begins. It operates
    on the AuraApplication object provided and modifies player states based on whether
    the aura is being applied or removed. The method is part of the core aura handling
    system in TrinityCore and integrates with the broader arena matchmaking and gameplay
    mechanics.
  parameters:
  - name: aurApp
    description: Pointer to the AuraApplication object representing the aura being
      applied or removed. This contains information about which unit the aura affects
      and the aura's properties.
  - name: mode
    description: The mode of operation, typically indicating whether this is a pre-match
      preparation phase (usually 0) or another state. Valid values are generally 0
      for preparation, though specific implementations may vary.
  - name: apply
    description: Boolean flag indicating whether to apply (true) or remove (false)
      the aura effect. When true, the aura is applied to the target; when false, it's
      removed.
  returns: null
  examples:
  - title: Applying Arena Preparation Aura
    code: "void ApplyArenaPrepAura(Player* player)\n{\n    if (Aura* aura = player->GetAura(12345))\
      \ // Assume 12345 is the arena prep aura ID\n    {\n        AuraApplication*\
      \ app = aura->GetApplicationOf(player);\n        if (app)\n        {\n     \
      \       aura->GetEffect(0)->HandleArenaPreparation(app, 0, true);\n        }\n\
      \    }\n}"
    language: cpp
  - title: Removing Arena Preparation Aura
    code: "void RemoveArenaPrepAura(Player* player)\n{\n    if (Aura* aura = player->GetAura(12345))\n\
      \    {\n        AuraApplication* app = aura->GetApplicationOf(player);\n   \
      \     if (app)\n        {\n            aura->GetEffect(0)->HandleArenaPreparation(app,\
      \ 0, false);\n        }\n    }\n}"
    language: cpp
  notes: This method is typically called internally by the TrinityCore aura system
    when an arena preparation aura is applied or removed. Developers should ensure
    that the AuraApplication object passed to this function is valid and corresponds
    to a proper arena preparation effect. The mode parameter is often used for future
    extensibility but currently only supports 0 for standard arena prep.
  warnings: Improper use of this method can result in incorrect player state during
    arena matches, potentially causing movement glitches or other gameplay issues.
    Always verify that the AuraApplication object and aura ID are valid before calling
    this method.
  related:
  - AuraEffect::HandleEffect
  - AuraApplication::GetTarget
  - Unit::AddAura
  - Unit::RemoveAura
metadata:
  confidence: 0.9
  generated_at: '2025-10-31T13:38:19.762780'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
