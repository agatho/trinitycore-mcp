api:
  class: PhasingHandler
  method: UpdateVisibilityIfNeeded
  signature: void PhasingHandler::UpdateVisibilityIfNeeded(WorldObject * object, bool
    updateVisibility, bool changed)
documentation:
  brief: Updates the visibility state of a WorldObject based on phasing rules and
    changes.
  description: The UpdateVisibilityIfNeeded method is responsible for managing the
    visibility of WorldObject instances within the TrinityCore framework. It evaluates
    whether an object's visibility needs to be updated according to phasing rules,
    which determine when objects should be visible or hidden to players based on various
    conditions such as phase masks, world states, and player-specific flags. The method
    takes into account whether a visibility update is required and whether the object
    has changed in a way that affects its visibility. This ensures that objects are
    properly shown or hidden in different phases of the game world without unnecessary
    performance overhead.
  parameters:
  - name: object
    description: Pointer to the WorldObject whose visibility state needs to be updated.
      This can be any object derived from WorldObject such as Player, Creature, GameObject,
      or Item.
  - name: updateVisibility
    description: Boolean flag indicating whether a visibility update should be forced
      or performed conditionally. If true, the method will check and potentially update
      visibility regardless of previous state.
  - name: changed
    description: Boolean flag indicating whether the object has undergone changes
      that might affect its visibility. When true, the method will perform additional
      checks to determine if visibility should be updated.
  returns: null
  examples:
  - title: Basic Usage in Object Update Loop
    code: "void UpdatePlayerVisibility(Player* player)\n{\n    PhasingHandler::UpdateVisibilityIfNeeded(player,\
      \ true, false);\n}"
    language: cpp
  - title: Conditional Visibility Update with Change Detection
    code: "void HandleObjectMovement(WorldObject* obj)\n{\n    bool hasChanged = obj->HasMoved();\n\
      \    PhasingHandler::UpdateVisibilityIfNeeded(obj, false, hasChanged);\n}"
    language: cpp
  notes: This method is typically called during object updates and world state changes.
    It leverages the phasing system to ensure objects are only visible when they should
    be according to game rules. The method may trigger visibility events internally,
    which can cause related objects to also update their visibility states.
  warnings: Calling this method with incorrect parameters might lead to inconsistent
    visibility states or performance issues. Ensure that object pointers are valid
    and that the updateVisibility flag is set appropriately based on the context of
    the call.
  related:
  - PhasingHandler::IsInvisible
  - PhasingHandler::UpdateVisibility
  - WorldObject::UpdateVisibility
metadata:
  confidence: 0.9
  generated_at: '2025-11-03T21:50:48.671033'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
