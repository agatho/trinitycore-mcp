api:
  class: MageAI
  method: CanPolymorphSafely
  signature: bool MageAI::CanPolymorphSafely(::Unit * target)
documentation:
  brief: Determines whether a Mage AI can safely cast Polymorph on a target without
    risking self-harm or violating game mechanics.
  description: The CanPolymorphSafely method evaluates if it is safe for a Mage AI
    to cast the Polymorph spell on a given target. This method considers various factors
    such as the target's threat level, distance from the caster, presence of harmful
    effects, and whether the target is already affected by Polymorph or similar spells.
    It ensures that casting Polymorph does not lead to detrimental outcomes for the
    mage or disrupt game balance. The method returns true if all safety checks pass,
    allowing the spell to be cast; otherwise, it returns false to prevent unsafe or
    invalid casts.
  parameters:
  - name: target
    description: Pointer to the Unit object that represents the target of the Polymorph
      spell. Must not be null. The method evaluates this unit's state and position
      relative to the caster.
  returns: Returns true if the mage AI can safely cast Polymorph on the target, considering
    threat, proximity, and existing effects. Returns false if casting would be unsafe
    or invalid.
  examples:
  - title: Basic usage in Mage AI logic
    code: "if (mageAI->CanPolymorphSafely(targetUnit)) {\n    mageAI->CastSpell(targetUnit,\
      \ SPELL_POLYMORPH);\n}"
    language: cpp
  - title: Safe Polymorph with fallback behavior
    code: "if (!mageAI->CanPolymorphSafely(targetUnit)) {\n    // Try alternative\
      \ spell or strategy\n    mageAI->CastSpell(targetUnit, SPELL_FROST_NOVA);\n}"
    language: cpp
  notes: This method is part of the Mage AI's decision-making process and integrates
    with TrinityCore's combat system. It may consider target immunity, threat table
    status, and spell cooldowns internally. The method assumes that the target pointer
    is valid and not null.
  warnings: Do not call this method without ensuring that the target unit is valid
    and in scope. Calling with a null or invalid target pointer can lead to undefined
    behavior or crashes.
  related:
  - CastSpell
  - IsTargetInMeleeRange
  - CheckThreatLevel
metadata:
  confidence: 0.9
  generated_at: '2025-11-07T12:52:14.839589'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
