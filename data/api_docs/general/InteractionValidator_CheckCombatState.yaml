api:
  class: InteractionValidator
  method: CheckCombatState
  signature: bool InteractionValidator::CheckCombatState(::Player * bot, bool allowInCombat)
    const
documentation:
  brief: Checks if a player is in combat state and returns true if allowed or not
    in combat.
  description: The CheckCombatState method evaluates whether a given player character
    is currently engaged in combat. It takes into account an optional parameter that
    allows specifying whether the player should be permitted to interact while in
    combat. This validation is commonly used in AI behavior scripts or interaction
    systems where certain actions should be restricted during combat. The method ensures
    that game rules regarding player interactions during combat are respected, preventing
    unintended behaviors such as casting spells or using items while actively fighting.
  parameters:
  - name: bot
    description: Pointer to the Player object representing the character being validated
      for combat state.
  - name: allowInCombat
    description: Boolean flag indicating whether interaction is allowed when the player
      is in combat. If true, the method will return true even if the player is in
      combat; if false, it will return false if the player is in combat.
  returns: Returns true if the player is not in combat or if allowInCombat is true
    and the player is in combat. Returns false if the player is in combat and allowInCombat
    is false.
  examples:
  - title: Basic usage to check if player can interact
    code: "if (validator.CheckCombatState(player, false)) {\n    // Player can safely\
      \ perform actions\n    player->CastSpell(target, SPELL_ID, true);\n} else {\n\
      \    // Player is in combat and interaction not allowed\n    player->SendSystemMessage(\"\
      Cannot interact while in combat.\");\n}"
    language: cpp
  - title: Allowing interaction during combat
    code: "if (validator.CheckCombatState(player, true)) {\n    // Player can perform\
      \ actions even if in combat\n    player->AddAura(SPELL_AURA_ID, player);\n}\
      \ else {\n    // Player cannot perform actions\n    return false;\n}"
    language: cpp
  notes: This method relies on the internal combat state tracking of the Player object.
    It is important to note that this check does not modify or alter the player's
    combat status; it only evaluates it. Performance-wise, this function should be
    fast since it primarily checks flags within the Player class.
  warnings: Be cautious when using allowInCombat=true in scenarios where combat mechanics
    might be disrupted by allowing interactions during active fights. This could lead
    to unexpected behavior or exploits if not properly controlled.
  related:
  - IsInCombat
  - CanInteract
  - SetInCombat
metadata:
  confidence: 0.9
  generated_at: '2025-11-09T00:37:16.620544'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
