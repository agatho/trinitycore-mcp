api:
  class: MageAI
  method: OnCombatEnd
  signature: void MageAI::OnCombatEnd()
documentation:
  brief: Handles cleanup and state reset when a Mage AI character exits combat.
  description: The OnCombatEnd method is invoked when a Mage AI character concludes
    combat, allowing the AI to perform necessary cleanup operations and reset internal
    states. This includes clearing any active spell casts, resetting combat-related
    flags, and ensuring the AI returns to its default non-combat behavior. The method
    ensures that the mage's AI state is properly synchronized with the game world
    after exiting combat, preventing potential issues such as stuck spell casts or
    incorrect AI decision-making during subsequent encounters.
  parameters: []
  returns: null
  examples:
  - title: Basic usage in Mage AI combat exit
    code: "void MageAI::OnCombatEnd()\n{\n    // Reset spell casting state\n    _isCasting\
      \ = false;\n    \n    // Clear any active combat flags\n    _inCombat = false;\n\
      \    \n    // Return to default AI behavior\n    SetAIState(AI_STATE_IDLE);\n\
      }"
    language: cpp
  notes: This method is typically called automatically by the TrinityCore framework
    when a creature's combat state transitions from active to inactive. Developers
    should ensure that any custom implementation properly handles all AI-related state
    variables and does not leave the AI in an inconsistent state.
  warnings: Improper implementation of this method may result in spell casting issues,
    AI behavior anomalies, or memory leaks if internal states are not correctly reset.
    Ensure all combat-specific resources are properly released before returning from
    this function.
  related:
  - OnCombatStart
  - UpdateAI
  - IsInCombat
metadata:
  confidence: 0.9
  generated_at: '2025-11-06T09:04:04.795108'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
