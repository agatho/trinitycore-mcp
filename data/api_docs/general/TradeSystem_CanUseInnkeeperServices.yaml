api:
  class: TradeSystem
  method: CanUseInnkeeperServices
  signature: bool TradeSystem::CanUseInnkeeperServices(Player * player, uint32 innkeeperGuid)
documentation:
  brief: Checks whether a player can use innkeeper services such as resting and repairing
    items.
  description: The CanUseInnkeeperServices method determines if a given player is
    eligible to utilize innkeeper services within the game world. This includes checking
    various conditions such as the player's current state (e.g., not in combat, not
    dead), proximity to an innkeeper NPC, and whether the player has the necessary
    permissions or quests to access these services. The method ensures that players
    cannot abuse innkeeper functions when they are in invalid states, such as being
    in combat or under certain debuffs. It is typically called before allowing a player
    to interact with an innkeeper for actions like resting, repairing equipment, or
    accessing other innkeeper-specific features.
  parameters:
  - name: player
    description: Pointer to the Player object representing the character attempting
      to use innkeeper services.
  - name: innkeeperGuid
    description: The unique identifier (GUID) of the innkeeper NPC that the player
      is trying to interact with.
  returns: Returns true if the player can use the innkeeper services, false otherwise.
    This includes checks for valid player state, proximity to the innkeeper, and any
    restrictions or conditions preventing service usage.
  examples:
  - title: Basic Usage Check
    code: "if (TradeSystem::CanUseInnkeeperServices(player, innkeeperGuid)) {\n  \
      \  // Allow player to rest or repair\n    player->SaveToDB();\n    player->SetHealth(player->GetMaxHealth());\n\
      } else {\n    // Send error message or prevent interaction\n    player->SendNotification(\"\
      You cannot use this innkeeper right now.\");\n}"
    language: cpp
  notes: This method is part of the core trade and interaction system in TrinityCore.
    It performs several checks including combat state, distance to NPC, and player
    status flags. The implementation may also consider faction restrictions or quest
    requirements depending on the server configuration.
  warnings: Ensure that the Player pointer is valid before calling this method; passing
    a null pointer will result in undefined behavior. Also, verify that the innkeeperGuid
    corresponds to an actual innkeeper NPC in the world to avoid incorrect service
    access.
  related:
  - CanUseInnkeeperServices
  - IsInnkeeper
  - Player::SetInnkeeper
metadata:
  confidence: 0.9
  generated_at: '2025-11-03T16:11:25.391199'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
