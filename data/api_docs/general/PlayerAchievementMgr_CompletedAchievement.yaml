api:
  class: PlayerAchievementMgr
  method: CompletedAchievement
  signature: void PlayerAchievementMgr::CompletedAchievement(const AchievementEntry
    * entry, Player * referencePlayer)
documentation:
  brief: Marks an achievement as completed for a player and updates related tracking
    systems.
  description: The CompletedAchievement method is responsible for finalizing the completion
    of a specific achievement for a given player. It processes the achievement entry,
    updates the player's achievement progress in the database, and triggers any associated
    events or notifications. This method typically gets invoked when a player meets
    all criteria required to earn an achievement. The referencePlayer parameter ensures
    that the correct player context is used for updating statistics and potentially
    broadcasting achievement-related messages to the player's friends or guild members.
  parameters:
  - name: entry
    description: Pointer to the AchievementEntry structure containing metadata about
      the achievement being completed, including ID, criteria, flags, and display
      information.
  - name: referencePlayer
    description: Pointer to the Player object representing the player who has earned
      the achievement. Used for updating player-specific data and triggering related
      gameplay events.
  returns: null
  examples:
  - title: Basic Achievement Completion
    code: 'AchievementEntry const* entry = sAchievementMgr->GetAchievement(1234);

      Player* player = ...; // Obtain player reference

      player->GetAchievementMgr()->CompletedAchievement(entry, player);'
    language: cpp
  - title: Triggering Achievement Completion from Event Handler
    code: "void OnPlayerKill(Player* killer, Player* victim) {\n    if (killer &&\
      \ victim) {\n        AchievementEntry const* entry = sAchievementMgr->GetAchievement(5678);\n\
      \        killer->GetAchievementMgr()->CompletedAchievement(entry, killer);\n\
      \    }\n}"
    language: cpp
  notes: This method should only be called after verifying that the player has met
    all achievement criteria. It internally handles database persistence and may broadcast
    achievement notifications to nearby players or guild members depending on the
    achievement's flags.
  warnings: Calling this method without ensuring that the player actually completed
    the achievement criteria will result in incorrect progression data and potentially
    invalid achievements being recorded.
  related:
  - GetAchievement
  - UpdateAchievementCriteria
  - CheckAchievementCriteria
metadata:
  confidence: 0.9
  generated_at: '2025-11-02T01:36:13.792127'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
