api:
  class: RBACData
  method: CalculateNewPermissions
  signature: void RBACData::CalculateNewPermissions()
documentation:
  brief: Calculates and updates the set of permissions based on current role assignments
    and their associated privileges.
  description: The CalculateNewPermissions method computes the effective permissions
    for an RBAC (Role-Based Access Control) data instance by aggregating all assigned
    roles and their respective permission bits. This method is typically invoked when
    role assignments are modified or loaded to ensure that the internal permission
    set accurately reflects the current access control state. It processes the hierarchical
    structure of roles, applying inheritance rules where applicable, and updates the
    cached permission bitmask used for fast access checks during gameplay operations
    such as command execution or UI element visibility. The method does not take any
    parameters and directly modifies the internal state of the RBACData object.
  parameters: []
  returns: null
  examples:
  - title: Basic Usage After Role Assignment
    code: 'RBACData rbacData;

      // Assume roles have been added to rbacData

      rbacData.CalculateNewPermissions();

      // Now rbacData contains updated permission set'
    language: cpp
  - title: Usage in Player Login Context
    code: "void OnPlayerLogin(Player* player)\n{\n    RBACData* rbac = player->GetRBACData();\n\
      \    if (rbac)\n    {\n        rbac->CalculateNewPermissions();\n        //\
      \ Permissions are now up-to-date for this player\n    }\n}"
    language: cpp
  notes: This method should be called whenever role assignments change to maintain
    consistency between the assigned roles and effective permissions. It is designed
    to be efficient, but frequent calls may impact performance if many roles are involved.
    The calculation considers role hierarchies and inheritance rules defined within
    the TrinityCore RBAC system.
  warnings: Calling this method without proper role assignment can lead to incorrect
    permission states. Ensure that all relevant roles are properly added before invoking
    this method to avoid missing permissions or stale access control data.
  related:
  - GetPermissions
  - AddRole
  - RemoveRole
  - HasPermission
metadata:
  confidence: 0.9
  generated_at: '2025-11-07T00:03:41.598913'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
