api:
  class: TerrainInfo
  method: GetZoneId
  signature: uint32 TerrainInfo::GetZoneId(const PhaseShift & phaseShift, uint32 mapId,
    const int & pos, const DynamicMapTree * dynamicMapTree)
documentation:
  brief: Retrieves the zone identifier for a given position within a specific map
    and phase.
  description: The GetZoneId method determines the zone ID associated with a particular
    location on a map, taking into account the current phase shift and dynamic map
    tree data. This is essential for determining player location context, such as
    which zone they are in for quest tracking, zone-based events, and area triggers.
    The method uses the provided phase shift to determine visibility and relevance
    of zones, and can utilize dynamic map tree data for more accurate terrain-based
    zone detection. It's commonly used in World of Warcraft's TrinityCore server implementation
    for zone-related game logic.
  parameters:
  - name: phaseShift
    description: The phase shift information that determines which zones are currently
      visible or active for the player or object. This affects zone visibility based
      on game phases, events, or player states.
  - name: mapId
    description: The unique identifier of the map where the zone lookup is performed.
      This corresponds to the Map.dbc entry ID in the World of Warcraft database.
  - name: pos
    description: The position coordinate within the map, typically represented as
      an index or offset into a position array. The exact interpretation depends on
      how positions are stored and processed internally.
  - name: dynamicMapTree
    description: A pointer to the dynamic map tree structure used for terrain and
      zone calculations. Can be null if static zone data is sufficient for the lookup.
  returns: Returns a uint32 representing the zone identifier (ZoneId) for the specified
    position on the map. If no valid zone is found, it typically returns 0, indicating
    an invalid or unknown zone.
  examples:
  - title: Basic Zone ID Retrieval
    code: uint32 zoneId = terrainInfo->GetZoneId(phaseShift, 1234, 5678, nullptr);
    language: cpp
  - title: Zone ID with Dynamic Map Tree
    code: 'DynamicMapTree* tree = GetDynamicMapTreeForMap(1234);

      uint32 zoneId = terrainInfo->GetZoneId(phaseShift, 1234, 5678, tree);'
    language: cpp
  notes: This method is part of the core terrain and zone management system in TrinityCore.
    It's designed to work with both static and dynamic map data, making it flexible
    for various game scenarios including phased content and complex terrain features.
  warnings: Ensure that the phaseShift parameter correctly represents the current
    game state or phase visibility. Incorrect phase information can lead to incorrect
    zone IDs being returned. Also, passing a null dynamicMapTree pointer may result
    in less accurate zone detection for complex terrain.
  related:
  - GetAreaId
  - GetZoneName
  - IsInZone
metadata:
  confidence: 0.85
  generated_at: '2025-11-03T16:49:41.093120'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
