api:
  class: EscortAI
  method: JustDied
  signature: void EscortAI::JustDied(int * param0)
documentation:
  brief: Handles the event when an escorted creature or NPC dies during an escort
    quest.
  description: The JustDied method is a virtual callback function in the EscortAI
    class that is invoked when the escorted NPC or creature dies. This method typically
    handles cleanup, quest failure logic, or notification of the player that the escort
    has been compromised. It's part of the AI system used for managing escort quests
    in TrinityCore, where NPCs are guided to a destination while being protected.
    The method is called from within the core AI update loop when the creature's health
    drops to zero and it is about to be destroyed.
  parameters: []
  returns: void
  examples:
  - title: Basic Override Implementation
    code: "class MyEscortAI : public EscortAI\n{\npublic:\n    void JustDied() override\n\
      \    {\n        // Notify quest giver about failure\n        if (Player* player\
      \ = GetPlayerForEscort())\n        {\n            player->FailQuest(12345);\n\
      \        }\n        // Call base implementation if needed\n        EscortAI::JustDied();\n\
      \    }\n};"
    language: cpp
  notes: This method is typically called during the creature's death processing, so
    any actions taken should be safe and not interfere with ongoing combat or AI state
    changes. It's recommended to check if the escort was successful before calling
    this function, as it may be invoked even when the escort has already completed
    successfully.
  warnings: Do not call SetDeathState() or directly modify creature state within this
    method unless absolutely necessary, as it can cause undefined behavior. Also,
    ensure that any quest-related notifications are sent only once to prevent duplicate
    messages or errors.
  related:
  - UpdateAI
  - StartEscort
  - IsPlayerNear
  - SendQuestComplete
metadata:
  confidence: 0.95
  generated_at: '2025-11-06T14:31:17.085053'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
