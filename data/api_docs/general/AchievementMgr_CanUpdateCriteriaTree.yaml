api:
  class: AchievementMgr
  method: CanUpdateCriteriaTree
  signature: bool AchievementMgr::CanUpdateCriteriaTree(const Criteria * criteria,
    const CriteriaTree * tree, Player * referencePlayer) const
documentation:
  brief: Determines whether a criteria tree can be updated for a given player based
    on achievement requirements.
  description: The CanUpdateCriteriaTree method evaluates if a specific criteria tree
    associated with an achievement can be updated for a reference player. This check
    ensures that the player meets all necessary conditions and prerequisites before
    allowing progression in an achievement. It typically involves verifying player
    state, quest completion, item ownership, or other game-specific criteria required
    by the achievement system. The method is crucial for maintaining consistency in
    the achievement tracking system and preventing invalid updates to criteria trees.
  parameters:
  - name: criteria
    description: Pointer to the Criteria structure that defines the specific condition
      to be evaluated. This represents a single requirement within an achievement.
  - name: tree
    description: Pointer to the CriteriaTree structure that contains hierarchical
      criteria information and relationships between different achievement requirements.
  - name: referencePlayer
    description: Pointer to the Player object representing the player whose progress
      is being checked against the criteria tree. This determines if the player meets
      the conditions defined in the tree.
  returns: Returns true if the criteria tree can be updated for the given player,
    indicating all prerequisites and conditions are met; otherwise returns false.
  examples:
  - title: Basic usage to check criteria tree update eligibility
    code: "if (achievementMgr->CanUpdateCriteriaTree(criteria, tree, player)) {\n\
      \    // Proceed with updating the criteria tree\n    tree->Update(player);\n\
      }"
    language: cpp
  - title: Using in an achievement progression check
    code: "void OnPlayerAchievementProgress(Player* player, uint32 achievementId)\
      \ {\n    if (auto* criteriaTree = sObjectMgr->GetCriteriaTree(achievementId))\
      \ {\n        if (achievementMgr->CanUpdateCriteriaTree(criteriaTree->GetCriteria(),\
      \ criteriaTree, player)) {\n            // Update the achievement progress\n\
      \            player->UpdateAchievementCriteria(CRITERIA_TYPE_COMPLETE_QUEST,\
      \ 12345);\n        }\n    }\n}"
    language: cpp
  notes: This method is part of the internal achievement validation system and should
    not be called directly from game logic unless specifically required. It performs
    checks against player state and may involve database queries for quest or item
    data. The method assumes that both criteria and tree parameters are valid and
    properly initialized.
  warnings: Calling this method without proper initialization of the criteria or tree
    structures can lead to undefined behavior. Ensure that all pointers passed are
    non-null and point to valid objects before calling this method.
  related:
  - UpdateCriteriaTree
  - GetCriteriaTree
  - ValidateAchievementProgress
metadata:
  confidence: 0.85
  generated_at: '2025-11-01T02:44:35.185582'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
