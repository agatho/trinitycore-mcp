api:
  class: MapManager
  method: FindInstanceIdForPlayer
  signature: uint32 MapManager::FindInstanceIdForPlayer(uint32 mapId, const Player
    * player) const
documentation:
  brief: Finds and returns the instance ID for a specific player on a given map.
  description: The FindInstanceIdForPlayer method retrieves the unique instance identifier
    associated with a player on a specified map. This is commonly used in World of
    Warcraft's TrinityCore to determine which instance a player is currently located
    in, particularly when handling dungeon or raid encounters. The method takes into
    account the player's current location and active instance data. It returns 0 if
    no valid instance ID is found for the player on that map, indicating either the
    player is not in an instance or the map does not support instances.
  parameters:
  - name: mapId
    description: The unique identifier of the map for which to find the instance ID.
      This corresponds to the Map.dbc entry ID.
  - name: player
    description: A pointer to the Player object whose instance ID is being queried.
      Must not be null.
  returns: Returns a uint32 representing the instance ID of the player on the specified
    map. Returns 0 if no instance ID is found or if the player is not in an instance
    of that map.
  examples:
  - title: Basic usage to find instance ID for a player
    code: "uint32 instanceId = sMapMgr->FindInstanceIdForPlayer(123, player); // Find\
      \ instance ID for player on map 123\nif (instanceId != 0)\n{\n    // Player\
      \ is in an instance of this map\n    sLog->outString(\"Player is in instance\
      \ %u\", instanceId);\n}\nelse\n{\n    // Player is not in an instance or no\
      \ valid instance ID exists\n    sLog->outString(\"Player is not in any instance\
      \ of this map\");\n}"
    language: cpp
  notes: This method relies on internal tracking of player instances and should only
    be called after the player has been properly initialized and added to a map. The
    instance ID returned corresponds to the instance's unique identifier used throughout
    the TrinityCore server logic for managing instance-specific data.
  warnings: Ensure that the provided player pointer is valid and not null before calling
    this method, as passing a null pointer will likely cause undefined behavior or
    crashes. Also note that this method may return 0 both when no instance exists
    and when an error occurs during lookup.
  related:
  - Map::GetInstanceId
  - Player::GetInstanceId
  - MapManager::FindMap
metadata:
  confidence: 0.95
  generated_at: '2025-11-02T03:25:45.633352'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
