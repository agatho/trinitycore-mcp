api:
  class: UnitAI
  method: FinalizeTargetSelection
  signature: Unit * UnitAI::FinalizeTargetSelection(int & targetList, SelectTargetMethod
    targetType)
documentation:
  brief: Selects and returns the final target based on specified selection criteria
    from a list of potential targets.
  description: The FinalizeTargetSelection method is used in AI logic to determine
    the most appropriate target for an NPC or creature's current action, such as casting
    a spell or melee attacking. It takes a pre-populated list of potential targets
    and applies selection rules based on the provided SelectTargetMethod. The method
    evaluates each candidate in the targetList according to factors like threat level,
    distance, health, or other AI-specific criteria. This function is typically called
    during AI decision-making processes where multiple valid targets exist but only
    one should be chosen for execution. It ensures that the selected target aligns
    with the creature's behavior and tactical priorities.
  parameters:
  - name: targetList
    description: Reference to an integer representing the index or identifier of the
      target list to process. This value is modified during selection to indicate
      which targets were considered.
  - name: targetType
    description: An enum value specifying the method used for selecting the target.
      Common values include SELECT_TARGET_NEAREST, SELECT_TARGET_FARTHEST, SELECT_TARGET_HEALTH,
      etc., each defining different criteria for choosing among candidates.
  returns: Returns a pointer to the Unit object that was selected as the final target.
    If no valid target is found or if the selection fails, it returns nullptr.
  examples:
  - title: Basic usage in AI behavior
    code: "Unit* target = me->GetAI()->FinalizeTargetSelection(targetList, SELECT_TARGET_NEAREST);\n\
      if (target)\n{\n    me->Attack(target, true);\n}"
    language: cpp
  - title: Using with custom target list
    code: "int targets[10] = {0};\n// Fill targets array with valid unit GUIDs\nint\
      \ targetCount = 10;\nUnit* finalTarget = me->GetAI()->FinalizeTargetSelection(targetCount,\
      \ SELECT_TARGET_HEALTH);\nif (finalTarget)\n{\n    DoCast(finalTarget, SPELL_SHOCKWAVE);\n\
      }"
    language: cpp
  notes: This method assumes that the targetList has already been populated with valid
    unit references or identifiers. The actual selection logic depends heavily on
    the AI implementation and may vary between different creature types. It is recommended
    to check for nullptr return values before using the result.
  warnings: Improper initialization of targetList can lead to undefined behavior or
    incorrect targeting decisions. Ensure that all entries in targetList are valid
    units, otherwise the method might fail silently or return unexpected results.
  related:
  - SelectTarget
  - GetNextTarget
  - AddTargetToList
metadata:
  confidence: 0.9
  generated_at: '2025-11-06T23:08:06.878531'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
