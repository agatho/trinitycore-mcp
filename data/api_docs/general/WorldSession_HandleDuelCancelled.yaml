api:
  class: WorldSession
  method: HandleDuelCancelled
  signature: void WorldSession::HandleDuelCancelled()
documentation:
  brief: Handles the cancellation of a duel by a player, cleaning up duel-related
    state and sending appropriate responses.
  description: The HandleDuelCancelled method is invoked when a player cancels an
    ongoing duel. It ensures that all duel-related game state is properly cleaned
    up, including removing the duel status from both players involved, resetting their
    combat flags, and sending necessary network messages to inform the client that
    the duel has been cancelled. This method is typically called as a result of a
    player using the in-game duel cancellation interface or command. The method does
    not validate whether a duel is actually active before proceeding with cleanup,
    so it should only be called when a duel is known to exist.
  parameters: []
  returns: null
  examples:
  - title: Basic Usage
    code: "void Player::CancelDuel()\n{\n    // Send duel cancellation packet\n  \
      \  WorldPacket data(SMSG_DUEL_CANCELLED, 0);\n    SendPacket(&data);\n    //\
      \ Trigger the handler on the session\n    GetSession()->HandleDuelCancelled();\n\
      }"
    language: cpp
  notes: This method assumes that the player is currently in a duel state and that
    appropriate cleanup steps have been taken elsewhere. It does not perform any validation
    to confirm that a duel exists, so calling it without prior checks may lead to
    inconsistent game state.
  warnings: Calling this method outside of an actual duel context can cause undefined
    behavior or client-side errors. Ensure that all related duel state is properly
    managed before invoking this function.
  related:
  - HandleDuelAccepted
  - HandleDuelComplete
  - HandleDuelRequested
metadata:
  confidence: 0.9
  generated_at: '2025-11-02T19:36:31.320936'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
