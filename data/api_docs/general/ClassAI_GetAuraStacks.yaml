api:
  class: ClassAI
  method: GetAuraStacks
  signature: int ClassAI::GetAuraStacks(int spellId, int * target)
documentation:
  brief: Retrieves the current stack count of a specified aura applied to the target.
  description: The GetAuraStacks method retrieves the number of times a specific aura
    is currently active on the target unit. This method is commonly used in AI scripts
    to determine the state of buffs or debuffs that have stacking mechanics. The spell
    ID parameter identifies which aura to check, while the optional target parameter
    specifies the unit whose aura stacks are being queried. If no target is provided,
    it typically defaults to the AI's current target or self.
  parameters:
  - name: spellId
    description: The unique identifier of the spell/aura to query for stack count.
      Must be a valid SpellID from the game's spell database.
  - name: target
    description: Pointer to the target unit whose aura stacks are being checked. If
      NULL, the method uses the AI's current target or self as default.
  returns: Returns an integer representing the number of stacks currently active for
    the specified aura on the target. Returns 0 if the aura is not present or if the
    target is invalid.
  examples:
  - title: Check debuff stacks on current target
    code: "if (int stacks = ai->GetAuraStacks(12345, nullptr) > 3)\n{\n    // Perform\
      \ action when debuff has more than 3 stacks\n}"
    language: cpp
  - title: Check buff stacks on specific unit
    code: "Unit* target = ai->GetTarget();\nif (target && ai->GetAuraStacks(67890,\
      \ &target) == 5)\n{\n    // Cast ability when target has exactly 5 stacks of\
      \ a buff\n}"
    language: cpp
  notes: This method relies on the internal aura tracking system of TrinityCore. It
    may not return accurate results if the aura is applied through custom mechanics
    or if the target unit is not properly initialized. The method performs a lookup
    in the aura map, so performance should be considered when used frequently in tight
    loops.
  warnings: Ensure that the spellId passed is valid and corresponds to an actual aura
    in the game's database; invalid IDs may cause undefined behavior or return incorrect
    values. Be cautious when using this method with dynamic targets, as the target
    might become invalid between calls.
  related:
  - GetAuraDuration
  - HasAura
  - RemoveAura
  - AddAura
metadata:
  confidence: 0.9
  generated_at: '2025-11-04T11:40:24.255471'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
