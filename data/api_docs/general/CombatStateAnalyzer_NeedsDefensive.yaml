api:
  class: CombatStateAnalyzer
  method: NeedsDefensive
  signature: bool CombatStateAnalyzer::NeedsDefensive() const
documentation:
  brief: Determines whether the combat state requires defensive action based on current
    threat and health metrics.
  description: The NeedsDefensive method evaluates the current combat state of a unit
    to determine if defensive measures should be taken. It typically checks factors
    such as health percentage, incoming threat level, and proximity to dangerous attacks.
    This method is commonly used in AI decision-making processes to prioritize defensive
    behaviors over offensive ones when necessary. The result helps control whether
    a unit should focus on survival mechanisms like healing, shielding, or fleeing
    rather than continuing aggressive actions.
  parameters: []
  returns: Returns true if the combat state indicates that defensive action is required;
    otherwise returns false. This typically occurs when health drops below a certain
    threshold or when threat levels exceed safe limits.
  examples:
  - title: Basic Usage in AI Logic
    code: "if (analyzer.NeedsDefensive()) {\n    unit->CastSpell(SPELL_HEAL);\n  \
      \  unit->SetReactState(REACT_DEFENSIVE);\n}"
    language: cpp
  - title: Integration with Combat State Monitoring
    code: "void UnitAI::UpdateAI(uint32 diff) {\n    if (combatAnalyzer.NeedsDefensive())\
      \ {\n        // Switch to defensive stance\n        if (!me->HasUnitState(UNIT_STATE_DEFENSIVE))\n\
      \            me->SetUnitState(UNIT_STATE_DEFENSIVE);\n    } else {\n       \
      \ // Continue with normal combat behavior\n        me->ClearUnitState(UNIT_STATE_DEFENSIVE);\n\
      \    }\n}"
    language: cpp
  notes: This method is typically called during AI update cycles and may involve performance
    considerations if used excessively. It's recommended to cache results when possible
    to avoid redundant calculations.
  warnings: Ensure that the combat state is properly initialized before calling this
    method, as incorrect state values might lead to inappropriate defensive behavior
    decisions.
  related:
  - CombatStateAnalyzer::GetThreatLevel
  - CombatStateAnalyzer::IsInDanger
  - CombatStateAnalyzer::GetHealthPercentage
metadata:
  confidence: 0.85
  generated_at: '2025-11-09T02:52:42.532941'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
