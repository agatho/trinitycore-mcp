api:
  class: CombatManager
  method: IsInCombatWith
  signature: bool CombatManager::IsInCombatWith(const Unit * who) const
documentation:
  brief: Checks if the unit is currently in combat with the specified target.
  description: The IsInCombatWith method determines whether the calling unit has an
    active combat state with the provided Unit object. This method evaluates the combat
    status by checking internal combat flags and timers, ensuring that the unit is
    not only engaged in combat but also that the combat state is still valid according
    to World of Warcraft's combat mechanics. The method returns true if there is an
    active combat relationship between the two units, and false otherwise. This check
    is commonly used in AI behavior, spell targeting, and combat state management
    within TrinityCore.
  parameters: []
  returns: Returns true if the unit is currently in combat with the specified target;
    otherwise, returns false.
  examples:
  - title: Basic Combat Check
    code: "if (combatManager->IsInCombatWith(targetUnit)) {\n    // Unit is in combat\
      \ with target\n    DoSomething();\n}"
    language: cpp
  - title: Using in AI Decision Making
    code: "if (!combatManager->IsInCombatWith(targetUnit) && targetUnit->IsAlive())\
      \ {\n    // Start combat if not already in combat\n    combatManager->Attack(targetUnit);\n\
      }"
    language: cpp
  notes: This method relies on internal combat state tracking which includes combat
    timers and flags. It may return false for units that have recently entered combat
    but haven't fully initialized their combat state yet. The method is thread-safe
    as it only reads from existing combat state data structures.
  warnings: Do not use this method to determine if a unit is in combat with any arbitrary
    target without first verifying the target is valid. In some edge cases, units
    may be marked as in combat even after they have been killed or removed from the
    world.
  related:
  - CombatManager::IsInCombat
  - CombatManager::AddCombatant
  - CombatManager::RemoveCombatant
metadata:
  confidence: 0.9
  generated_at: '2025-10-31T08:52:15.715804'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
