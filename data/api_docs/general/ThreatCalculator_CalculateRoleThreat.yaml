api:
  class: ThreatCalculator
  method: CalculateRoleThreat
  signature: float ThreatCalculator::CalculateRoleThreat(ThreatRole role, Unit * target)
documentation:
  brief: Calculates threat value based on unit role and target for AI decision making.
  description: The CalculateRoleThreat method computes a threat score for a given
    unit's role when engaging with a specific target. This calculation is used by
    the AI system to determine which targets are most threatening and should be prioritized
    for attacks or defensive actions. The method considers various factors such as
    the unit's combat role (tank, healer, damage dealer), the target's threat level,
    and other contextual factors relevant to the current encounter. It returns a normalized
    float value representing the calculated threat that can be used by threat management
    systems within the TrinityCore framework.
  parameters:
  - name: role
    description: The ThreatRole enum value indicating the unit's combat role (e.g.,
      TANK, HEALER, DAMAGE_DEALER). This determines how threat is calculated based
      on role-specific mechanics.
  - name: target
    description: Pointer to the Unit object representing the target against which
      threat is being calculated. Must be a valid unit in the current world context.
  returns: A float value representing the calculated threat level for the given role
    and target combination. Higher values indicate higher threat, typically ranging
    from 0.0 (no threat) to 1.0 (maximum threat).
  examples:
  - title: Basic usage in AI decision making
    code: "float threat = threatCalculator.CalculateRoleThreat(ThreatRole::TANK, targetUnit);\n\
      if (threat > 0.8f) {\n    // Prioritize this target for defensive actions\n}"
    language: cpp
  - title: Using with different roles for threat prioritization
    code: "Unit* currentTarget = nullptr;\nfloat maxThreat = 0.0f;\n\nfor (auto& unit\
      \ : nearbyUnits) {\n    float threat = threatCalculator.CalculateRoleThreat(unit->GetThreatRole(),\
      \ unit);\n    if (threat > maxThreat) {\n        maxThreat = threat;\n     \
      \   currentTarget = unit;\n    }\n}\n// Use currentTarget as primary target\
      \ based on calculated threat"
    language: cpp
  notes: This method is part of the core threat calculation system used by AI units
    in TrinityCore. The implementation likely incorporates various combat mechanics
    including attack power, spell damage, and role-specific multipliers. It's designed
    to be called frequently during combat updates, so performance considerations are
    important for optimal gameplay experience.
  warnings: Ensure that both parameters are valid before calling this method. Passing
    a null target pointer or invalid threat role may result in undefined behavior
    or incorrect threat calculations. The returned threat value should not be used
    directly for combat calculations without proper validation and normalization.
  related:
  - GetThreatRole
  - UpdateThreat
  - AddThreat
metadata:
  confidence: 0.85
  generated_at: '2025-11-06T01:01:48.307589'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
