api:
  class: Conversation
  method: BuildValuesUpdateForPlayerWithMask
  signature: void Conversation::BuildValuesUpdateForPlayerWithMask(int * data, const
    int & requestedObjectMask, const int & requestedConversationMask, const int *
    target) const
documentation:
  brief: Updates player data with conversation-related values based on specified object
    and conversation masks.
  description: 'The BuildValuesUpdateForPlayerWithMask method constructs an update
    packet containing conversation-related data for a specific player. It uses the
    provided object mask and conversation mask to determine which values should be
    included in the update, and writes the resulting data into the target buffer.
    This method is typically used during player login or when updating a player''s
    view of active conversations in the game world. The method does not perform any
    direct network transmission; it only prepares the data structure for later use.
    Precondition: All input parameters must be valid and properly initialized. Postcondition:
    The target buffer will contain the updated conversation data according to the
    specified masks.'
  parameters:
  - name: data
    description: Pointer to an integer array where the constructed update values will
      be written. Must point to a valid memory location with sufficient capacity to
      hold the update data.
  - name: requestedObjectMask
    description: Integer mask specifying which object-related fields should be included
      in the update. Each bit represents a different object field, and only those
      set in the mask will be populated in the output data.
  - name: requestedConversationMask
    description: Integer mask specifying which conversation-related fields should
      be included in the update. Similar to the object mask, each bit corresponds
      to a specific conversation field that will be included in the result.
  - name: target
    description: Pointer to an integer array where the final constructed data will
      be stored. This is typically used as a buffer for the serialized update packet.
  returns: null
  examples:
  - title: Basic Usage Example
    code: 'int updateData[100];

      int objectMask = 0x01;

      int conversationMask = 0x02;

      int targetBuffer[50];

      conversation->BuildValuesUpdateForPlayerWithMask(updateData, objectMask, conversationMask,
      targetBuffer);'
    language: cpp
  - title: Advanced Usage with Multiple Masks
    code: 'int* dataBuffer = new int[200];

      int objMask = 0x0F;

      int convMask = 0xF0;

      int* outputBuffer = new int[100];

      conversation->BuildValuesUpdateForPlayerWithMask(dataBuffer, objMask, convMask,
      outputBuffer);

      delete[] dataBuffer;

      delete[] outputBuffer;'
    language: cpp
  notes: This method is part of the internal update system for conversations in TrinityCore.
    It's primarily used by the server to prepare updates for players when their conversation
    state changes. The masks are typically constructed using predefined constants
    from the game's internal field definitions. Developers should ensure that the
    target buffers have sufficient space allocated to prevent buffer overflows.
  warnings: This method does not validate input parameters beyond basic null checks.
    Passing invalid or uninitialized pointers can lead to undefined behavior or crashes.
    Ensure all parameters are properly initialized before calling this method. The
    method assumes that the masks correspond to valid field indices and will not perform
    bounds checking on them.
  related:
  - GetConversationData
  - UpdatePlayerConversationState
  - SendConversationUpdate
metadata:
  confidence: 0.85
  generated_at: '2025-11-02T09:23:34.493530'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
