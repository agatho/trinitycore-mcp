api:
  class: InterruptUtils
  method: CalculateDamageThreat
  signature: float InterruptUtils::CalculateDamageThreat(const SpellInfo * spellInfo,
    Unit * caster)
documentation:
  brief: Calculates threat generated by a spell's damage output for the caster.
  description: The CalculateDamageThreat method computes the amount of threat (aggro)
    that a spell will generate when dealing damage to a target. This value is used
    by the game's threat system to determine which units are most likely to be targeted
    by enemies. The calculation takes into account the spell's base damage, modifiers,
    and other relevant properties defined in the SpellInfo structure. This method
    is typically invoked during spell execution to update the caster's threat level
    against the target.
  parameters:
  - name: spellInfo
    description: Pointer to the SpellInfo structure containing spell properties and
      damage calculations. Must not be null.
  - name: caster
    description: Pointer to the Unit that is casting the spell. Must not be null and
      must be a valid unit entity.
  returns: A float value representing the calculated threat generated by the spell's
    damage output. Returns 0.0f if the spell does not generate threat or if parameters
    are invalid.
  examples:
  - title: Basic Threat Calculation
    code: 'const SpellInfo* spell = sSpellMgr->GetSpellInfo(12345);

      Unit* caster = player;

      float threat = InterruptUtils::CalculateDamageThreat(spell, caster);

      // threat now contains the calculated damage threat value'
    language: cpp
  - title: Using Threat in Combat Logic
    code: "void OnSpellHit(Unit* target)\n{\n    const SpellInfo* spell = GetSpellInfo();\n\
      \    Unit* caster = GetCaster();\n    if (spell && caster)\n    {\n        float\
      \ threat = InterruptUtils::CalculateDamageThreat(spell, caster);\n        caster->AddThreat(target,\
      \ threat);\n    }\n}"
    language: cpp
  notes: This method relies on internal spell data and may be affected by various
    modifiers such as spell power scaling, damage multipliers, and class-specific
    bonuses. The returned value is not necessarily the final threat applied to the
    target, as additional systems may modify it based on combat state, target type,
    or other factors.
  warnings: Ensure that both spellInfo and caster parameters are valid pointers before
    calling this method. Passing null pointers will likely result in undefined behavior
    or crashes. The method assumes proper initialization of SpellInfo structures and
    should not be used with incomplete or corrupted spell data.
  related:
  - CalculateHealingThreat
  - CalculateSpellThreat
  - AddThreat
metadata:
  confidence: 0.9
  generated_at: '2025-11-06T11:17:59.894889'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
