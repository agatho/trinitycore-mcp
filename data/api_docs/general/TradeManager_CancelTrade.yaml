api:
  class: TradeManager
  method: CancelTrade
  signature: void TradeManager::CancelTrade(const std::string & reason)
documentation:
  brief: Cancels an ongoing trade session and broadcasts the cancellation reason to
    both players involved.
  description: The CancelTrade method terminates an active trade session between two
    players in World of Warcraft. It ensures that any items currently being traded
    are returned to their respective inventories, and the trade window is closed for
    both parties. The method accepts a reason string which is displayed to both players
    to explain why the trade was canceled. This function is typically invoked when
    a player explicitly cancels a trade, when a trade becomes invalid due to external
    conditions (such as one player leaving the game), or when an error occurs during
    the trade process. The cancellation is immediate and affects only the current
    trade session.
  parameters:
  - name: reason
    description: A string describing the reason for canceling the trade. This message
      will be displayed to both players in the trade window.
  returns: null
  examples:
  - title: Cancel Trade with Reason
    code: 'TradeManager* tradeMgr = player1->GetSession()->GetTradeData();

      tradeMgr->CancelTrade("Trade canceled due to item unavailability.");'
    language: cpp
  - title: Cancel Trade on Player Logout
    code: "void OnPlayerLogout(Player* player)\n{\n    if (player->GetTradeData())\n\
      \    {\n        player->GetTradeData()->CancelTrade(\"Trading partner logged\
      \ out.\");\n    }\n}"
    language: cpp
  notes: This method should only be called when a valid trade session exists. Calling
    it without an active trade may lead to undefined behavior or client-side errors.
    The reason string is limited by the client's UI constraints and should remain
    concise for optimal display.
  warnings: Do not call this method if the trade has already been completed or finalized,
    as doing so could cause inconsistencies in item ownership or inventory states.
    Ensure that both players are still present in the game world before invoking this
    function to avoid potential race conditions.
  related:
  - StartTrade
  - AcceptTrade
  - CompleteTrade
  - InitiateTrade
metadata:
  confidence: 0.95
  generated_at: '2025-11-01T05:13:26.741810'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
