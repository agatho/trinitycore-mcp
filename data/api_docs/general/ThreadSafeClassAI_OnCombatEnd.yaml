api:
  class: ThreadSafeClassAI
  method: OnCombatEnd
  signature: void ThreadSafeClassAI::OnCombatEnd()
documentation:
  brief: Called when combat ends for the AI-controlled unit
  description: The OnCombatEnd method is invoked when a creature or NPC controlled
    by ThreadSafeClassAI exits combat mode. This method typically handles cleanup
    operations, resets AI states, and performs any necessary post-combat actions such
    as returning to idle behavior, resetting target selection, or triggering quest-related
    events. The method ensures that the AI system properly transitions from an active
    combat state back to a non-combat state, maintaining proper game flow and preventing
    unexpected behaviors during or after combat sequences.
  parameters: []
  returns: null
  examples:
  - title: Basic OnCombatEnd Implementation
    code: "void ThreadSafeClassAI::OnCombatEnd()\n{\n    // Reset AI state\n    me->SetReactState(REACT_PASSIVE);\n\
      \    \n    // Clear current target\n    if (me->GetVictim())\n        me->AttackStop();\n\
      \    \n    // Return to idle state\n    me->SetWalk(true);\n    \n    // Perform\
      \ any cleanup tasks\n    Reset();\n}"
    language: cpp
  notes: This method is typically called from the core combat system when the unit's
    combat timer expires or when all enemies are defeated. It should be implemented
    to ensure proper AI state management and prevent memory leaks or inconsistent
    behavior during transitions between combat and non-combat states.
  warnings: null
  related:
  - OnCombatStart
  - UpdateAI
  - EnterCombat
metadata:
  confidence: 0.9
  generated_at: '2025-11-08T21:21:42.865339'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
