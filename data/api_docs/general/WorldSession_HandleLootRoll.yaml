api:
  class: WorldSession
  method: HandleLootRoll
  signature: void WorldSession::HandleLootRoll(WorldPackets::Loot::LootRoll & packet)
documentation:
  brief: Processes a player's loot roll decision for an item in a group loot scenario.
  description: The HandleLootRoll method is responsible for processing a player's
    response when participating in a group loot roll. When a loot item is distributed
    via group loot (such as when a mob is killed and items are rolled for), players
    can choose to roll 'need', 'greed', or pass on the item. This method handles the
    client's packet containing the player's chosen action, validates the request,
    and updates the loot state accordingly. It ensures that only valid players who
    are eligible to roll on the item can participate in the decision-making process.
  parameters: []
  returns: null
  examples:
  - title: Basic Loot Roll Processing
    code: "void WorldSession::HandleLootRoll(WorldPackets::Loot::LootRoll& packet)\n\
      {\n    if (!packet.LootObj || !packet.ItemID)\n        return;\n\n    // Validate\
      \ player is in the same group as the loot\n    if (Player* player = GetPlayer())\n\
      \    {\n        if (Group* group = player->GetGroup())\n        {\n        \
      \    // Process the roll decision (need, greed, pass)\n            group->Roll(packet.LootObj,\
      \ packet.ItemID, packet.RollType);\n        }\n    }\n}"
    language: cpp
  notes: This method is part of the core loot system in TrinityCore and must be called
    from within a valid WorldSession context. The packet contains information about
    which item is being rolled on, the player's roll decision, and the loot object
    reference. It relies heavily on group membership validation to ensure only eligible
    players can participate.
  warnings: Improper handling of this method may lead to incorrect loot distribution
    or allow unauthorized players to influence loot decisions. The packet must be
    validated for proper group membership before processing any roll decisions.
  related:
  - HandleLootMasterGive
  - HandleLootRoll
  - HandleLoot
  - Group::Roll
metadata:
  confidence: 0.95
  generated_at: '2025-11-04T21:41:15.990133'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
