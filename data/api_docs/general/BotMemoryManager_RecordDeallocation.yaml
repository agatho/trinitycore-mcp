api:
  class: BotMemoryManager
  method: RecordDeallocation
  signature: void BotMemoryManager::RecordDeallocation(void * address, uint64_t size,
    MemoryCategory category, uint32_t botGuid)
documentation:
  brief: Records the deallocation of memory used by a bot, updating internal tracking
    structures with allocation details.
  description: The RecordDeallocation method is responsible for logging the release
    of memory that was previously allocated for a specific bot instance. It updates
    internal memory tracking data structures to reflect that a block of memory has
    been freed. This method is typically invoked when a bot's memory resources are
    being deallocated, either during normal operation or when the bot is destroyed.
    The method accepts the memory address, size, category, and bot GUID to accurately
    track resource usage across different bot instances and memory categories.
  parameters:
  - name: address
    description: Pointer to the memory block that is being deallocated. Must be a
      valid memory address previously allocated by the system.
  - name: size
    description: The size in bytes of the memory block being deallocated. Used for
      tracking total memory usage statistics.
  - name: category
    description: Memory category identifier that classifies the type of memory being
      deallocated (e.g., AI, data structures, etc.).
  - name: botGuid
    description: Unique identifier for the bot instance associated with this memory
      deallocation. Used to track per-bot resource usage.
  returns: null
  examples:
  - title: Basic Memory Deallocation Recording
    code: "void example() {\n    void* ptr = malloc(1024);\n    // ... use memory\
      \ ...\n    free(ptr);\n    BotMemoryManager::Instance()->RecordDeallocation(ptr,\
      \ 1024, MEMORY_CATEGORY_AI, 12345);\n}"
    language: cpp
  notes: This method is part of a memory management system designed to monitor and
    optimize bot resource usage in TrinityCore. It's crucial that the address parameter
    points to valid allocated memory; otherwise, behavior may be undefined. The method
    assumes that all parameters are validated before calling.
  warnings: Calling this method with an invalid memory address can lead to memory
    corruption or crashes. Ensure that the address corresponds to a previously allocated
    block of memory. Also, avoid calling this method multiple times for the same memory
    block as it may cause incorrect tracking.
  related:
  - RecordAllocation
  - GetMemoryUsage
  - ResetMemoryTracking
metadata:
  confidence: 0.9
  generated_at: '2025-11-02T11:29:25.509526'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
