api:
  class: FormulaScript
  method: OnGainCalculation
  signature: void FormulaScript::OnGainCalculation(uint32 & gain, Player * player,
    Unit * unit)
documentation:
  brief: Modifies the experience gain amount for a player based on combat outcomes
  description: The OnGainCalculation method is invoked during experience gain calculations
    to allow custom modifications to the experience points awarded to a player. This
    method provides a hook for scriptable adjustments to experience rewards, enabling
    developers to implement custom game mechanics such as experience multipliers,
    diminishing returns, or conditional bonuses. The method receives both the raw
    experience gain value and references to the player and unit involved in the combat
    that triggered the experience calculation.
  parameters:
  - name: gain
    description: Reference to the experience gain amount that will be awarded to the
      player. This value can be modified directly to increase or decrease the experience
      reward.
  - name: player
    description: Pointer to the Player object who earned the experience. This parameter
      provides access to player-specific data and methods for experience calculations.
  - name: unit
    description: Pointer to the Unit object that was defeated or otherwise contributed
      to the experience gain. This could be a creature, NPC, or another player in
      PvP scenarios.
  returns: null
  examples:
  - title: Basic Experience Multiplier
    code: "void MyFormulaScript::OnGainCalculation(uint32& gain, Player* player, Unit*\
      \ unit)\n{\n    // Double the experience gain for low-level players\n    if\
      \ (player->getLevel() < 10)\n        gain *= 2;\n}"
    language: cpp
  - title: Experience Reduction for High-Level Players
    code: "void MyFormulaScript::OnGainCalculation(uint32& gain, Player* player, Unit*\
      \ unit)\n{\n    // Reduce experience gain by 50% for high-level players\n  \
      \  if (player->getLevel() > 60)\n        gain /= 2;\n}"
    language: cpp
  notes: This method is called during the combat experience calculation process, so
    modifications to the 'gain' parameter will directly affect the final experience
    awarded. Be cautious when modifying the gain value as it may impact game balance
    and progression systems.
  warnings: Modifying the gain parameter can significantly affect gameplay balance.
    Ensure that any adjustments made are within reasonable bounds to maintain fair
    progression mechanics. Avoid using this method for complex logic that might cause
    performance issues during combat.
  related:
  - OnGainCalculation
  - OnLevelUp
  - OnXPChange
metadata:
  confidence: 0.9
  generated_at: '2025-11-02T07:24:47.846685'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
