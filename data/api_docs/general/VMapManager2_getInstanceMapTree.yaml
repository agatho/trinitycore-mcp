api:
  class: VMapManager2
  method: getInstanceMapTree
  signature: void VMapManager2::getInstanceMapTree(InstanceTreeMap & instanceMapTree)
documentation:
  brief: Retrieves the instance map tree structure used for virtual map navigation
    and collision detection.
  description: The getInstanceMapTree method provides access to the internal InstanceTreeMap
    data structure that manages the hierarchical organization of instance maps within
    the VMap (Virtual Map) system. This structure is essential for handling complex
    terrain and object interactions in World of Warcraft's virtual environment, particularly
    for determining line-of-sight, collision detection, and navigation between different
    map instances. The method populates the provided InstanceTreeMap reference with
    current map tree data, enabling external systems to query or manipulate instance-specific
    map relationships. This functionality is crucial for maintaining accurate spatial
    awareness across multiple instance types and dynamic map environments.
  parameters:
  - name: instanceMapTree
    description: Reference to an InstanceTreeMap object that will be populated with
      the current instance map tree data structure. This parameter is modified in-place
      to contain all relevant map instance relationships and hierarchical data.
  returns: null
  examples:
  - title: Accessing Instance Map Tree for Navigation
    code: "InstanceTreeMap mapTree;\nVMapManager2::getInstanceMapTree(mapTree);\n\
      // Use mapTree to query instance relationships\nfor (auto& pair : mapTree)\n\
      {\n    uint32 instanceId = pair.first;\n    // Process each instance in the\
      \ tree\n}"
    language: cpp
  - title: Querying Map Tree for Collision Detection
    code: "InstanceTreeMap tree;\nVMapManager2::getInstanceMapTree(tree);\n\n// Example\
      \ of checking if a specific instance exists\nuint32 targetInstanceId = 1234;\n\
      if (tree.find(targetInstanceId) != tree.end())\n{\n    // Instance exists in\
      \ the map tree\n    // Proceed with collision detection operations\n}"
    language: cpp
  notes: This method is typically called during server initialization or when instance
    map data needs to be refreshed. The returned InstanceTreeMap contains hierarchical
    references to all active instance maps, which are used extensively by the VMap
    system for efficient spatial queries. Developers should be aware that this method
    accesses shared global state and may require appropriate locking mechanisms in
    multi-threaded contexts.
  warnings: Calling this method without proper synchronization in a multi-threaded
    environment may lead to race conditions or inconsistent data access. The InstanceTreeMap
    returned by this method is a reference to internal data structures, so modifications
    should be avoided to prevent unintended side effects in the VMap system.
  related:
  - getVMap
  - getMapTree
  - loadMap
  - unloadMap
metadata:
  confidence: 0.9
  generated_at: '2025-11-01T19:56:37.220456'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
