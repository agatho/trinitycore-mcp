api:
  class: WorldSession
  method: HandleQueryCorpseLocation
  signature: void WorldSession::HandleQueryCorpseLocation(WorldPackets::Query::QueryCorpseLocationFromClient
    & packet)
documentation:
  brief: Handles client requests to query the location of a corpse
  description: This method processes incoming client packets requesting information
    about the location of a player's corpse. It is typically invoked when a player
    attempts to resurrect at a corpse or when they request to be teleported to their
    corpse location. The method validates the request and sends back the corpse coordinates,
    map ID, and other relevant location data to the client. This functionality supports
    core gameplay mechanics such as corpse retrieval and resurrection in World of
    Warcraft.
  parameters: []
  returns: null
  examples:
  - title: Basic usage in packet handling
    code: "void WorldSession::HandleQueryCorpseLocation(WorldPackets::Query::QueryCorpseLocationFromClient&\
      \ packet)\n{\n    // Validate player is alive and has a corpse\n    if (!GetPlayer()->IsAlive()\
      \ && GetPlayer()->HasCorpse())\n    {\n        // Send corpse location to client\n\
      \        WorldPackets::Query::CorpseLocation corpseLoc;\n        corpseLoc.PlayerGUID\
      \ = GetPlayer()->GetGUID();\n        corpseLoc.MapID = GetPlayer()->GetCorpseMapId();\n\
      \        corpseLoc.Position = GetPlayer()->GetCorpsePosition();\n        SendPacket(corpseLoc.Write());\n\
      \    }\n}"
    language: cpp
  notes: This method is part of the core WorldSession packet handling system and should
    only be called from within the main game loop. It assumes that the player object
    exists and has valid corpse data. The method does not perform any direct database
    operations but relies on existing player state information.
  warnings: Improper handling of this packet can lead to incorrect corpse location
    data being sent to clients, potentially causing players to be teleported to wrong
    locations or unable to resurrect properly. Ensure that all preconditions are checked
    before processing the request.
  related:
  - HandleCorpseQuery
  - SendCorpseLocation
  - GetPlayer()->HasCorpse()
  - GetPlayer()->GetCorpsePosition()
metadata:
  confidence: 0.9
  generated_at: '2025-11-04T21:08:56.044112'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
