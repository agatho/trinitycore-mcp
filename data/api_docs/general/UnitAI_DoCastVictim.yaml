api:
  class: UnitAI
  method: DoCastVictim
  signature: int UnitAI::DoCastVictim(uint32 spellId, const int & args)
documentation:
  brief: Initiates casting of a specified spell on the current target.
  description: The DoCastVictim method is used by AI-controlled units to cast a spell
    on their current victim or target. It serves as a core function for spellcasting
    behavior in unit AI, typically invoked during combat situations. The method handles
    the logic for selecting the appropriate target (usually the current victim), checking
    if the spell can be cast, and initiating the casting process. This function is
    commonly used by creatures with spell abilities to maintain their combat effectiveness
    against players or other units.
  parameters:
  - name: spellId
    description: The unique identifier of the spell to be cast. This must correspond
      to a valid spell entry in the game's spell database.
  - name: args
    description: Reference to an integer parameter that may contain additional casting
      arguments or flags. The specific meaning depends on the implementation context
      and can affect casting behavior such as whether to cast instantly or with a
      channel.
  returns: Returns an integer value indicating the success or failure of the spell
    casting attempt. A return value of 0 typically indicates successful casting, while
    non-zero values may indicate various error conditions such as invalid target,
    insufficient mana, or spell restrictions.
  examples:
  - title: Basic usage in AI behavior
    code: "void MyCreatureAI::UpdateAI(uint32 diff)\n{\n    if (!UpdateVictim())\n\
      \        return;\n\n    if (me->HealthBelowPct(30))\n    {\n        DoCastVictim(SPELL_HEALING_TOUCH,\
      \ 0);\n        return;\n    }\n\n    DoCastVictim(SPELL_FROST_NOVA, 0);\n}"
    language: cpp
  - title: Using different casting arguments
    code: "void BossAI::ExecuteEvent(uint32 eventId)\n{\n    switch (eventId)\n  \
      \  {\n        case EVENT_SHOCK:\n            DoCastVictim(SPELL_LIGHTNING_SHOCK,\
      \ 1); // Cast with channeling\n            break;\n        case EVENT_BOLT:\n\
      \            DoCastVictim(SPELL_BOLT_OF_FIRE, 0);   // Cast instantly\n    \
      \        break;\n    }\n}"
    language: cpp
  notes: This method assumes that the unit has a valid victim/target set. It internally
    calls the spell casting system which will perform checks like line of sight, target
    validity, and resource requirements. The 'args' parameter allows for fine-tuning
    of casting behavior but should be used carefully as it may affect performance
    or game balance.
  warnings: Calling DoCastVictim without a valid victim can result in undefined behavior
    or failed casts. Always ensure that UpdateVictim() returns true before calling
    this method, especially in combat AI logic. Improper use of the args parameter
    can lead to unexpected casting behavior or client-side issues.
  related:
  - DoCast
  - DoCastSpell
  - UpdateVictim
  - GetVictim
metadata:
  confidence: 0.9
  generated_at: '2025-11-06T00:16:53.032981'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
