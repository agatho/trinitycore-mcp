api:
  class: WorldSession
  method: HandleSendMail
  signature: void WorldSession::HandleSendMail(WorldPackets::Mail::SendMail & sendMail)
documentation:
  brief: Processes and handles the client's request to send a mail message to another
    player.
  description: The HandleSendMail method is responsible for processing a client-initiated
    mail sending request. It validates the recipient, checks if the sender has sufficient
    in-game currency for any attachments or postage fees, verifies that the mail content
    is within size limits, and ensures the player's mailbox isn't full. The method
    constructs and sends the appropriate server response packets to confirm successful
    delivery or report errors such as invalid recipients or insufficient funds. This
    function integrates with TrinityCore's mail system to maintain game economy balance
    and player communication mechanics.
  parameters: []
  returns: null
  examples:
  - title: Basic Mail Sending
    code: "void SendMailExample(WorldSession* session) {\n    WorldPackets::Mail::SendMail\
      \ sendMail;\n    sendMail.Recipient = 123456789;\n    sendMail.Subject = \"\
      Greetings\";\n    sendMail.Body = \"Hello there!\";\n    sendMail.Money = 0;\n\
      \    sendMail.Cod = 0;\n    session->HandleSendMail(sendMail);\n}"
    language: cpp
  notes: This method relies on the player's current mailbox state and currency. It
    performs multiple checks including item validation, recipient existence, and mail
    attachment limits. The method is typically invoked from a packet handler that
    receives data from the client's mail interface.
  warnings: Improper handling of this method can lead to exploits such as sending
    unlimited mails or bypassing monetary requirements. Ensure all input parameters
    are validated before calling this function.
  related:
  - HandleMailGetList
  - HandleMailTakeItem
  - HandleMailTakeMoney
  - HandleMailDelete
metadata:
  confidence: 0.9
  generated_at: '2025-11-04T20:35:55.262621'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
