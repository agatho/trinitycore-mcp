api:
  class: TradeManager
  method: UpdateTradeWindow
  signature: void TradeManager::UpdateTradeWindow()
documentation:
  brief: Updates the trade window state for both players involved in a trade.
  description: The UpdateTradeWindow method synchronizes and refreshes the trade window
    interface for both parties in an active trade session. This method ensures that
    each player's client displays the current state of the trade, including items
    offered by both traders, accepted status, and any changes made during the trading
    process. It is typically invoked when a player adds or removes an item from the
    trade window, accepts or cancels the trade, or when the trade state needs to be
    refreshed due to external events such as disconnection or time-out. The method
    handles internal state management and network synchronization to maintain consistency
    between client and server.
  parameters: []
  returns: null
  examples:
  - title: Basic Trade Window Update
    code: 'TradeManager* tradeMgr = player1->GetSession()->GetTradeData();

      tradeMgr->UpdateTradeWindow();'
    language: cpp
  - title: Updating Trade After Item Addition
    code: 'Player* player1 = ...;

      Player* player2 = ...;

      Item* item = ...;

      player1->GetSession()->GetTradeData()->AddItem(item);

      player1->GetSession()->GetTradeData()->UpdateTradeWindow();

      player2->GetSession()->GetTradeData()->UpdateTradeWindow();'
    language: cpp
  notes: This method is crucial for maintaining trade integrity in TrinityCore. It
    must be called whenever any change occurs in the trade state to ensure both players
    see synchronized updates. The implementation internally uses packet sending mechanisms
    to update client interfaces and may involve locking mechanisms to prevent race
    conditions during concurrent access.
  warnings: Improper usage of this method can lead to desynchronized trade windows,
    where one player sees different trade states than the other. Avoid calling this
    method outside of valid trade contexts or without proper session validation, as
    it might cause undefined behavior or client-side errors.
  related:
  - TradeManager::AddItem
  - TradeManager::AcceptTrade
  - TradeManager::CancelTrade
  - TradeManager::ClearTrade
metadata:
  confidence: 0.9
  generated_at: '2025-11-03T16:13:23.509025'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
