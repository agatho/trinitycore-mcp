api:
  class: BotThreatManager
  method: OnDamageDealt
  signature: void BotThreatManager::OnDamageDealt(Unit * target, uint32 damage)
documentation:
  brief: Handles threat generation when a bot deals damage to a target unit
  description: The OnDamageDealt method is invoked by the BotThreatManager to process
    and update threat levels when a bot character inflicts damage upon another unit.
    This method integrates with the game's threat system to ensure that bots maintain
    appropriate aggro behavior based on their damage output. It typically updates
    internal threat tables or triggers relevant AI logic to manage the bot's combat
    engagement state. The method is part of the automated threat management system
    for bot characters within TrinityCore's AI framework.
  parameters:
  - name: target
    description: Pointer to the Unit object that received the damage. Must be a valid
      target unit in the current combat context.
  - name: damage
    description: The amount of damage dealt to the target. Should be a positive integer
      representing the total damage points.
  returns: null
  examples:
  - title: Basic Usage in Bot AI Update
    code: "void BotAI::UpdateAI(uint32 diff)\n{\n    if (Unit* target = GetVictim())\n\
      \    {\n        if (me->CanAttack(target))\n        {\n            uint32 damage\
      \ = me->CalculateDamage(target, WeaponAttackType::BASE_ATTACK);\n          \
      \  threatManager.OnDamageDealt(target, damage);\n            me->DealDamage(target,\
      \ damage, nullptr, DIRECT_DAMAGE, SPELL_SCHOOL_MASK_NORMAL);\n        }\n  \
      \  }\n}"
    language: cpp
  notes: This method is typically called internally by the bot's combat logic and
    should not be invoked manually unless implementing custom threat behavior. The
    threat calculation may depend on factors such as spell type, weapon damage, and
    bot class abilities.
  warnings: Ensure that the target pointer is valid before calling this method to
    prevent null pointer exceptions. Improper handling of damage values could lead
    to incorrect threat generation or AI behavior anomalies.
  related:
  - OnDamageTaken
  - UpdateThreat
  - GetThreat
metadata:
  confidence: 0.85
  generated_at: '2025-11-02T10:32:01.860994'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
