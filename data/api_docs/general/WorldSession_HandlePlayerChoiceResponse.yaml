api:
  class: WorldSession
  method: HandlePlayerChoiceResponse
  signature: void WorldSession::HandlePlayerChoiceResponse(const WorldPackets::Quest::ChoiceResponse
    & choiceResponse)
documentation:
  brief: Processes a player's response to a quest choice dialog, updating quest state
    and triggering associated actions.
  description: The HandlePlayerChoiceResponse method handles the client-side response
    to a quest choice dialog presented to the player. This method is invoked when
    a player selects an option from a quest choice window, typically triggered by
    a quest that offers multiple reward or action choices. The method processes the
    selected choice, updates the player's quest state accordingly, and may trigger
    additional game mechanics such as reward distribution, quest progression, or quest
    completion. It ensures that the server-side quest data is synchronized with the
    client's selection, maintaining consistency in the player's quest progress. This
    method is part of the core quest handling system in TrinityCore and is essential
    for managing complex quest interactions that involve multiple decision points.
  parameters:
  - name: choiceResponse
    description: A packet containing the player's selected choice, including the quest
      ID, choice index, and any associated data. The packet structure typically includes
      identifiers for the specific quest choice being responded to.
  returns: null
  examples:
  - title: Basic usage of HandlePlayerChoiceResponse
    code: "void WorldSession::HandlePlayerChoiceResponse(const WorldPackets::Quest::ChoiceResponse\
      \ & choiceResponse)\n{\n    // Process the player's choice\n    if (choiceResponse.QuestID\
      \ && choiceResponse.ChoiceIndex < 10)\n    {\n        // Update quest state\
      \ based on choice\n        Player* player = GetPlayer();\n        if (player)\n\
      \        {\n            player->QuestChooseReward(choiceResponse.QuestID, choiceResponse.ChoiceIndex);\n\
      \        }\n    }\n}"
    language: cpp
  notes: This method is typically called from the packet handling system when a client
    sends a quest choice response. The method assumes that the player has an active
    quest with choices available and that the choice index is valid. It's important
    to note that this method may trigger additional network packets back to the client
    to update quest status or provide rewards.
  warnings: Improper handling of choice indices can lead to quest state inconsistencies
    or crashes. Ensure that all quest choices are properly validated before processing,
    especially when dealing with multiple-choice scenarios. This method should not
    be called directly without proper validation of the input packet data.
  related:
  - HandleQuestConfirmAccept
  - HandleQuestQueryResponse
  - Player::QuestChooseReward
  - WorldSession::SendQuestGiverQuestDetails
metadata:
  confidence: 0.9
  generated_at: '2025-11-04T21:11:35.819328'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
