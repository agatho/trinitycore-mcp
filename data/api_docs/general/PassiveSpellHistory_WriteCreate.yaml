api:
  class: PassiveSpellHistory
  method: WriteCreate
  signature: void PassiveSpellHistory::WriteCreate(ByteBuffer & data, const Unit *
    owner, const Player * receiver) const
documentation:
  brief: Writes passive spell history data to a packet buffer for transmission to
    a player.
  description: The WriteCreate method serializes the passive spell history information
    of a unit into a ByteBuffer, which is typically used to construct a network packet
    sent to a specific player. This method is part of the TrinityCore's packet serialization
    system and is essential for synchronizing passive spell data between the server
    and client. It ensures that the receiver's client has up-to-date information about
    the passive spells associated with the owner unit, such as those granted by talents,
    items, or other game mechanics. The method takes into account the ownership relationship
    and player-specific data when constructing the serialized output.
  parameters:
  - name: data
    description: Reference to a ByteBuffer where the serialized passive spell history
      data will be written.
  - name: owner
    description: Pointer to the Unit object whose passive spell history is being serialized.
      This represents the source of the spell data.
  - name: receiver
    description: Pointer to the Player object who will receive this packet. Used for
      player-specific serialization logic if needed.
  returns: null
  examples:
  - title: Basic usage in a packet sending context
    code: 'ByteBuffer data;

      Player* receiver = ...;

      Unit* owner = ...;

      PassiveSpellHistory history;

      history.WriteCreate(data, owner, receiver);

      receiver->GetSession()->SendPacket(&data);'
    language: cpp
  notes: This method is typically invoked during packet construction for updates related
    to unit states or spell information. It's important to ensure that the 'owner'
    and 'receiver' parameters are valid pointers before calling this method, as invalid
    pointers can lead to undefined behavior. The serialization process may involve
    multiple steps including checking for active spells, filtering based on visibility
    rules, and applying player-specific modifications.
  warnings: Do not call this method with null pointers for owner or receiver parameters.
    Ensure that the ByteBuffer is properly initialized before passing it to this method.
    Incorrect usage can result in corrupted packets or client-side errors.
  related:
  - PassiveSpellHistory::ReadCreate
  - PassiveSpellHistory::Clear
  - PassiveSpellHistory::AddSpell
  - PassiveSpellHistory::RemoveSpell
metadata:
  confidence: 0.9
  generated_at: '2025-11-07T22:48:34.074935'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
