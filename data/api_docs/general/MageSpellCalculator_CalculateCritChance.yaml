api:
  class: MageSpellCalculator
  method: CalculateCritChance
  signature: float MageSpellCalculator::CalculateCritChance(uint32 spellId, Player
    * caster, ::Unit * target)
documentation:
  brief: Calculates the critical strike chance for a mage spell based on spell ID,
    caster, and target.
  description: The CalculateCritChance method determines the probability of a mage
    spell landing a critical hit. It takes into account the specific spell being cast,
    the caster's class abilities, talents, and the target's resistance properties.
    This method is essential for accurately simulating spell mechanics in the TrinityCore
    framework, particularly for Mage class spells where critical strikes provide significant
    damage bonuses. The calculation considers various factors such as caster's crit
    rating, spell-specific modifiers, and target avoidance mechanics to return a normalized
    chance value between 0.0 and 1.0.
  parameters:
  - name: spellId
    description: The unique identifier of the spell being cast. This determines which
      spell-specific critical strike calculations are applied.
  - name: caster
    description: Pointer to the Player object representing the mage casting the spell.
      Required for accessing caster's stats, talents, and class-specific modifiers.
  - name: target
    description: Pointer to the Unit object representing the spell's target. Used
      to determine target resistance and avoidance properties that may modify critical
      strike chance.
  returns: A float value between 0.0 and 1.0 representing the probability of a critical
    strike occurring. A value of 0.0 indicates no chance of crit, while 1.0 indicates
    guaranteed critical hit.
  examples:
  - title: Basic usage for Fireball spell
    code: 'Player* player = ...; // Mage player

      Unit* target = ...; // Target unit

      float critChance = calculator->CalculateCritChance(133, player, target);

      // Returns critical strike chance for Fireball spell (ID 133)'
    language: cpp
  - title: Using with different mage spells
    code: 'Player* mage = ...;

      Unit* enemy = ...;

      float frostboltCrit = calculator->CalculateCritChance(116, mage, enemy);  //
      Frostbolt

      float arcaneBoltCrit = calculator->CalculateCritChance(55359, mage, enemy);
      // Arcane Bolt

      // These will return different values based on spell-specific crit modifiers'
    language: cpp
  notes: This method likely integrates with TrinityCore's spell system and player
    stat management. The calculation may involve multiple components including base
    spell crit chance, caster's critical strike rating, talent bonuses, and target
    avoidance. Performance is generally good as it only performs calculations when
    needed during spell casting.
  warnings: Ensure that both caster and target pointers are valid before calling this
    method to avoid segmentation faults. The spellId must correspond to a valid mage
    spell in the database, otherwise results may be unpredictable or incorrect.
  related:
  - CalculateSpellDamage
  - GetSpellCritChance
  - ApplySpellModifiers
metadata:
  confidence: 0.9
  generated_at: '2025-11-06T09:01:15.487893'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
