api:
  class: EnhancedBotAI
  method: OnCombatEnd
  signature: void EnhancedBotAI::OnCombatEnd()
documentation:
  brief: Handles cleanup and state management when a bot exits combat mode
  description: The OnCombatEnd method is called when a bot's combat state transitions
    from active to inactive. This method performs necessary cleanup operations such
    as resetting combat-related flags, clearing target information, and updating the
    bot's AI state machine. It ensures that the bot properly transitions back to its
    default non-combat behavior and releases any resources or references held during
    combat. The method is typically invoked by the core combat system when the bot's
    health drops below a certain threshold or when all enemies are defeated.
  parameters: []
  returns: null
  examples:
  - title: Basic usage in AI update loop
    code: "void BotAI::UpdateAI(uint32 diff)\n{\n    if (m_isInCombat && !me->IsInCombat())\n\
      \    {\n        OnCombatEnd();\n        m_isInCombat = false;\n    }\n}"
    language: cpp
  notes: This method should be called only when transitioning from combat to non-combat
    state. It assumes that the bot's combat state has already been properly updated
    by the core system before invocation.
  warnings: Do not call this method directly unless you are certain that combat has
    actually ended. Calling it prematurely may result in inconsistent AI behavior
    or resource leaks.
  related:
  - OnCombatStart
  - UpdateAI
  - IsInCombat
metadata:
  confidence: 0.9
  generated_at: '2025-11-06T14:48:23.328150'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
