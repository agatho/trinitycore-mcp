api:
  class: PathfindingUtils
  method: GetFurthestSafePosition
  signature: int PathfindingUtils::GetFurthestSafePosition(const int & start, const
    int & direction, float maxDistance, Map * map)
documentation:
  brief: Calculates the furthest safe position along a given direction from a starting
    point within a maximum distance on a specified map.
  description: The GetFurthestSafePosition method determines the maximum distance
    a unit can travel in a specified direction from a starting position without encountering
    unsafe terrain or obstacles. It evaluates the path along the provided direction
    and returns the index of the furthest valid position within the given maxDistance
    limit. This utility is commonly used for AI pathfinding, movement validation,
    and ensuring units do not move into harmful areas such as water, cliffs, or other
    impassable regions. The method requires a valid Map pointer to perform spatial
    checks and uses internal pathfinding algorithms to assess safety.
  parameters:
  - name: start
    description: The starting position index or identifier from which the search begins.
      This is typically a point on the map's navigation mesh.
  - name: direction
    description: The direction vector or angle indicating the path along which to
      search for the furthest safe position. This may be represented as an integer
      angle or normalized vector depending on implementation details.
  - name: maxDistance
    description: The maximum distance in game units (e.g., yards) to search from the
      starting point. The method will not return a position beyond this distance even
      if it is safe.
  - name: map
    description: Pointer to the Map object where the pathfinding occurs. This is required
      for spatial checks and navigation mesh access.
  returns: Returns an integer representing the index or identifier of the furthest
    safe position along the specified direction within the maximum distance. If no
    safe position is found, it may return -1 or a special error code depending on
    implementation.
  examples:
  - title: Basic usage in AI movement
    code: "int safePos = PathfindingUtils::GetFurthestSafePosition(startPoint, directionAngle,\
      \ 50.0f, player->GetMap());\nif (safePos != -1) {\n    // Proceed with movement\
      \ to safePos\n}"
    language: cpp
  - title: Using with unit AI for path validation
    code: "float maxDist = 30.0f;\nint furthestSafe = PathfindingUtils::GetFurthestSafePosition(unit->GetPositionX(),\
      \ unit->GetOrientation(), maxDist, unit->GetMap());\nif (furthestSafe > 0) {\n\
      \    Position targetPos;\n    // Convert furthestSafe index to actual coordinates\n\
      \    unit->GetMotionMaster()->MovePoint(furthestSafe, targetPos);\n}"
    language: cpp
  notes: This method relies heavily on the underlying navigation mesh and pathfinding
    system of TrinityCore. It assumes that the map has valid NavMesh data and that
    the start position is within a traversable area. Performance may vary based on
    complexity of terrain and number of obstacles in the search space.
  warnings: Ensure that the Map pointer passed is valid and not null, as passing an
    invalid pointer can lead to crashes or undefined behavior. Also note that this
    method does not account for dynamic obstacles such as moving creatures or players
    unless they are part of the NavMesh.
  related:
  - GetSafePosition
  - IsPositionValid
  - CalculatePath
metadata:
  confidence: 0.85
  generated_at: '2025-11-03T22:07:54.201669'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
