api:
  class: PetAI
  method: CanAttack
  signature: bool PetAI::CanAttack(int * target)
documentation:
  brief: Determines whether a pet can attack a target based on AI state and conditions.
  description: The CanAttack method evaluates if a pet unit is currently able to initiate
    an attack against a specified target. It checks various AI-related conditions
    such as the pet's current state, target validity, faction relationships, and combat
    readiness. This method is typically used internally by the PetAI system to control
    when a pet should engage in combat behavior. The method returns true if the pet
    can attack the target, and false otherwise. It may also update the target parameter
    with a valid target if the original target is invalid or if a new suitable target
    is found.
  parameters:
  - name: target
    description: Pointer to an integer representing the target's unit ID. The method
      may modify this value to point to a valid attack target if the original target
      is not suitable.
  returns: Returns true if the pet can attack the specified target, false otherwise.
    A return value of false typically indicates that the pet is in an invalid state,
    the target is unreachable or invalid, or the pet's AI logic prevents engagement.
  examples:
  - title: Basic usage to check if pet can attack
    code: "if (petAI->CanAttack(&targetId)) {\n    // Pet can attack target\n    pet->Attack(targetId);\n\
      } else {\n    // Pet cannot attack target\n    pet->SetTarget(0);\n}"
    language: cpp
  - title: Using CanAttack in AI decision making
    code: "void PetAI::UpdateAI(uint32 diff) {\n    if (CanAttack(&m_targetGuid))\
      \ {\n        // Proceed with attack logic\n        Attack(m_targetGuid);\n \
      \   } else if (GetPet()->getVictim() && !CanAttack(&m_targetGuid)) {\n     \
      \   // Pet is in combat but cannot attack, stop attacking\n        GetPet()->AttackStop();\n\
      \    }\n}"
    language: cpp
  notes: This method is part of the core AI decision-making system for pets in TrinityCore.
    It integrates with the pet's current state machine and target selection logic.
    The method may perform internal checks such as whether the pet is in combat, if
    the target is valid, or if the pet has sufficient mana/stamina to attack.
  warnings: The target parameter can be modified by this method, so callers should
    be prepared for changes to the value pointed to by the parameter. This behavior
    is important when chaining multiple AI decisions or when using the same target
    reference in subsequent logic.
  related:
  - PetAI::Attack
  - PetAI::UpdateAI
  - PetAI::CanPetAttack
  - PetAI::SetTarget
metadata:
  confidence: 0.9
  generated_at: '2025-11-07T11:46:30.184790'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
