api:
  class: LootDistribution
  method: CanPlayerNeedItem
  signature: bool LootDistribution::CanPlayerNeedItem(Player * player, const LootItem
    & item)
documentation:
  brief: Determines whether a player can receive a specific loot item based on their
    inventory and game rules.
  description: The CanPlayerNeedItem method evaluates if a given player is eligible
    to receive a particular loot item during a loot distribution process. It checks
    various conditions such as the player's inventory space, item type restrictions
    (like unique items or soulbound items), and game mechanics like quest item limitations.
    This method ensures that players do not receive duplicate items they cannot use
    or store, maintaining proper loot distribution balance within the game. The check
    is performed before allowing a player to roll for or receive an item during a
    group loot event.
  parameters:
  - name: player
    description: Pointer to the Player object that is being evaluated for receiving
      the loot item. Must be a valid player instance, otherwise behavior is undefined.
  - name: item
    description: Reference to the LootItem structure containing information about
      the item being considered for distribution. This includes item template data
      and distribution properties.
  returns: Returns true if the player can legally receive the item (i.e., has space,
    meets requirements, and is not restricted), otherwise returns false.
  examples:
  - title: Basic usage in loot processing
    code: "if (lootDist->CanPlayerNeedItem(player, lootItem)) {\n    // Player can\
      \ receive this item\n    player->AddItem(lootItem.itemTemplate);\n} else {\n\
      \    // Item cannot be given to player\n    player->SendLootError(LOOT_ERROR_ITEM_LOCKED);\n\
      }"
    language: cpp
  - title: Checking multiple players for item eligibility
    code: "for (auto& player : groupMembers) {\n    if (lootDist->CanPlayerNeedItem(player,\
      \ lootItem)) {\n        // Process item distribution\n        lootDist->DistributeItem(player,\
      \ lootItem);\n    }\n}"
    language: cpp
  notes: This method is part of the core loot distribution system in TrinityCore and
    integrates with player inventory management, item restrictions, and group loot
    rules. It's typically called during the loot rolling phase before finalizing item
    assignments.
  warnings: Ensure that both player and item parameters are valid before calling this
    method to avoid undefined behavior or crashes. The method does not perform any
    automatic item removal or distribution; it only evaluates eligibility.
  related:
  - LootDistribution::RollForItem
  - LootDistribution::DistributeItem
  - Player::AddItem
  - Player::HasSpaceForItem
metadata:
  confidence: 0.92
  generated_at: '2025-11-04T00:48:13.354246'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
