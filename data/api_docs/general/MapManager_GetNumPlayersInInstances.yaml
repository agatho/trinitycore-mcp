api:
  class: MapManager
  method: GetNumPlayersInInstances
  signature: uint32 MapManager::GetNumPlayersInInstances() const
documentation:
  brief: Returns the total number of players currently present in any instance world
    map.
  description: The GetNumPlayersInInstances method provides a count of all player
    characters that are currently located within instance maps (such as dungeons,
    raids, or battlegrounds) across the entire server. This includes both active players
    and those who may be in the process of transitioning between maps. The method
    aggregates data from all active instance worlds managed by the MapManager, making
    it useful for monitoring server load, player distribution, and game balance metrics.
    It does not include players in non-instance areas such as the world map or taxi
    paths.
  parameters: []
  returns: A uint32 value representing the total number of players currently located
    within any instance map on the server. Returns zero if no players are in instances.
  examples:
  - title: Basic Usage to Monitor Player Load
    code: "uint32 playerCount = sMapMgr->GetNumPlayersInInstances();\nif (playerCount\
      \ > 100)\n{\n    sLog->outString(\"High instance player load detected: %u players\"\
      , playerCount);\n}"
    language: cpp
  - title: Using in Server Status Command
    code: "// In a command handler\nvoid HandleInstancePlayerCountCommand(ChatHandler*\
      \ handler)\n{\n    uint32 count = sMapMgr->GetNumPlayersInInstances();\n   \
      \ handler->PSendSysMessage(\"Players currently in instances: %u\", count);\n\
      \    return true;\n}"
    language: cpp
  notes: This method iterates through all active instance maps to compile the player
    count, which may have performance implications during high server load. The returned
    value reflects only players who are fully within an instance world, not those
    in transition states or queued for instances.
  warnings: The method does not account for players who might be in a loading state
    or transitioning between maps. It's recommended to use this method with caution
    in performance-critical code paths due to its potential iteration over all active
    instances.
  related:
  - GetNumPlayersInWorld
  - GetInstance
  - GetMap
metadata:
  confidence: 0.95
  generated_at: '2025-11-01T10:39:36.324738'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
