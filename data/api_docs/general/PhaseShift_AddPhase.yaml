api:
  class: PhaseShift
  method: AddPhase
  signature: bool PhaseShift::AddPhase(uint32 phaseId, PhaseFlags flags, const int
    * areaConditions, int32 references)
documentation:
  brief: Adds a new phase to the PhaseShift object with specified phase ID, flags,
    area conditions, and references.
  description: The AddPhase method is used to register a new phase within a PhaseShift
    object. It allows for defining a phase with its associated properties including
    phase ID, flags, area conditions, and reference count. This functionality is critical
    in World of Warcraft's phase system where different phases control visibility
    and interaction of game objects, NPCs, and environments based on player state
    or events. The method returns true if the phase was successfully added, or false
    if it failed due to invalid parameters or existing conflicts. The phase ID uniquely
    identifies the phase within the system, while flags define how the phase behaves
    in relation to other phases and players. Area conditions can be used to restrict
    when a phase becomes active based on player location or other criteria, and references
    track how many entities are currently using this phase.
  parameters:
  - name: phaseId
    description: Unique identifier for the phase being added. Must be a valid phase
      ID that is not already registered in the current PhaseShift object.
  - name: flags
    description: Phase flags that define behavior and interaction rules for this phase.
      These flags control how the phase interacts with other phases, player visibility,
      and event triggering.
  - name: areaConditions
    description: Pointer to an array of integers representing area-based conditions
      for activating this phase. Can be NULL if no area conditions are required.
  - name: references
    description: Reference count indicating how many entities are using this phase.
      Must be a non-negative integer value.
  returns: Returns true if the phase was successfully added to the PhaseShift object,
    false otherwise. Failure can occur due to invalid parameters, duplicate phase
    IDs, or system constraints.
  examples:
  - title: Basic Phase Addition
    code: 'PhaseShift shift;

      uint32 phaseId = 1001;

      PhaseFlags flags = PHASE_FLAG_NORMAL;

      int areaConditions[] = { 1, 2, 3 };

      bool result = shift.AddPhase(phaseId, flags, areaConditions, 1);

      // Adds a new phase with ID 1001 and one reference'
    language: cpp
  - title: Adding Phase Without Area Conditions
    code: 'PhaseShift shift;

      uint32 phaseId = 2005;

      PhaseFlags flags = PHASE_FLAG_INVERSE;

      bool result = shift.AddPhase(phaseId, flags, nullptr, 0);

      // Adds a phase with no area conditions and zero references'
    language: cpp
  notes: This method is part of the core phase management system in TrinityCore. It's
    typically used during world object initialization or event activation to dynamically
    modify which phases are active for players. The PhaseShift class manages multiple
    phases simultaneously, and this method ensures proper registration of new phases
    within that system.
  warnings: Ensure that phase IDs are unique within a single PhaseShift instance to
    avoid conflicts. Passing NULL for areaConditions is valid but should be done intentionally.
    Be careful with negative reference counts as they may cause unexpected behavior
    in the phase system.
  related:
  - RemovePhase
  - HasPhase
  - GetPhases
metadata:
  confidence: 0.9
  generated_at: '2025-11-06T06:22:12.293967'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
