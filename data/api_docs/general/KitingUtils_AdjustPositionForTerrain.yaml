api:
  class: KitingUtils
  method: AdjustPositionForTerrain
  signature: int KitingUtils::AdjustPositionForTerrain(const int & intended, float
    searchRadius)
documentation:
  brief: Adjusts a given position to the nearest valid terrain height within a specified
    search radius.
  description: The AdjustPositionForTerrain method takes an intended position coordinate
    and adjusts it to the nearest valid terrain height within the provided search
    radius. This is commonly used in kiting mechanics to ensure that player or NPC
    positions are properly aligned with the ground level, preventing issues such as
    characters floating above terrain or getting stuck in geometry. The method performs
    a terrain query to find the closest walkable surface within the defined radius
    and returns the adjusted height value. It is particularly useful for pathfinding
    and movement logic where precise ground positioning is required.
  parameters:
  - name: intended
    description: The intended position coordinate (typically Y coordinate) that needs
      to be adjusted to match valid terrain height.
  - name: searchRadius
    description: The maximum distance in yards to search for valid terrain height
      around the intended position. Larger values may impact performance but provide
      more accurate results.
  returns: Returns the adjusted position value that corresponds to the nearest valid
    terrain height within the specified search radius. If no valid terrain is found,
    it returns the original intended value.
  examples:
  - title: Basic usage for adjusting player position
    code: int adjustedY = KitingUtils::AdjustPositionForTerrain(player->GetPositionY(),
      5.0f);
    language: cpp
  - title: Using with NPC movement to ensure ground alignment
    code: 'float searchRadius = 10.0f;

      int adjustedHeight = KitingUtils::AdjustPositionForTerrain(npc->GetPositionZ(),
      searchRadius);

      npc->SetPosition(npc->GetPositionX(), npc->GetPositionY(), adjustedHeight);'
    language: cpp
  notes: This method relies on the TrinityCore's terrain system and may have performance
    implications when used frequently in tight loops. The search radius should be
    tuned based on expected terrain variations to balance accuracy and performance.
    Ensure that the intended parameter represents a valid coordinate space before
    calling this function.
  warnings: Calling this method with a very large search radius can significantly
    impact performance due to extensive terrain queries. Avoid using it in high-frequency
    movement updates without proper caching or optimization. The method may return
    the original value if no valid terrain is found, which could lead to unexpected
    positioning behavior if not handled properly.
  related:
  - GetTerrainHeightAtPosition
  - IsInWater
  - FindNearestWalkableArea
metadata:
  confidence: 0.85
  generated_at: '2025-11-06T11:11:02.131633'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
