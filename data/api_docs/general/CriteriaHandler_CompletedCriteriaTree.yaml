api:
  class: CriteriaHandler
  method: CompletedCriteriaTree
  signature: void CriteriaHandler::CompletedCriteriaTree(const CriteriaTree * tree,
    Player * referencePlayer)
documentation:
  brief: Processes and completes a criteria tree for the specified player, triggering
    associated rewards and updates.
  description: The CompletedCriteriaTree method is responsible for handling the completion
    of a criteria tree within the TrinityCore framework. This function takes a pointer
    to a CriteriaTree object and a reference to a Player object, and it processes
    all criteria entries within the tree, marking them as completed for the specified
    player. It typically triggers reward distribution, achievement updates, and other
    related game mechanics that occur when a criteria tree is fully satisfied. The
    method ensures proper synchronization of the player's progress with the criteria
    system and may update related quest states or reputation values depending on the
    criteria configuration.
  parameters:
  - name: tree
    description: A pointer to the CriteriaTree object that represents the set of criteria
      to be marked as completed. This parameter must not be null and should reference
      a valid criteria tree structure.
  - name: referencePlayer
    description: A pointer to the Player object for whom the criteria tree is being
      completed. This player's progress will be updated accordingly, and any rewards
      or triggers associated with the criteria will be processed for this specific
      player.
  returns: null
  examples:
  - title: Basic Usage
    code: "CriteriaTree* myTree = sCriteriaMgr->GetCriteriaTreeById(12345);\nPlayer*\
      \ targetPlayer = player;\nif (myTree && targetPlayer)\n{\n    sCriteriaHandler->CompletedCriteriaTree(myTree,\
      \ targetPlayer);\n}"
    language: cpp
  - title: With Error Checking
    code: "CriteriaTree* tree = sCriteriaMgr->GetCriteriaTreeById(player->GetUInt32Value(PLAYER_FIELD_CRITERIA_TREE_ID));\n\
      if (!tree)\n{\n    TC_LOG_ERROR(\"criteria\", \"Failed to get criteria tree\
      \ for player %u\", player->GetGUID().GetCounter());\n    return;\n}\n\nsCriteriaHandler->CompletedCriteriaTree(tree,\
      \ player);\nTC_LOG_DEBUG(\"criteria\", \"Completed criteria tree for player\
      \ %s\", player->GetName().c_str());"
    language: cpp
  notes: This method is typically called internally by the core when a player meets
    all requirements of a criteria tree. It's important to note that calling this
    method directly may bypass certain validation checks that would normally occur
    during normal gameplay progression. The function assumes that all prerequisites
    for completing the criteria have already been validated.
  warnings: Calling this method with invalid or null parameters can lead to undefined
    behavior or crashes. Ensure that both the CriteriaTree and Player objects are
    valid before invoking this function. Additionally, calling this method repeatedly
    on the same tree without proper state management may cause duplicate reward distribution
    or other unintended side effects.
  related:
  - GetCriteriaTreeById
  - UpdateCriteriaProgress
  - CheckCriteriaTreeCompletion
metadata:
  confidence: 0.85
  generated_at: '2025-11-06T16:05:40.252683'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
