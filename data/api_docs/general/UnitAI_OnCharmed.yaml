api:
  class: UnitAI
  method: OnCharmed
  signature: void UnitAI::OnCharmed(bool isNew)
documentation:
  brief: Called when a unit is charmed by another unit, handling the AI behavior for
    the charmed state.
  description: The OnCharmed method is invoked when a UnitAI instance detects that
    its associated unit has been charmed by another unit. This method is responsible
    for managing the AI behavior and state transitions when a creature or player becomes
    charmed. It typically handles tasks such as updating the unit's target, disabling
    certain AI behaviors, and ensuring proper interaction with the charmer. The method
    may also be used to trigger events or send notifications related to the charm
    status change. This is an important part of the AI system in TrinityCore for handling
    controlled units.
  parameters:
  - name: isNew
    description: A boolean flag indicating whether this is a new charm event (true)
      or if the unit was already charmed previously (false).
  returns: null
  examples:
  - title: Basic implementation of OnCharmed in a custom AI
    code: "class CustomCreatureAI : public UnitAI {\npublic:\n    void OnCharmed(bool\
      \ isNew) override {\n        if (isNew) {\n            // Handle new charm\n\
      \            me->SetControlled(true, UNIT_STATE_ROOT);\n        } else {\n \
      \           // Handle re-charm or existing charm\n            me->SetControlled(true,\
      \ UNIT_STATE_ROOT);\n        }\n    }\n};"
    language: cpp
  notes: This method is typically called from internal TrinityCore systems when a
    charm effect is applied to a unit. The AI implementation should be careful not
    to cause infinite loops or recursive calls during charm handling. It's recommended
    to use this method in conjunction with other charm-related callbacks like OnCharmerKilled
    or OnCharmedReset for complete charm lifecycle management.
  warnings: Improper handling of the OnCharmed event may lead to unexpected behavior
    such as units not properly following their charmer, AI loops, or incorrect state
    transitions. Ensure that any modifications to unit behavior during charm are consistent
    with game mechanics and do not break existing AI logic.
  related:
  - OnCharmerKilled
  - OnCharmedReset
  - IsCharmed
  - GetCharmer
metadata:
  confidence: 0.9
  generated_at: '2025-11-06T00:13:58.289508'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
