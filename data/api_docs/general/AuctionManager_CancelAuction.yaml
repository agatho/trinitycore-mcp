api:
  class: AuctionManager
  method: CancelAuction
  signature: bool AuctionManager::CancelAuction(Player * bot, uint32 auctionId)
documentation:
  brief: Cancels an auction item in the auction house system.
  description: The CancelAuction method removes a specific auction from the auction
    house database. It verifies that the player is the owner of the auction and that
    the auction has not yet been sold. The method updates the auction status to canceled,
    refunds the bid amount to the bidder (if applicable), and removes the auction
    entry from active listings. This function is typically invoked when a player wishes
    to withdraw their item from auction before it is purchased by another player.
  parameters:
  - name: bot
    description: Pointer to the Player object representing the auction owner attempting
      to cancel the auction.
  - name: auctionId
    description: Unique identifier of the auction to be canceled. Must correspond
      to an existing active auction in the system.
  returns: Returns true if the auction was successfully canceled, false otherwise.
    Failure may occur if the auction does not exist, is already sold, or the player
    is not the owner.
  examples:
  - title: Basic Auction Cancellation
    code: "Player* player = ...; // Get player reference\nuint32 auctionId = 12345;\n\
      bool result = sAuctionMgr->CancelAuction(player, auctionId);\nif (result)\n\
      {\n    TC_LOG_INFO(\"auction\", \"Auction %u successfully canceled.\", auctionId);\n\
      }\nelse\n{\n    TC_LOG_ERROR(\"auction\", \"Failed to cancel auction %u.\",\
      \ auctionId);\n}"
    language: cpp
  notes: This method interacts with the database and should be used carefully in performance-critical
    sections. The cancellation process includes refunding the bid amount if the auction
    was sold, which may involve additional database operations.
  warnings: Ensure that the player is authenticated and has sufficient permissions
    before calling this method. Attempting to cancel an auction that has already been
    sold will result in a failed operation.
  related:
  - AuctionHouseMgr::AddAuction
  - AuctionHouseMgr::SendAuctionSalePendingMail
  - AuctionHouseMgr::SendAuctionWonMail
metadata:
  confidence: 0.95
  generated_at: '2025-11-01T18:30:52.051186'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
