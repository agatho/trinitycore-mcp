api:
  class: TradeSystem
  method: GenerateCounterOffer
  signature: void TradeSystem::GenerateCounterOffer(Player * player, TradeSession
    & session)
documentation:
  brief: Generates a counteroffer for a trade session initiated by a player.
  description: The GenerateCounterOffer method is responsible for creating a new trade
    offer in response to an existing trade proposal within the TradeSystem. It evaluates
    the current state of the trade session, processes the player's proposed items
    and gold, and constructs a counteroffer that can be presented back to the trading
    partner. This method typically operates within the context of a two-way trade
    negotiation where one player makes an initial offer and the other responds with
    a counteroffer. The system ensures that all item validations and balance checks
    are performed before finalizing the counteroffer.
  parameters:
  - name: player
    description: Pointer to the Player object who is generating the counteroffer.
      This player must be actively participating in the trade session.
  - name: session
    description: Reference to the TradeSession object that contains the current state
      of the ongoing trade negotiation. The session holds information about both parties'
      offers and the trade status.
  returns: null
  examples:
  - title: Basic counteroffer generation
    code: 'Player* player = session.GetTrader(0);

      TradeSession& currentSession = session;

      TradeSystem::GenerateCounterOffer(player, currentSession);'
    language: cpp
  - title: Generating counteroffer with validation
    code: "if (player && session.IsActive()) {\n    TradeSystem::GenerateCounterOffer(player,\
      \ session);\n    // Process the generated counteroffer\n}"
    language: cpp
  notes: This method assumes that the player is in a valid trading state and that
    the trade session has been properly initialized. The implementation should handle
    cases where item validation fails or when the trade would result in an invalid
    state, such as negative gold amounts.
  warnings: Ensure that the player pointer is valid and that the session is active
    before calling this method. Failure to validate these conditions may lead to undefined
    behavior or crashes. Also, be aware that generating a counteroffer might trigger
    additional events or notifications to other players in the trade.
  related:
  - TradeSystem::StartTrade
  - TradeSystem::AcceptTrade
  - TradeSystem::CancelTrade
metadata:
  confidence: 0.85
  generated_at: '2025-11-07T18:11:32.041375'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
