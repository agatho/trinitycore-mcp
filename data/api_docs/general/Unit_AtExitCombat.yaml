api:
  class: Unit
  method: AtExitCombat
  signature: void Unit::AtExitCombat()
documentation:
  brief: Removes the unit from combat state and resets relevant combat-related flags
    and timers.
  description: The AtExitCombat method is responsible for transitioning a Unit out
    of combat state. When called, it clears the unit's combat flag, resets combat-related
    timers such as the last damage time, and ensures that the unit is no longer considered
    engaged in combat. This method is typically invoked internally by the game engine
    when a unit naturally exits combat, such as after a fight concludes or when a
    player logs out. It also handles cleanup of combat-specific data like the current
    target reference and any ongoing combat-related effects or auras.
  parameters: []
  returns: null
  examples:
  - title: Basic Usage in Combat Exit Logic
    code: "void Player::HandleCombatExit()\n{\n    if (IsInCombat())\n    {\n    \
      \    AtExitCombat();\n        // Additional cleanup logic here\n    }\n}"
    language: cpp
  - title: Usage in Custom AI Behavior
    code: "class MyAI : public CreatureAI\n{\npublic:\n    void UpdateAI(uint32 diff)\
      \ override\n    {\n        if (!UpdateVictim())\n        {\n            // Unit\
      \ has no target, exit combat\n            AtExitCombat();\n            return;\n\
      \        }\n    }\n};"
    language: cpp
  notes: This method is often called automatically by the core engine when a unit's
    combat state changes. Developers should not typically call this directly unless
    implementing custom combat logic or handling special edge cases. The method internally
    manages internal state flags and may trigger additional events or callbacks related
    to combat state transitions.
  warnings: Calling AtExitCombat() manually without proper context may result in inconsistent
    combat state, especially if the unit is still involved in active combat mechanics
    or has ongoing effects that depend on being in combat. Ensure this method is only
    used when it's safe to assume the unit should no longer be in combat.
  related:
  - IsInCombat
  - EnterCombat
  - SetInCombat
  - GetVictim
  - CombatStop
metadata:
  confidence: 0.95
  generated_at: '2025-10-31T09:34:55.407230'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
