api:
  class: Aura
  method: CalcProcChance
  signature: float Aura::CalcProcChance(const SpellProcEntry & procEntry, ProcEventInfo
    & eventInfo) const
documentation:
  brief: Calculates the chance of a spell proc occurring based on the aura's properties
    and event information.
  description: The CalcProcChance method computes the probability that a proc will
    occur for an aura given specific event conditions. This method is used in the
    TrinityCore WoW server to determine whether a triggered effect should activate
    based on various factors such as spell type, proc chance modifiers, and event
    context. The calculation considers both base proc chances defined in the spell
    proc entry and any additional modifiers or conditions applied by the aura itself.
  parameters:
  - name: procEntry
    description: Reference to the SpellProcEntry structure containing the proc definition
      and base chance information for the spell being processed.
  - name: eventInfo
    description: Reference to a ProcEventInfo structure that holds contextual information
      about the event triggering the proc, such as damage type, target, caster, and
      other relevant combat data.
  returns: A float value representing the calculated proc chance, typically between
    0.0 (no chance) and 1.0 (100% chance). Values outside this range may indicate
    special handling or error conditions.
  examples:
  - title: Basic usage in spell proc evaluation
    code: "float chance = aura->CalcProcChance(procEntry, eventInfo);\nif (chance\
      \ > urand(0.0f, 1.0f))\n{\n    // Proc occurs\n    aura->HandleProc(procEntry,\
      \ eventInfo);\n}"
    language: cpp
  - title: Using proc chance for conditional logic
    code: "float baseChance = aura->CalcProcChance(procEntry, eventInfo);\nif (baseChance\
      \ >= 0.5f)\n{\n    // High chance proc - apply special effects\n    player->AddAura(12345,\
      \ player);\n}\nelse if (baseChance < 0.1f)\n{\n    // Low chance proc - log\
      \ or debug\n    sLog->outDebug(\"Low proc chance: %.2f\", baseChance);\n}"
    language: cpp
  notes: This method is typically called during spell proc evaluation phases in the
    combat system. It's important to note that the actual proc decision should be
    made using a random number generator against this calculated chance rather than
    relying on exact equality checks.
  warnings: Do not use the return value directly as a boolean condition for proc activation;
    always compare it against a random float between 0.0 and 1.0. The method assumes
    valid input parameters, so passing invalid or uninitialized structures may lead
    to undefined behavior.
  related:
  - Aura::HandleProc
  - Aura::GetProcChance
  - SpellMgr::GetSpellProcEntry
metadata:
  confidence: 0.9
  generated_at: '2025-10-31T14:15:30.503132'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
