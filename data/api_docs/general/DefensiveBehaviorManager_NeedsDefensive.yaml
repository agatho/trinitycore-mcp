api:
  class: DefensiveBehaviorManager
  method: NeedsDefensive
  signature: bool DefensiveBehaviorManager::NeedsDefensive() const
documentation:
  brief: Determines whether the AI-controlled unit requires defensive behavior based
    on current threat and health conditions.
  description: The NeedsDefensive method evaluates the current state of an AI-controlled
    unit to determine if it should switch to or maintain a defensive behavior. This
    typically involves checking the unit's health percentage, the presence of active
    threats, and the overall combat situation. The method is used by the DefensiveBehaviorManager
    to make decisions about when to activate defensive actions such as healing, shielding,
    or retreating. It serves as a core decision-making function within the AI's defensive
    strategy system.
  parameters: []
  returns: Returns true if the unit currently requires defensive behavior based on
    its health, threat level, and combat state; otherwise returns false.
  examples:
  - title: Basic Usage in AI Logic
    code: "if (defensiveManager.NeedsDefensive()) {\n    // Activate defensive behavior\n\
      \    unit->SetReactState(REACT_DEFENSIVE);\n    unit->CastSpell(unit, SPELL_HEALING_WAVE,\
      \ true);\n}"
    language: cpp
  - title: Integration with Combat State Machine
    code: "void UnitAI::UpdateAI(uint32 diff) {\n    if (defensiveManager.NeedsDefensive())\
      \ {\n        // Switch to defensive mode\n        DoDefensiveBehavior();\n \
      \   } else {\n        // Continue normal behavior\n        DoNormalBehavior();\n\
      \    }\n}"
    language: cpp
  notes: This method is typically called during AI update cycles and should be lightweight
    to avoid performance impact. The decision logic may consider factors such as health
    percentage thresholds, number of nearby enemies, and threat levels from the unit's
    current target.
  warnings: Do not use this method in high-frequency loops without proper caching
    or throttling, as it may involve multiple internal checks that could impact performance
    if called too frequently.
  related:
  - DefensiveBehaviorManager::UpdateDefensiveBehavior
  - DefensiveBehaviorManager::SetDefensiveState
  - DefensiveBehaviorManager::IsInDefensiveMode
metadata:
  confidence: 0.9
  generated_at: '2025-11-02T08:40:56.811022'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
