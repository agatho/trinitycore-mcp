api:
  class: WorldSession
  method: HandleGarrisonCancelConstruction
  signature: void WorldSession::HandleGarrisonCancelConstruction(WorldPackets::Garrison::GarrisonCancelConstruction
    & garrisonCancelConstruction)
documentation:
  brief: Cancels a pending garrison construction project.
  description: The HandleGarrisonCancelConstruction method processes client requests
    to cancel ongoing construction projects within a player's garrison. This function
    is invoked when a player chooses to abort the construction of a building or improvement,
    typically through the garrison interface. The method validates that the construction
    can be canceled and removes the associated construction queue entry, refunding
    resources if applicable. It ensures that the player's garrison state remains consistent
    with the cancellation.
  parameters:
  - name: garrisonCancelConstruction
    description: A packet containing details about the construction to be canceled,
      including the plot instance ID and other relevant identifiers.
  returns: null
  examples:
  - title: Basic usage in a session handler
    code: "void WorldSession::HandleGarrisonCancelConstruction(WorldPackets::Garrison::GarrisonCancelConstruction&\
      \ garrisonCancelConstruction)\n{\n    // Validate and process the cancellation\n\
      \    if (Player* player = GetPlayer())\n    {\n        if (player->GetGarrison())\n\
      \        {\n            player->GetGarrison()->CancelConstruction(garrisonCancelConstruction.PlotInstanceId);\n\
      \        }\n    }\n}"
    language: cpp
  notes: This method is part of the garrison system and relies on proper synchronization
    with the client's UI state. It must ensure that no active construction can be
    canceled once it has started or completed, and should properly handle refunding
    of resources.
  warnings: Improper handling of this function may lead to inconsistent garrison states
    or resource leaks. Ensure that all validation checks are performed before modifying
    the garrison data structure.
  related:
  - HandleGarrisonStartConstruction
  - HandleGarrisonPlotPurchased
  - GetGarrison
metadata:
  confidence: 0.9
  generated_at: '2025-11-02T19:35:18.911260'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
