api:
  class: TerrainInfo
  method: IsUnderWater
  signature: bool TerrainInfo::IsUnderWater(const PhaseShift & phaseShift, uint32
    mapId, float x, float y, float z)
documentation:
  brief: Determines whether a given world coordinate is currently underwater based
    on phase information and map data.
  description: The IsUnderWater method checks if a specified 3D position (x, y, z)
    on a particular map is currently submerged in water. It takes into account the
    current phase shift to determine visibility and applicability of water bodies
    within that phase. This function is essential for game mechanics involving underwater
    physics, visual effects, and player interactions with water environments. The
    method utilizes internal terrain and water level data structures from the TrinityCore
    engine to perform this check accurately.
  parameters:
  - name: phaseShift
    description: The PhaseShift object containing phase information that affects which
      water bodies are currently visible or active in the world.
  - name: mapId
    description: The unique identifier of the map where the coordinate is located.
      Must correspond to a valid map in the game world.
  - name: x
    description: The X coordinate of the position to check for underwater status.
  - name: y
    description: The Y coordinate of the position to check for underwater status.
  - name: z
    description: The Z coordinate (height) of the position to check for underwater
      status.
  returns: Returns true if the specified coordinate is currently underwater according
    to the map's water data and phase shift; otherwise returns false.
  examples:
  - title: Basic usage to check if player is underwater
    code: "if (TerrainInfo::IsUnderWater(phaseShift, mapId, playerX, playerY, playerZ))\
      \ {\n    // Player is currently underwater\n    SendPlayerUnderwaterMessage();\n\
      } else {\n    // Player is above water\n    SendPlayerAboveWaterMessage();\n\
      }"
    language: cpp
  - title: Using IsUnderWater for environmental effect activation
    code: "void CheckUnderwaterEffects(const PhaseShift& phase, uint32 mapId, float\
      \ x, float y, float z) {\n    if (TerrainInfo::IsUnderWater(phase, mapId, x,\
      \ y, z)) {\n        // Activate underwater ambient sounds and effects\n    \
      \    PlayUnderwaterAmbience();\n        EnableDrowningMechanic();\n    } else\
      \ {\n        // Deactivate underwater effects\n        StopUnderwaterAmbience();\n\
      \        DisableDrowningMechanic();\n    }\n}"
    language: cpp
  notes: This method relies on accurate map data and phase information to function
    correctly. The implementation internally accesses terrain and water level databases,
    so performance may be affected by large numbers of concurrent checks. It is recommended
    to cache results when checking the same coordinates repeatedly.
  warnings: Ensure that the provided mapId corresponds to a valid loaded map before
    calling this method, as invalid map IDs can lead to undefined behavior or crashes.
    The phaseShift parameter must accurately reflect the current game state for correct
    results.
  related:
  - GetWaterLevel
  - IsInWater
  - GetTerrainHeight
metadata:
  confidence: 0.92
  generated_at: '2025-11-03T16:46:39.542860'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
