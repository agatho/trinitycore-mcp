api:
  class: WorldSession
  method: HandleSwapInvItemOpcode
  signature: void WorldSession::HandleSwapInvItemOpcode(WorldPackets::Item::SwapInvItem
    & swapInvItem)
documentation:
  brief: Handles the swapping of items between inventory slots for a player character.
  description: The HandleSwapInvItemOpcode method processes incoming client packets
    that request swapping items between two inventory slots. This method is part of
    the WorldSession class and handles the server-side logic for managing item rearrangements
    within a player's inventory. It validates the swap operation, ensures the player
    has permission to modify the affected slots, and updates the inventory accordingly.
    The method operates on data received from the client through the WorldPackets::Item::SwapInvItem
    packet structure, which contains information about the source and destination
    inventory slot indices.
  parameters:
  - name: swapInvItem
    description: A reference to a WorldPackets::Item::SwapInvItem packet containing
      the source and destination slot indices for the item swap operation.
  returns: null
  examples:
  - title: Basic item swap handling
    code: "void WorldSession::HandleSwapInvItemOpcode(WorldPackets::Item::SwapInvItem\
      \ & swapInvItem)\n{\n    // Validate source and destination slots\n    if (!CanSwapItems(swapInvItem.SourceSlot,\
      \ swapInvItem.DestinationSlot))\n        return;\n    \n    // Perform the actual\
      \ swap in inventory\n    SwapInventoryItems(swapInvItem.SourceSlot, swapInvItem.DestinationSlot);\n\
      \    \n    // Send confirmation to client\n    SendSwapResult(swapInvItem.SourceSlot,\
      \ swapInvItem.DestinationSlot);\n}"
    language: cpp
  notes: This method is typically called from the main packet handling loop when a
    SwapInvItem opcode is received. The implementation should validate that both slots
    are accessible and contain valid items before performing any swaps. It's important
    to ensure thread safety when accessing shared inventory data structures.
  warnings: Improper validation of slot indices can lead to crashes or invalid memory
    access. Always verify that the source and destination slots are within valid bounds
    before attempting a swap operation. Additionally, ensure proper item type compatibility
    checks are performed to prevent invalid swaps (e.g., swapping equipped items with
    non-equipped slots).
  related:
  - HandleItemQuerySingleOpcode
  - HandleAutoStoreLootItemOpcode
  - HandleSwapItemOpcode
metadata:
  confidence: 0.95
  generated_at: '2025-11-04T20:20:03.252588'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
