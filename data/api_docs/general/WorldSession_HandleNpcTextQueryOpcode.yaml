api:
  class: WorldSession
  method: HandleNpcTextQueryOpcode
  signature: void WorldSession::HandleNpcTextQueryOpcode(WorldPackets::Query::QueryNPCText
    & packet)
documentation:
  brief: Processes incoming NPC text query packets from clients to retrieve and send
    NPC gossip text data.
  description: The HandleNpcTextQueryOpcode method handles the QueryNPCText opcode
    sent by the client when a player interacts with an NPC to request its gossip text.
    This method retrieves the appropriate NPC text based on the provided entry ID,
    constructs a response packet containing the text data, and sends it back to the
    requesting client. It is part of the core WorldSession handling mechanism for
    managing NPC interactions and dialogue systems within TrinityCore's framework.
  parameters:
  - name: packet
    description: The incoming QueryNPCText packet containing the NPC entry ID for
      which text data is requested.
  returns: null
  examples:
  - title: Basic NPC Text Query Handling
    code: "void WorldSession::HandleNpcTextQueryOpcode(WorldPackets::Query::QueryNPCText\
      \ & packet)\n{\n    // Retrieve NPC text based on the entry ID\n    if (CreatureTextContainer\
      \ const* texts = sObjectMgr->GetCreatureTextContainer(packet.Entry))\n    {\n\
      \        // Construct and send response packet\n        WorldPackets::NPC::NPCTextUpdate\
      \ npcText;\n        npcText.Texts = *texts;\n        SendPacket(npcText.Write());\n\
      \    }\n}"
    language: cpp
  notes: This method is typically invoked during NPC interaction events and relies
    on the ObjectMgr to provide cached NPC text data. The packet structure contains
    an entry ID that maps to a specific NPC in the database, which must exist for
    successful retrieval.
  warnings: null
  related:
  - HandleNpcTextQueryOpcode
  - SendPacket
  - GetCreatureTextContainer
metadata:
  confidence: 0.95
  generated_at: '2025-11-04T21:23:10.307745'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
