api:
  class: WorldSession
  method: HandleSetTradeItemOpcode
  signature: void WorldSession::HandleSetTradeItemOpcode(WorldPackets::Trade::SetTradeItem
    & setTradeItem)
documentation:
  brief: Processes a trade item set request from the client during a trading session.
  description: The HandleSetTradeItemOpcode method handles the client's request to
    set or update a trade item in the current trade window. This method is invoked
    when a player attempts to place an item into their trade slot, either adding a
    new item or modifying an existing one. The method validates the trade state, checks
    item validity and ownership, and updates the trade data accordingly. It ensures
    that only valid items can be traded and maintains the integrity of the trading
    process by enforcing game rules such as item restrictions and inventory limits.
  parameters: []
  returns: null
  examples:
  - title: Basic Trade Item Setting
    code: "void WorldSession::HandleSetTradeItemOpcode(WorldPackets::Trade::SetTradeItem&\
      \ setTradeItem)\n{\n    // Validate trade session is active\n    if (!GetPlayer()->GetTrader())\n\
      \        return;\n    \n    // Process the trade item update\n    GetPlayer()->GetTrader()->SetTradeItem(setTradeItem.Slot,\
      \ setTradeItem.Item);\n}"
    language: cpp
  notes: This method is part of the core trading system and should only be called
    during active trade sessions. The implementation relies on proper validation of
    item ownership and trade window state to prevent cheating or invalid trades.
  warnings: Improper handling of this method can lead to items being incorrectly added
    to trades, potentially causing game balance issues or client-server desynchronization.
    Always validate that the player is in a valid trading session before processing.
  related:
  - HandleBeginTradeOpcode
  - HandleCancelTradeOpcode
  - HandleAcceptTradeOpcode
  - HandleSetTradeItemOpcode
metadata:
  confidence: 0.95
  generated_at: '2025-11-02T19:10:58.843643'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
