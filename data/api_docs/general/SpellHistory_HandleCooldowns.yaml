api:
  class: SpellHistory
  method: HandleCooldowns
  signature: void SpellHistory::HandleCooldowns(const SpellInfo * spellInfo, int itemId,
    Spell * spell)
documentation:
  brief: Processes and applies spell cooldowns for a given spell or item.
  description: The HandleCooldowns method in the SpellHistory class is responsible
    for managing cooldowns associated with spells or items. It ensures that a spell
    or item cannot be used again until its cooldown period has expired. This method
    typically gets called when a spell is cast or an item is used, and it updates
    internal tracking of cooldown timers to prevent immediate reuse. The method handles
    both spell-specific cooldowns and item-based cooldowns, ensuring proper game balance
    and preventing abuse of abilities or items.
  parameters:
  - name: spellInfo
    description: Pointer to the SpellInfo structure containing details about the spell
      being processed. Can be null if processing an item cooldown.
  - name: itemId
    description: Identifier of the item being used. If zero or invalid, no item cooldown
      is applied.
  - name: spell
    description: Pointer to the Spell object representing the spell instance being
      cast. Used for context and tracking.
  returns: null
  examples:
  - title: Basic usage when casting a spell
    code: 'SpellInfo* spellInfo = sSpellMgr->GetSpellInfo(12345);

      Spell* spell = new Spell(player, spellInfo, true);

      player->GetSpellHistory()->HandleCooldowns(spellInfo, 0, spell);'
    language: cpp
  - title: Usage when using an item with cooldown
    code: 'ItemTemplate const* proto = sObjectMgr->GetItemTemplate(67890);

      SpellInfo* spellInfo = sSpellMgr->GetSpellInfo(proto->Spells[0].SpellId);

      player->GetSpellHistory()->HandleCooldowns(spellInfo, 67890, nullptr);'
    language: cpp
  notes: This method interacts with the player's cooldown tracking system and updates
    internal timers. It should be called after spell validation but before execution
    to ensure cooldown logic is enforced correctly.
  warnings: Calling this method without proper spell or item validation may lead to
    incorrect cooldown behavior or crashes. Ensure that spellInfo and spell parameters
    are valid before calling.
  related:
  - GetCooldownForSpell
  - AddSpellCooldown
  - IsOnCooldown
metadata:
  confidence: 0.9
  generated_at: '2025-11-06T02:00:33.414666'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
