api:
  class: SharedInstanceLock
  method: SharedInstanceLock
  signature: void SharedInstanceLock::SharedInstanceLock(uint32 mapId, Difficulty
    difficultyId, int expiryTime, uint32 instanceId, std::shared_ptr<SharedInstanceLockData>
    sharedData)
documentation:
  brief: Initializes a shared instance lock for a specific map and difficulty with
    an expiration time and associated data.
  description: The SharedInstanceLock constructor initializes a locking mechanism
    for shared instances in World of Warcraft's TrinityCore environment. It associates
    a map ID, difficulty level, and instance identifier with a specified expiration
    time and shared data structure. This mechanism is used to manage concurrent access
    to shared instances, ensuring that only one player or group can interact with
    a specific instance at a time. The lock prevents race conditions and maintains
    synchronization across multiple players accessing the same instance content. The
    method sets up internal tracking structures necessary for managing instance locks
    and their lifecycle.
  parameters:
  - name: mapId
    description: The unique identifier of the map or dungeon where the shared instance
      is located. Valid values are map identifiers defined in the game's database.
  - name: difficultyId
    description: The difficulty level of the instance (normal, heroic, mythic, etc.).
      This determines which version of the content is being locked and accessed.
  - name: expiryTime
    description: The time in seconds after which the lock will automatically expire.
      A negative value indicates no automatic expiration.
  - name: instanceId
    description: The unique identifier of the specific instance within the map and
      difficulty combination. Used to distinguish between multiple instances of the
      same content.
  - name: sharedData
    description: A shared pointer to the data structure containing information about
      the shared instance lock. Must not be null for proper initialization.
  returns: null
  examples:
  - title: Basic Instance Lock Initialization
    code: 'auto lockData = std::make_shared<SharedInstanceLockData>(/* data */);

      SharedInstanceLock lock(1234, DIFFICULTY_NORMAL, 3600, 5678, lockData);'
    language: cpp
  - title: Lock with Infinite Expiry
    code: 'auto lockData = std::make_shared<SharedInstanceLockData>(/* data */);

      SharedInstanceLock lock(1234, DIFFICULTY_HEROIC, -1, 5678, lockData);'
    language: cpp
  notes: This constructor should only be called when setting up a new shared instance
    lock. The shared data pointer must remain valid for the duration of the lock's
    existence. The instance ID is typically generated by the server when an instance
    is first created and should be unique per map/difficulty combination.
  warnings: Do not call this constructor directly unless you understand the underlying
    instance management system. Improper use can lead to deadlocks or inconsistent
    state in shared instances. Always ensure that the sharedData parameter is properly
    initialized before passing it to this constructor.
  related:
  - SharedInstanceLock::Release
  - SharedInstanceLock::IsExpired
  - SharedInstanceLock::GetMapId
  - SharedInstanceLock::GetInstanceId
metadata:
  confidence: 0.9
  generated_at: '2025-11-02T15:31:55.610559'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
