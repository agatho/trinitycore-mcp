api:
  class: AuraEffect
  method: HandleSpiritOfRedemption
  signature: void AuraEffect::HandleSpiritOfRedemption(const AuraApplication * aurApp,
    uint8 mode, bool apply) const
documentation:
  brief: Handles the Spirit of Redemption aura effect application and removal logic.
  description: The HandleSpiritOfRedemption method manages the behavior of the Spirit
    of Redemption aura effect, which is applied when a player dies and transforms
    into a spirit. This method is invoked during aura application or removal to control
    the transition state, including preventing normal death mechanics and enabling
    spirit form. It ensures that players under this effect cannot be resurrected normally
    and instead enter a special spirit state where they can only be healed by specific
    abilities. The method interacts with the AuraApplication object to determine the
    current state of the aura and applies appropriate game logic based on whether
    the effect is being applied or removed.
  parameters:
  - name: aurApp
    description: Pointer to the AuraApplication object representing the aura application
      context. Contains information about the aura's target, caster, and application
      state.
  - name: mode
    description: The mode of operation indicating how the aura is being applied or
      removed. Typically 0 for application, 1 for removal, though exact values depend
      on TrinityCore's internal implementation.
  - name: apply
    description: Boolean flag indicating whether the aura is being applied (true)
      or removed (false). Controls the execution path within the method.
  returns: null
  examples:
  - title: Basic Spirit of Redemption Handling
    code: "void AuraEffect::HandleSpiritOfRedemption(const AuraApplication* aurApp,\
      \ uint8 mode, bool apply) const {\n    if (apply) {\n        // Apply spirit\
      \ form logic\n        Unit* target = aurApp->GetTarget();\n        target->SetFlag(UNIT_FIELD_FLAGS,\
      \ UNIT_FLAG_SPIRIT_OF_REDEMPTION);\n    } else {\n        // Remove spirit form\
      \ logic\n        Unit* target = aurApp->GetTarget();\n        target->RemoveFlag(UNIT_FIELD_FLAGS,\
      \ UNIT_FLAG_SPIRIT_OF_REDEMPTION);\n    }\n}"
    language: cpp
  notes: This method is part of the aura handling system in TrinityCore and is typically
    called internally by the core engine when applying or removing auras. Developers
    should not directly call this method unless implementing custom aura effects.
    The Spirit of Redemption aura is commonly associated with the paladin ability
    and affects player death mechanics.
  warnings: Improper handling of this aura effect can cause unexpected behavior in
    player death states, including incorrect resurrection mechanics or visual glitches.
    Ensure proper state management when overriding this method in custom implementations.
  related:
  - AuraEffect::HandlePeriodicDummy
  - AuraEffect::HandleApplySpellMod
  - AuraApplication::GetTarget
metadata:
  confidence: 0.9
  generated_at: '2025-10-31T11:59:12.538106'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
