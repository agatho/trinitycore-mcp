api:
  class: AuraEffect
  method: HandleAuraModTotalThreat
  signature: void AuraEffect::HandleAuraModTotalThreat(const AuraApplication * aurApp,
    uint8 mode, bool apply) const
documentation:
  brief: Modifies the total threat generated by a unit while this aura is active.
  description: The HandleAuraModTotalThreat method adjusts the threat value that a
    unit generates on targets when this aura effect is applied or removed. This method
    is typically used in conjunction with threat-modifying spells or abilities that
    alter how much aggro a player or creature generates. The change in threat is calculated
    based on the aura's properties and can either increase or decrease the overall
    threat level depending on whether the aura is being applied or removed. When applied,
    it modifies the threat generation of the affected unit; when removed, it reverts
    the threat modification.
  parameters:
  - name: aurApp
    description: Pointer to the AuraApplication object representing the application
      state of this aura on a target. Used to determine which unit is affected and
      the current aura state.
  - name: mode
    description: The mode of operation for applying or removing the aura effect. Typically
      indicates whether the effect should be applied (1) or removed (0).
  - name: apply
    description: Boolean flag indicating whether to apply (true) or remove (false)
      the aura effect. Controls the direction of the threat modification.
  returns: null
  examples:
  - title: Applying Threat Modification Aura
    code: "void ApplyThreatModAura(Unit* target)\n{\n    if (Aura* aura = target->GetAura(12345))\
      \ // Assume aura ID 12345 modifies total threat\n    {\n        AuraApplication*\
      \ app = aura->GetApplicationOf(target);\n        if (app)\n        {\n     \
      \       aura->GetEffect(0)->HandleAuraModTotalThreat(app, 1, true);\n      \
      \  }\n    }\n}"
    language: cpp
  notes: This method is part of the core aura handling system in TrinityCore and is
    invoked automatically during aura application or removal. It directly affects
    combat behavior by modifying how threat is calculated for the affected unit, which
    can influence mob targeting and aggro mechanics.
  warnings: Improper use of this method may lead to unexpected combat behavior or
    aggro issues. Ensure that any threat modifications are consistent with game balance
    and intended gameplay mechanics. Misuse could cause mobs to target unintended
    units or fail to switch targets properly.
  related:
  - AuraEffect::HandleAuraModThreat
  - AuraEffect::HandleAuraApply
  - AuraEffect::HandleAuraRemove
metadata:
  confidence: 0.9
  generated_at: '2025-10-31T13:03:02.725906'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
