api:
  class: LoSUtils
  method: CanCastSpellAtTarget
  signature: bool LoSUtils::CanCastSpellAtTarget(Player * caster, Unit * target, uint32
    spellId)
documentation:
  brief: Determines whether a player can cast a specified spell at a target unit,
    considering line of sight and other game mechanics.
  description: The CanCastSpellAtTarget method evaluates if a player is able to cast
    a given spell on a target unit. It checks various conditions including line of
    sight (LoS), spell range, target validity, and whether the caster has sufficient
    resources or permissions. This utility function is commonly used in spell casting
    logic to prevent invalid or impossible spell casts from being processed. The method
    ensures that game mechanics such as spell restrictions, targeting rules, and spatial
    requirements are respected before allowing a spell to be cast.
  parameters:
  - name: caster
    description: Pointer to the Player object attempting to cast the spell. Must be
      a valid player instance with proper initialization.
  - name: target
    description: Pointer to the Unit object that is the target of the spell. Can be
      any unit type including players, NPCs, or game objects.
  - name: spellId
    description: The unique identifier of the spell being cast. Must correspond to
      a valid spell entry in the game's spell database.
  returns: Returns true if the spell can be cast at the target, considering all relevant
    conditions such as line of sight, range, and target validity. Returns false otherwise.
  examples:
  - title: Basic usage to check spell casting eligibility
    code: "if (LoSUtils::CanCastSpellAtTarget(player, target, 12345)) {\n    // Proceed\
      \ with spell casting logic\n    player->CastSpell(target, 12345, true);\n} else\
      \ {\n    // Handle invalid cast attempt\n    player->SendSpellFailed(12345,\
      \ SPELL_FAILED_BAD_TARGETS);\n}"
    language: cpp
  - title: Using in a spell handler to validate target before casting
    code: "void Player::HandleSpellCast(uint32 spellId, Unit* target) {\n    if (!target\
      \ || !player)\n        return;\n    \n    if (LoSUtils::CanCastSpellAtTarget(player,\
      \ target, spellId)) {\n        CastSpell(target, spellId, true);\n    } else\
      \ {\n        SendSpellFailed(spellId, SPELL_FAILED_BAD_TARGETS);\n    }\n}"
    language: cpp
  notes: This method performs multiple checks internally including line of sight validation,
    target type verification, and spell-specific restrictions. It is designed to be
    efficient for real-time use during gameplay but may involve database lookups or
    complex spatial calculations depending on the spell's properties.
  warnings: Ensure that both caster and target pointers are valid before calling this
    method; passing null pointers will likely result in undefined behavior or crashes.
    Also, note that this function does not check for cooldowns or mana requirements
    - those should be validated separately.
  related:
  - IsInLineOfSight
  - CanCastSpell
  - CheckSpellTarget
metadata:
  confidence: 0.9
  generated_at: '2025-11-04T01:17:07.844282'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
