api:
  class: WorldSession
  method: HandlePetActionHelper
  signature: void WorldSession::HandlePetActionHelper(Unit * pet, int guid1, uint32
    spellid, uint16 flag, int guid2, const Position & pos)
documentation:
  brief: Processes pet action commands including attack, follow, stay, and spell casting.
  description: The HandlePetActionHelper method is responsible for processing various
    pet action commands sent from the client to the server. It handles different flag-based
    actions such as attacking targets, following or staying in place, and executing
    spells. The method interprets the provided flags and GUIDs to determine the appropriate
    pet behavior, ensuring that the pet's actions are synchronized with the player's
    intentions. This method is typically invoked through network packets when players
    interact with their summoned pets.
  parameters:
  - name: pet
    description: Pointer to the Unit object representing the pet that will perform
      the action. Must be a valid pet instance belonging to the session's player.
  - name: guid1
    description: First GUID value, typically representing either the target unit's
      GUID or the spell ID depending on the flag value. Can be negative for specific
      actions like 'stay'.
  - name: spellid
    description: The spell identifier to cast if the action involves casting a spell.
      Zero if no spell is being cast.
  - name: flag
    description: Flag value indicating the type of pet action to perform. Common values
      include PET_ACTION_ATTACK, PET_ACTION_FOLLOW, PET_ACTION_STAY, and PET_ACTION_CAST.
  - name: guid2
    description: Second GUID value, often used for target-related actions or additional
      context when the flag requires it. May be zero if not applicable.
  - name: pos
    description: Position object containing coordinates where the pet should move
      to, used in cases like PET_ACTION_MOVE_TO position commands.
  returns: null
  examples:
  - title: Pet Attack Command
    code: HandlePetActionHelper(pet, targetGuid, 0, PET_ACTION_ATTACK, 0, Position());
    language: cpp
  - title: Pet Cast Spell
    code: HandlePetActionHelper(pet, 0, spellId, PET_ACTION_CAST, 0, Position());
    language: cpp
  notes: This method assumes that the pet is valid and belongs to the current session's
    player. It performs internal validation on flag values and GUIDs before executing
    any actions. The method does not directly send responses back to the client; it
    relies on other systems to handle network communication.
  warnings: Ensure that the pet pointer is valid and that the GUIDs provided are correct,
    as invalid pointers or incorrect IDs can lead to undefined behavior or crashes.
    This method should only be called when a player has an active pet in their control.
  related:
  - HandlePetAction
  - HandlePetStopAttack
  - HandlePetMove
metadata:
  confidence: 0.9
  generated_at: '2025-11-04T21:16:34.070413'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
