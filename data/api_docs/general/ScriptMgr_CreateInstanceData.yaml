api:
  class: ScriptMgr
  method: CreateInstanceData
  signature: InstanceScript * ScriptMgr::CreateInstanceData(InstanceMap * map)
documentation:
  brief: Creates and returns an InstanceScript instance for the specified map.
  description: The CreateInstanceData method is responsible for instantiating the
    appropriate InstanceScript subclass that manages the game logic and state for
    a specific dungeon or raid instance. This method is typically invoked by the core
    when a new instance of a map is created, ensuring that all necessary event handling,
    creature AI, and object interactions are properly initialized. It acts as a factory
    method that retrieves the correct script implementation based on the map's entry
    ID and returns a pointer to the newly created InstanceScript object. The returned
    instance will manage the lifecycle of all objects within that instance, including
    triggers, timers, and quest states.
  parameters: []
  returns: A pointer to the newly created InstanceScript object for the specified
    map, or nullptr if no valid script could be instantiated for the given map.
  examples:
  - title: Basic usage in a custom map loader
    code: "class MyDungeonMapLoader : public MapLoader\n{\npublic:\n    void LoadMap(Map*\
      \ map) override\n    {\n        if (InstanceScript* instance = sScriptMgr->CreateInstanceData(map->ToInstanceMap()))\n\
      \        {\n            map->SetInstanceScript(instance);\n        }\n    }\n\
      };"
    language: cpp
  notes: This method is typically called internally by the TrinityCore framework when
    a new instance map is initialized. Developers should not call this method directly
    unless implementing custom map loading logic. The returned InstanceScript object
    must be properly managed and will be automatically deleted when the map instance
    is destroyed.
  warnings: Do not assume that the returned pointer is always valid; it may return
    nullptr if no script is registered for the given map type. Always check for null
    before using the returned InstanceScript pointer to prevent crashes.
  related:
  - GetInstanceScript
  - GetMapScript
metadata:
  confidence: 0.95
  generated_at: '2025-10-31T20:37:32.948738'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
