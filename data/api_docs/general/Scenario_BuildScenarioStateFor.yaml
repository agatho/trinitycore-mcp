api:
  class: Scenario
  method: BuildScenarioStateFor
  signature: void Scenario::BuildScenarioStateFor(const int * player, WorldPackets::Scenario::ScenarioState
    * scenarioState) const
documentation:
  brief: Builds and populates a scenario state packet for the specified player.
  description: The BuildScenarioStateFor method constructs a scenario state packet
    containing all relevant scenario progress data for a given player. This method
    is typically invoked when a player logs in or enters a scenario zone to synchronize
    their current scenario progress with the client. The method populates the provided
    WorldPackets::Scenario::ScenarioState object with data such as objective progress,
    rewards, and completion status. It ensures that the player's scenario state is
    accurately reflected in the game client for proper UI display and gameplay mechanics.
  parameters:
  - name: player
    description: Pointer to an integer representing the player's unique identifier
      (GUID). This parameter identifies which player's scenario state should be built.
  - name: scenarioState
    description: Pointer to a WorldPackets::Scenario::ScenarioState object that will
      be populated with the player's scenario data. This packet structure contains
      all necessary fields for client synchronization.
  returns: null
  examples:
  - title: Basic usage example
    code: 'int playerId = 12345;

      WorldPackets::Scenario::ScenarioState state;

      scenario->BuildScenarioStateFor(&playerId, &state);'
    language: cpp
  - title: Usage in player login context
    code: "void Player::OnLogin()\n{\n    if (scenario)\n    {\n        WorldPackets::Scenario::ScenarioState\
      \ state;\n        scenario->BuildScenarioStateFor(&GetGUID().GetCounter(), &state);\n\
      \        SendPacket(state.Write());\n    }\n}"
    language: cpp
  notes: This method is typically called during player login or zone entry to ensure
    client-side scenario data is synchronized. The method assumes the player exists
    and has active scenario progress. Implementation may involve database lookups
    or cached scenario data structures.
  warnings: Ensure that the player parameter points to a valid player GUID, as passing
    an invalid pointer could lead to undefined behavior. The scenarioState object
    must be properly initialized before calling this method to avoid memory corruption.
  related:
  - GetScenarioData
  - UpdateScenarioProgress
  - SendScenarioState
metadata:
  confidence: 0.9
  generated_at: '2025-11-07T10:13:14.822920'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
