api:
  class: TradeSystem
  method: ProcessVendorBuy
  signature: void TradeSystem::ProcessVendorBuy(Player * player, uint32 vendorGuid,
    uint32 itemId, uint32 count)
documentation:
  brief: Processes a player's purchase from a vendor, deducting gold and adding items
    to their inventory.
  description: The ProcessVendorBuy method handles the transaction logic when a player
    buys an item from a vendor. It verifies that the player has sufficient gold, checks
    if the vendor has the requested item in stock, and then deducts the appropriate
    amount of gold from the player's inventory while adding the purchased item(s)
    to their inventory. This method is typically called internally by the game server
    when a player interacts with a vendor to make a purchase. The method ensures proper
    validation of the transaction before completing it.
  parameters:
  - name: player
    description: Pointer to the Player object representing the client who is making
      the purchase
  - name: vendorGuid
    description: The unique identifier (GUID) of the vendor NPC from whom the item
      is being purchased
  - name: itemId
    description: The entry ID of the item being purchased from the vendor
  - name: count
    description: The number of items to purchase (must be a positive integer)
  returns: null
  examples:
  - title: Basic Vendor Purchase
    code: 'Player* player = ...; // Get player reference

      uint32 vendorGuid = 12345;

      uint32 itemId = 1001;

      uint32 count = 1;

      TradeSystem::ProcessVendorBuy(player, vendorGuid, itemId, count);'
    language: cpp
  - title: Bulk Purchase from Vendor
    code: 'Player* player = ...; // Get player reference

      uint32 vendorGuid = 54321;

      uint32 itemId = 2005;

      uint32 count = 10;

      TradeSystem::ProcessVendorBuy(player, vendorGuid, itemId, count);'
    language: cpp
  notes: This method assumes that all parameter validation has been performed prior
    to calling. The method does not perform any direct network communication; it only
    handles the core logic of the transaction. It is expected that the calling code
    will have already verified that the vendor is within range and that the player
    has permission to interact with the vendor.
  warnings: This method should not be called directly from client-side code or without
    proper validation of inputs. Incorrect GUIDs or invalid item IDs may lead to undefined
    behavior or crashes. The method does not handle currency conversion or special
    vendor discounts; those are handled separately in the calling logic.
  related:
  - ProcessVendorSell
  - ValidateVendorTransaction
  - UpdatePlayerInventory
metadata:
  confidence: 0.9
  generated_at: '2025-11-06T00:28:03.615979'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
