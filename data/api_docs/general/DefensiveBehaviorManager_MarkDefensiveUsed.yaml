api:
  class: DefensiveBehaviorManager
  method: MarkDefensiveUsed
  signature: void DefensiveBehaviorManager::MarkDefensiveUsed(uint32 spellId)
documentation:
  brief: Marks a defensive spell as used for the current combat encounter
  description: The MarkDefensiveUsed method records that a defensive spell has been
    activated by the AI-controlled unit. This method is typically called when a defensive
    behavior such as defensive stance, healing, or protective aura is executed. The
    method updates internal tracking mechanisms to prevent excessive use of defensive
    abilities within a short time frame and may affect AI decision-making for subsequent
    actions. It ensures that defensive cooldowns are properly managed and that the
    AI does not spam defensive spells in rapid succession.
  parameters:
  - name: spellId
    description: The unique identifier of the defensive spell being marked as used.
      This ID should correspond to a valid spell entry in the game's spell database.
  returns: null
  examples:
  - title: Basic Usage in AI Behavior
    code: "void CustomAI::UpdateAI(uint32 diff)\n{\n    if (me->HasUnitState(UNIT_STATE_CASTING))\n\
      \        return;\n\n    if (me->GetHealthPct() < 30.0f)\n    {\n        // Cast\
      \ defensive spell\n        me->CastSpell(me, SPELL_DEFENSIVE_STANCE, true);\n\
      \        // Mark the spell as used\n        defensiveManager->MarkDefensiveUsed(SPELL_DEFENSIVE_STANCE);\n\
      \    }\n}"
    language: cpp
  notes: This method likely updates internal cooldown tracking for defensive abilities.
    It may be called internally by the AI system when defensive behaviors are triggered,
    or externally by custom AI scripts to manually mark spells as used. The exact
    implementation details depend on how the DefensiveBehaviorManager tracks and manages
    spell usage.
  warnings: Ensure that the spellId parameter corresponds to a valid defensive spell
    in the game database. Incorrect spell IDs may lead to undefined behavior or failed
    tracking of defensive cooldowns.
  related:
  - IsDefensiveUsed
  - GetDefensiveCooldown
  - ResetDefensiveCooldown
metadata:
  confidence: 0.85
  generated_at: '2025-11-02T08:41:21.347107'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
