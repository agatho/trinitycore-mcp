api:
  class: NPCInteractionManager
  method: RepairAtVendor
  signature: bool NPCInteractionManager::RepairAtVendor(Creature * vendor)
documentation:
  brief: Initiates the repair process for a player's items at the specified vendor
    creature.
  description: The RepairAtVendor method handles the core functionality of repairing
    all damaged equipment for a player when interacting with a vendor. It checks if
    the player has any items that require repair, verifies the vendor accepts repairs,
    and processes the transaction by deducting the appropriate gold amount from the
    player's inventory. The method ensures that only items in the player's possession
    are considered for repair, and it respects the vendor's repair capabilities and
    pricing structure. This function is typically called during NPC interaction when
    a player selects the 'Repair Items' option.
  parameters:
  - name: vendor
    description: Pointer to the Creature object representing the vendor who will perform
      the repairs. Must be a valid creature with repair capabilities enabled.
  returns: Returns true if the repair process was successfully initiated and items
    were repaired, or if no items needed repair. Returns false if the vendor is invalid,
    the player has no items to repair, or the repair transaction fails due to insufficient
    funds or other constraints.
  examples:
  - title: Basic Repair Usage
    code: "if (player->GetNPCInteractionManager()->RepairAtVendor(vendorCreature))\
      \ {\n    SendSystemMessage(\"Items repaired successfully.\");\n} else {\n  \
      \  SendSystemMessage(\"Failed to repair items.\");\n}"
    language: cpp
  - title: Check Before Repair
    code: "if (vendorCreature && vendorCreature->IsRepairVendor()) {\n    if (player->GetNPCInteractionManager()->RepairAtVendor(vendorCreature))\
      \ {\n        player->SendChatMessage(CHAT_MSG_SYSTEM, LANG_UNIVERSAL, \"All\
      \ items repaired.\");\n    } else {\n        player->SendChatMessage(CHAT_MSG_SYSTEM,\
      \ LANG_UNIVERSAL, \"Repair failed.\");\n    }\n}"
    language: cpp
  notes: This method internally checks the vendor's repair flags and ensures that
    only items in the player's inventory are eligible for repair. It also validates
    that the player has sufficient gold to cover the repair costs. The method does
    not directly modify the vendor's state or perform any database operations; it
    relies on existing TrinityCore systems for gold deduction and item state updates.
  warnings: Ensure that the vendor pointer is valid before calling this method, as
    passing a null pointer will result in undefined behavior. This function should
    only be called during active NPC interaction sessions to maintain proper game
    state consistency.
  related:
  - GetNPCInteractionManager
  - CanRepairItems
  - GetRepairCost
metadata:
  confidence: 0.9
  generated_at: '2025-11-07T23:12:32.288642'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
