api:
  class: SpellHistory
  method: AddGlobalCooldown
  signature: void SpellHistory::AddGlobalCooldown(const SpellInfo * spellInfo, int
    duration)
documentation:
  brief: Adds a global cooldown for the specified spell to the spell history.
  description: The AddGlobalCooldown method registers a global cooldown period for
    a given spell within the SpellHistory system. This mechanism prevents players
    from casting spells too rapidly and enforces game balance by introducing cooldowns
    that apply globally across all abilities. The duration is typically derived from
    the spell's cooldown properties or modified by effects such as haste. This method
    is commonly invoked during spell casting to ensure proper cooldown handling and
    synchronization with the player's action queue.
  parameters:
  - name: spellInfo
    description: Pointer to the SpellInfo structure containing metadata about the
      spell being cast. Must not be null.
  - name: duration
    description: The duration of the global cooldown in milliseconds. Typically represents
      the base cooldown time modified by game mechanics like haste or other effects.
  returns: null
  examples:
  - title: Basic Usage Example
    code: 'SpellInfo* spell = sSpellMgr->GetSpellInfo(12345);

      int cooldownDuration = spell->GetRecoveryTime();

      player->GetSpellHistory()->AddGlobalCooldown(spell, cooldownDuration);'
    language: cpp
  - title: Advanced Usage with Haste Modification
    code: 'SpellInfo* spell = sSpellMgr->GetSpellInfo(67890);

      int baseCooldown = spell->GetRecoveryTime();

      float hasteMod = player->GetFloatValue(PLAYER_HASTE); // Get current haste percentage

      int modifiedDuration = static_cast<int>(baseCooldown / (1.0f + hasteMod));

      player->GetSpellHistory()->AddGlobalCooldown(spell, modifiedDuration);'
    language: cpp
  notes: This method directly modifies the internal global cooldown timer stored in
    the SpellHistory object. It should be called after spell validation but before
    the actual casting begins to ensure proper timing and synchronization with the
    game's action queue.
  warnings: Ensure that spellInfo is valid and not null, otherwise calling this method
    will result in undefined behavior. Also, be cautious when modifying cooldown durations
    as incorrect calculations may lead to gameplay imbalance or unexpected behavior.
  related:
  - GetGlobalCooldown
  - HasGlobalCooldown
  - ClearGlobalCooldown
metadata:
  confidence: 0.95
  generated_at: '2025-11-06T02:01:16.797042'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
