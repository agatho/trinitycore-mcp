api:
  class: WorldSession
  method: HandleListInventoryOpcode
  signature: void WorldSession::HandleListInventoryOpcode(WorldPackets::NPC::Hello
    & packet)
documentation:
  brief: Processes a client request to list inventory items from an NPC vendor.
  description: The HandleListInventoryOpcode method handles the WorldPackets::NPC::Hello
    packet sent by the client when interacting with an NPC vendor. This method retrieves
    and sends back the inventory items that the NPC is offering for sale. It typically
    occurs during vendor interactions where the player opens a vendor window to browse
    available goods. The method validates the NPC's validity, checks if the vendor
    is accessible to the player, and then constructs and sends a packet containing
    the list of items the vendor has for sale.
  parameters:
  - name: packet
    description: The WorldPackets::NPC::Hello packet received from the client containing
      information about the NPC interaction, including the GUID of the NPC being interacted
      with.
  returns: null
  examples:
  - title: Basic vendor interaction handling
    code: "void WorldSession::HandleListInventoryOpcode(WorldPackets::NPC::Hello&\
      \ packet)\n{\n    if (!packet.GUID)\n        return;\n\n    Creature* creature\
      \ = GetPlayer()->GetMap()->GetCreature(packet.GUID);\n    if (!creature || !creature->IsVendor())\n\
      \        return;\n\n    // Send vendor items to player\n    WorldPackets::NPC::VendorInventoryItems\
      \ items;\n    // ... populate items ...\n    SendPacket(items.Write());\n}"
    language: cpp
  notes: This method is part of the standard NPC interaction flow in TrinityCore.
    It's typically called when a player clicks on a vendor NPC, and it's responsible
    for preparing and sending the item list to the client. The method assumes that
    the packet has already been validated by the network layer.
  warnings: Ensure proper validation of the NPC GUID before attempting to access creature
    data. Failing to validate can lead to crashes or memory corruption if an invalid
    GUID is provided.
  related:
  - HandleNPCHelloOpcode
  - SendNPCVendorItems
  - GetPlayer
metadata:
  confidence: 0.9
  generated_at: '2025-11-04T21:44:42.748529'
  generator: lmstudio-qwen3-coder-30b
  version: 1.0.0
  source: core
